{"episode_reward_max": -7.400000000000004, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -33.84615384615386, "episode_len_mean": 58.89230769230769, "episodes_this_iter": 65, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.4}, "policy_reward_mean": {"policy_0": -10.837438423645311}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.874828379925221, "mean_processing_ms": 4.245955903547031, "mean_inference_ms": 1.2552203306645353}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11392, "num_steps_sampled": 4000, "sample_time_ms": 6823.569, "load_time_ms": 5266.602, "grad_time_ms": 31366.446, "update_time_ms": 91613.073, "learner": {"policy_0": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004622574895620346, "policy_loss": -0.006121341604739428, "vf_loss": 23.958961486816406, "vf_explained_var": 0.00462080305442214, "kl": 0.00737401470541954, "entropy": 1.5142638683319092, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 4000, "episodes_total": 65, "training_iteration": 1, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-43-37", "timestamp": 1581500617, "time_this_iter_s": 136.53372812271118, "time_total_s": 136.53372812271118, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b895510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 136.53372812271118, "timesteps_since_restore": 4000, "iterations_since_restore": 1, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -5.600000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -31.688, "episode_len_mean": 57.21, "episodes_this_iter": 69, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -10.288311688311678}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.785347060474528, "mean_processing_ms": 4.400656876955175, "mean_inference_ms": 1.1553940664350235}, "off_policy_estimator": {}, "info": {"num_steps_trained": 22272, "num_steps_sampled": 8000, "sample_time_ms": 6469.046, "load_time_ms": 2641.869, "grad_time_ms": 27535.118, "update_time_ms": 45822.536, "learner": {"policy_0": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.029611382633447647, "policy_loss": 0.028774235397577286, "vf_loss": 13.546724319458008, "vf_explained_var": 0.00011247396469116211, "kl": 0.004118018317967653, "entropy": 1.4785174131393433, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 8000, "episodes_total": 134, "training_iteration": 2, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-44-07", "timestamp": 1581500647, "time_this_iter_s": 29.882935285568237, "time_total_s": 166.41666340827942, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da0d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 166.41666340827942, "timesteps_since_restore": 8000, "iterations_since_restore": 2, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -5.600000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -29.073999999999987, "episode_len_mean": 55.52, "episodes_this_iter": 71, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -9.288817891373794}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.73652705889743, "mean_processing_ms": 4.432135135384064, "mean_inference_ms": 1.0791665776260075}, "off_policy_estimator": {}, "info": {"num_steps_trained": 32256, "num_steps_sampled": 12000, "sample_time_ms": 6325.292, "load_time_ms": 1768.451, "grad_time_ms": 25675.507, "update_time_ms": 30558.455, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.05911722406744957, "policy_loss": 0.05817339941859245, "vf_loss": 10.414604187011719, "vf_explained_var": -0.01948784850537777, "kl": 0.009334061294794083, "entropy": 1.4764050245285034, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 12000, "episodes_total": 205, "training_iteration": 3, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-44-35", "timestamp": 1581500675, "time_this_iter_s": 28.0608971118927, "time_total_s": 194.47756052017212, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 194.47756052017212, "timesteps_since_restore": 12000, "iterations_since_restore": 3, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -6.000000000000003, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -30.253999999999984, "episode_len_mean": 57.13, "episodes_this_iter": 69, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -9.604444444444434}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.737432354460264, "mean_processing_ms": 4.4922846020415195, "mean_inference_ms": 1.0613989023741355}, "off_policy_estimator": {}, "info": {"num_steps_trained": 43008, "num_steps_sampled": 16000, "sample_time_ms": 6382.68, "load_time_ms": 1330.86, "grad_time_ms": 25225.292, "update_time_ms": 22928.275, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.001401764340698719, "policy_loss": 0.000312999589368701, "vf_loss": 7.381520748138428, "vf_explained_var": -0.0485176146030426, "kl": 0.010813827626407146, "entropy": 1.439461588859558, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 16000, "episodes_total": 274, "training_iteration": 4, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-45-06", "timestamp": 1581500706, "time_this_iter_s": 30.500341415405273, "time_total_s": 224.9779019355774, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7dac80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 224.9779019355774, "timesteps_since_restore": 16000, "iterations_since_restore": 4, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -5.600000000000002, "episode_reward_min": -40.00000000000003, "episode_reward_mean": -27.919999999999963, "episode_len_mean": 55.87, "episodes_this_iter": 73, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -9.796491228070165}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.716964586248279, "mean_processing_ms": 4.591197531031804, "mean_inference_ms": 1.056062232894079}, "off_policy_estimator": {}, "info": {"num_steps_trained": 53120, "num_steps_sampled": 20000, "sample_time_ms": 6375.301, "load_time_ms": 1066.954, "grad_time_ms": 24582.121, "update_time_ms": 18349.529, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03114689514040947, "policy_loss": 0.030159853398799896, "vf_loss": 8.233349800109863, "vf_explained_var": -0.11514920741319656, "kl": 0.00978807918727398, "entropy": 1.4635887145996094, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 20000, "episodes_total": 347, "training_iteration": 5, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-45-34", "timestamp": 1581500734, "time_this_iter_s": 28.416327238082886, "time_total_s": 253.39422917366028, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7daf28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 253.39422917366028, "timesteps_since_restore": 20000, "iterations_since_restore": 5, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -5.200000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -28.39599999999999, "episode_len_mean": 54.17, "episodes_this_iter": 73, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -9.625762711864398}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.699570350420576, "mean_processing_ms": 4.63519736662105, "mean_inference_ms": 1.0441188595099486}, "off_policy_estimator": {}, "info": {"num_steps_trained": 63744, "num_steps_sampled": 24000, "sample_time_ms": 6314.574, "load_time_ms": 891.095, "grad_time_ms": 24402.66, "update_time_ms": 15296.82, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.028313737362623215, "policy_loss": -0.029574405401945114, "vf_loss": 8.331809043884277, "vf_explained_var": -0.04693538695573807, "kl": 0.012523368000984192, "entropy": 1.3886997699737549, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 24000, "episodes_total": 420, "training_iteration": 6, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-46-04", "timestamp": 1581500764, "time_this_iter_s": 29.57716178894043, "time_total_s": 282.9713909626007, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7cec80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 282.9713909626007, "timesteps_since_restore": 24000, "iterations_since_restore": 6, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -27.922000000000008, "episode_len_mean": 51.65, "episodes_this_iter": 77, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -9.00709677419354}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.696753961421426, "mean_processing_ms": 4.65736480998036, "mean_inference_ms": 1.0350445714290977}, "off_policy_estimator": {}, "info": {"num_steps_trained": 74496, "num_steps_sampled": 28000, "sample_time_ms": 6315.323, "load_time_ms": 766.83, "grad_time_ms": 24322.981, "update_time_ms": 13116.53, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011548873037099838, "policy_loss": -0.01231778971850872, "vf_loss": 7.4087233543396, "vf_explained_var": -0.05253522843122482, "kl": 0.007615049835294485, "entropy": 1.414125680923462, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 28000, "episodes_total": 497, "training_iteration": 7, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-46-34", "timestamp": 1581500794, "time_this_iter_s": 30.235837697982788, "time_total_s": 313.2072286605835, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 313.2072286605835, "timesteps_since_restore": 28000, "iterations_since_restore": 7, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -26.379999999999985, "episode_len_mean": 52.36, "episodes_this_iter": 75, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -9.003412969283268}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.663141224473646, "mean_processing_ms": 4.651212536566103, "mean_inference_ms": 1.027126665063056}, "off_policy_estimator": {}, "info": {"num_steps_trained": 84352, "num_steps_sampled": 32000, "sample_time_ms": 6257.514, "load_time_ms": 672.454, "grad_time_ms": 23993.983, "update_time_ms": 11481.08, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.039216797798871994, "policy_loss": 0.038447003811597824, "vf_loss": 7.955567359924316, "vf_explained_var": -0.004600867163389921, "kl": 0.007618422619998455, "entropy": 1.4112422466278076, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 32000, "episodes_total": 572, "training_iteration": 8, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-47-02", "timestamp": 1581500822, "time_this_iter_s": 27.60444927215576, "time_total_s": 340.81167793273926, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 340.81167793273926, "timesteps_since_restore": 32000, "iterations_since_restore": 8, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -25.629999999999985, "episode_len_mean": 51.04, "episodes_this_iter": 79, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -9.15357142857142}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.654735655499915, "mean_processing_ms": 4.688648772836931, "mean_inference_ms": 1.0247858415333426}, "off_policy_estimator": {}, "info": {"num_steps_trained": 94464, "num_steps_sampled": 36000, "sample_time_ms": 6268.507, "load_time_ms": 598.934, "grad_time_ms": 23816.619, "update_time_ms": 10209.165, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00576940830796957, "policy_loss": 0.004179155454039574, "vf_loss": 7.592991352081299, "vf_explained_var": 0.004821367096155882, "kl": 0.01582660898566246, "entropy": 1.3581784963607788, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 36000, "episodes_total": 651, "training_iteration": 9, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-47-31", "timestamp": 1581500851, "time_this_iter_s": 28.815754890441895, "time_total_s": 369.62743282318115, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6a60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 369.62743282318115, "timesteps_since_restore": 36000, "iterations_since_restore": 9, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -26.025999999999982, "episode_len_mean": 50.08, "episodes_this_iter": 80, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -8.79256756756756}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.643859361459863, "mean_processing_ms": 4.7310910122816185, "mean_inference_ms": 1.0238700817530288}, "off_policy_estimator": {}, "info": {"num_steps_trained": 104704, "num_steps_sampled": 40000, "sample_time_ms": 6260.278, "load_time_ms": 540.143, "grad_time_ms": 23670.158, "update_time_ms": 9192.26, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04225345700979233, "policy_loss": 0.04138515517115593, "vf_loss": 7.192717552185059, "vf_explained_var": 0.007207437418401241, "kl": 0.008611058816313744, "entropy": 1.3354568481445312, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 40000, "episodes_total": 731, "training_iteration": 10, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-47-59", "timestamp": 1581500879, "time_this_iter_s": 28.604198694229126, "time_total_s": 398.2316315174103, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b67b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 398.2316315174103, "timesteps_since_restore": 40000, "iterations_since_restore": 10, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -5.200000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -24.36599999999997, "episode_len_mean": 49.75, "episodes_this_iter": 78, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -8.48989547038327}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.620846288697953, "mean_processing_ms": 4.758946686654186, "mean_inference_ms": 1.019764019899358}, "off_policy_estimator": {}, "info": {"num_steps_trained": 114432, "num_steps_sampled": 44000, "sample_time_ms": 6184.499, "load_time_ms": 15.154, "grad_time_ms": 22680.115, "update_time_ms": 33.812, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.027362901717424393, "policy_loss": 0.0264695193618536, "vf_loss": 8.018536567687988, "vf_explained_var": -0.016238143667578697, "kl": 0.008853625506162643, "entropy": 1.2869983911514282, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 44000, "episodes_total": 809, "training_iteration": 11, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-48-27", "timestamp": 1581500907, "time_this_iter_s": 27.59220242500305, "time_total_s": 425.82383394241333, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b62f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 425.82383394241333, "timesteps_since_restore": 44000, "iterations_since_restore": 11, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -23.687999999999985, "episode_len_mean": 47.67, "episodes_this_iter": 85, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -8.16827586206896}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5927573000323445, "mean_processing_ms": 4.7742382310722125, "mean_inference_ms": 1.0145834010713741}, "off_policy_estimator": {}, "info": {"num_steps_trained": 124544, "num_steps_sampled": 48000, "sample_time_ms": 6212.673, "load_time_ms": 14.667, "grad_time_ms": 22523.383, "update_time_ms": 33.801, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03580966219305992, "policy_loss": -0.03644077852368355, "vf_loss": 8.103800773620605, "vf_explained_var": -0.016973482444882393, "kl": 0.006230184342712164, "entropy": 1.2331067323684692, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 48000, "episodes_total": 894, "training_iteration": 12, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-48-56", "timestamp": 1581500936, "time_this_iter_s": 28.592793226242065, "time_total_s": 454.4166271686554, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 454.4166271686554, "timesteps_since_restore": 48000, "iterations_since_restore": 12, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -26.170000000000005, "episode_len_mean": 47.7, "episodes_this_iter": 84, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -8.255520504731855}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6097094396327645, "mean_processing_ms": 4.815389935601718, "mean_inference_ms": 1.0114947635856952}, "off_policy_estimator": {}, "info": {"num_steps_trained": 135808, "num_steps_sampled": 52000, "sample_time_ms": 6292.574, "load_time_ms": 13.78, "grad_time_ms": 22797.648, "update_time_ms": 33.892, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04821423441171646, "policy_loss": -0.04897506535053253, "vf_loss": 7.807209491729736, "vf_explained_var": 0.0012861598515883088, "kl": 0.007530217058956623, "entropy": 1.2244919538497925, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 52000, "episodes_total": 978, "training_iteration": 13, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-49-27", "timestamp": 1581500967, "time_this_iter_s": 31.595770359039307, "time_total_s": 486.0123975276947, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6d08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 486.0123975276947, "timesteps_since_restore": 52000, "iterations_since_restore": 13, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -5.200000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -23.913999999999977, "episode_len_mean": 49.11, "episodes_this_iter": 80, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -7.567721518987335}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.62113026675308, "mean_processing_ms": 4.803647434020874, "mean_inference_ms": 1.009522366920973}, "off_policy_estimator": {}, "info": {"num_steps_trained": 145280, "num_steps_sampled": 56000, "sample_time_ms": 6265.749, "load_time_ms": 13.658, "grad_time_ms": 22524.368, "update_time_ms": 33.344, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0007558977231383324, "policy_loss": -0.0018747755093500018, "vf_loss": 8.100539207458496, "vf_explained_var": 0.02111111208796501, "kl": 0.011107763275504112, "entropy": 1.2323116064071655, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 56000, "episodes_total": 1058, "training_iteration": 14, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-49-55", "timestamp": 1581500995, "time_this_iter_s": 27.494279384613037, "time_total_s": 513.5066769123077, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b60d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 513.5066769123077, "timesteps_since_restore": 56000, "iterations_since_restore": 14, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -5.000000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.901999999999997, "episode_len_mean": 41.25, "episodes_this_iter": 100, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.875657894736839}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.633464189570501, "mean_processing_ms": 4.870651977171679, "mean_inference_ms": 1.0080471328649474}, "off_policy_estimator": {}, "info": {"num_steps_trained": 155648, "num_steps_sampled": 60000, "sample_time_ms": 6348.842, "load_time_ms": 13.922, "grad_time_ms": 22617.794, "update_time_ms": 33.608, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02052389457821846, "policy_loss": 0.018949976190924644, "vf_loss": 8.193896293640137, "vf_explained_var": 0.01298072561621666, "kl": 0.01565726101398468, "entropy": 1.2338072061538696, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 60000, "episodes_total": 1158, "training_iteration": 15, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-50-25", "timestamp": 1581501025, "time_this_iter_s": 30.187978267669678, "time_total_s": 543.6946551799774, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6f28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 543.6946551799774, "timesteps_since_restore": 60000, "iterations_since_restore": 15, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.733999999999984, "episode_len_mean": 40.11, "episodes_this_iter": 95, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.735153583617743}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.623122025427602, "mean_processing_ms": 4.914975929232726, "mean_inference_ms": 1.006634543513056}, "off_policy_estimator": {}, "info": {"num_steps_trained": 165760, "num_steps_sampled": 64000, "sample_time_ms": 6425.106, "load_time_ms": 13.88, "grad_time_ms": 22471.689, "update_time_ms": 33.701, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.016682295128703117, "policy_loss": -0.017583932727575302, "vf_loss": 7.729024887084961, "vf_explained_var": 0.07486362755298615, "kl": 0.008939117193222046, "entropy": 1.2572802305221558, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 64000, "episodes_total": 1253, "training_iteration": 16, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-50-54", "timestamp": 1581501054, "time_this_iter_s": 28.88042140007019, "time_total_s": 572.5750765800476, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b61e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 572.5750765800476, "timesteps_since_restore": 64000, "iterations_since_restore": 16, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -21.30199999999998, "episode_len_mean": 43.45, "episodes_this_iter": 94, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -7.396527777777771}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6163555785463055, "mean_processing_ms": 4.945506276073133, "mean_inference_ms": 1.0048864364727976}, "off_policy_estimator": {}, "info": {"num_steps_trained": 175744, "num_steps_sampled": 68000, "sample_time_ms": 6447.999, "load_time_ms": 12.968, "grad_time_ms": 22276.48, "update_time_ms": 33.377, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.028652658686041832, "policy_loss": -0.029952896758913994, "vf_loss": 8.265890121459961, "vf_explained_var": 0.049153488129377365, "kl": 0.012919750064611435, "entropy": 1.3380216360092163, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 68000, "episodes_total": 1347, "training_iteration": 17, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-51-23", "timestamp": 1581501083, "time_this_iter_s": 28.502244472503662, "time_total_s": 601.0773210525513, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b66a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 601.0773210525513, "timesteps_since_restore": 68000, "iterations_since_restore": 17, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -21.03599999999998, "episode_len_mean": 41.35, "episodes_this_iter": 98, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -7.253793103448271}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6085438434184445, "mean_processing_ms": 4.989712561683298, "mean_inference_ms": 1.005693145747982}, "off_policy_estimator": {}, "info": {"num_steps_trained": 186112, "num_steps_sampled": 72000, "sample_time_ms": 6592.913, "load_time_ms": 14.053, "grad_time_ms": 22378.259, "update_time_ms": 33.505, "learner": {"policy_0": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.051355283707380295, "policy_loss": 0.050910454243421555, "vf_loss": 8.205533027648926, "vf_explained_var": 0.03795846924185753, "kl": 0.004366232082247734, "entropy": 1.3445184230804443, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 72000, "episodes_total": 1445, "training_iteration": 18, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-51-53", "timestamp": 1581501113, "time_this_iter_s": 30.084404706954956, "time_total_s": 631.1617257595062, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6ea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 631.1617257595062, "timesteps_since_restore": 72000, "iterations_since_restore": 18, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -5.000000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -21.027999999999988, "episode_len_mean": 39.65, "episodes_this_iter": 100, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -7.009333333333328}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.613296935975765, "mean_processing_ms": 5.0409159602267755, "mean_inference_ms": 1.0042896862296689}, "off_policy_estimator": {}, "info": {"num_steps_trained": 196736, "num_steps_sampled": 76000, "sample_time_ms": 6676.89, "load_time_ms": 14.347, "grad_time_ms": 22481.435, "update_time_ms": 33.317, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03193202242255211, "policy_loss": -0.03225288912653923, "vf_loss": 7.6760053634643555, "vf_explained_var": 0.06401129812002182, "kl": 0.006263683550059795, "entropy": 1.3497484922409058, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 76000, "episodes_total": 1545, "training_iteration": 19, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-52-24", "timestamp": 1581501144, "time_this_iter_s": 30.687561988830566, "time_total_s": 661.8492877483368, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6e18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 661.8492877483368, "timesteps_since_restore": 76000, "iterations_since_restore": 19, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.55599999999998, "episode_len_mean": 41.29, "episodes_this_iter": 97, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.968135593220334}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.602625831520938, "mean_processing_ms": 5.066352010878344, "mean_inference_ms": 1.0019280656457326}, "off_policy_estimator": {}, "info": {"num_steps_trained": 206848, "num_steps_sampled": 80000, "sample_time_ms": 6724.466, "load_time_ms": 14.394, "grad_time_ms": 22486.87, "update_time_ms": 32.609, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03676484897732735, "policy_loss": -0.03739936277270317, "vf_loss": 7.186829566955566, "vf_explained_var": 0.05366309732198715, "kl": 0.012546513229608536, "entropy": 1.3484183549880981, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 80000, "episodes_total": 1642, "training_iteration": 20, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-52-53", "timestamp": 1581501173, "time_this_iter_s": 29.12897539138794, "time_total_s": 690.9782631397247, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 690.9782631397247, "timesteps_since_restore": 80000, "iterations_since_restore": 20, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.89708737864076, "episode_len_mean": 39.067961165048544, "episodes_this_iter": 103, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.238461538461534}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.615771950093948, "mean_processing_ms": 5.107947219809142, "mean_inference_ms": 1.0025721485956178}, "off_policy_estimator": {}, "info": {"num_steps_trained": 216704, "num_steps_sampled": 84000, "sample_time_ms": 6821.494, "load_time_ms": 13.895, "grad_time_ms": 22508.086, "update_time_ms": 33.035, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.050325263291597366, "policy_loss": -0.05096086114645004, "vf_loss": 7.261354923248291, "vf_explained_var": 0.09504622220993042, "kl": 0.01256669219583273, "entropy": 1.2911957502365112, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 84000, "episodes_total": 1745, "training_iteration": 21, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-53-22", "timestamp": 1581501202, "time_this_iter_s": 28.773593425750732, "time_total_s": 719.7518565654755, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6c80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 719.7518565654755, "timesteps_since_restore": 84000, "iterations_since_restore": 21, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.373999999999988, "episode_len_mean": 39.31, "episodes_this_iter": 96, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.614935064935061}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.623974259862004, "mean_processing_ms": 5.146904265958089, "mean_inference_ms": 1.003002678289712}, "off_policy_estimator": {}, "info": {"num_steps_trained": 227328, "num_steps_sampled": 88000, "sample_time_ms": 6861.852, "load_time_ms": 14.609, "grad_time_ms": 22633.816, "update_time_ms": 32.975, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0015029781498014927, "policy_loss": -0.002131723565980792, "vf_loss": 7.821300983428955, "vf_explained_var": 0.06817696243524551, "kl": 0.012418452650308609, "entropy": 1.3197423219680786, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 88000, "episodes_total": 1841, "training_iteration": 22, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-53-52", "timestamp": 1581501232, "time_this_iter_s": 30.260170936584473, "time_total_s": 750.0120275020599, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 750.0120275020599, "timesteps_since_restore": 88000, "iterations_since_restore": 22, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -21.475247524752465, "episode_len_mean": 41.415841584158414, "episodes_this_iter": 101, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -7.019417475728149}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.620092761065023, "mean_processing_ms": 5.178820608480388, "mean_inference_ms": 1.0022916931130987}, "off_policy_estimator": {}, "info": {"num_steps_trained": 237824, "num_steps_sampled": 92000, "sample_time_ms": 6861.787, "load_time_ms": 14.54, "grad_time_ms": 22469.665, "update_time_ms": 32.909, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0447663776576519, "policy_loss": -0.04539487510919571, "vf_loss": 7.5256547927856445, "vf_explained_var": 0.0590522475540638, "kl": 0.012419483624398708, "entropy": 1.3264713287353516, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 92000, "episodes_total": 1942, "training_iteration": 23, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-54-22", "timestamp": 1581501262, "time_this_iter_s": 29.951576471328735, "time_total_s": 779.9636039733887, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 779.9636039733887, "timesteps_since_restore": 92000, "iterations_since_restore": 23, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -22.047999999999988, "episode_len_mean": 42.17, "episodes_this_iter": 91, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.847204968944094}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.625480363189578, "mean_processing_ms": 5.18126540712058, "mean_inference_ms": 1.0002139941079158}, "off_policy_estimator": {}, "info": {"num_steps_trained": 248576, "num_steps_sampled": 96000, "sample_time_ms": 6906.493, "load_time_ms": 14.023, "grad_time_ms": 22712.664, "update_time_ms": 32.852, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02026706002652645, "policy_loss": 0.019633380696177483, "vf_loss": 7.494584083557129, "vf_explained_var": 0.08057833462953568, "kl": 0.01252360176295042, "entropy": 1.3166502714157104, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 96000, "episodes_total": 2033, "training_iteration": 24, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-54-53", "timestamp": 1581501293, "time_this_iter_s": 30.364415168762207, "time_total_s": 810.3280191421509, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6d90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 810.3280191421509, "timesteps_since_restore": 96000, "iterations_since_restore": 24, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.823999999999987, "episode_len_mean": 39.8, "episodes_this_iter": 100, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.610793650793647}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.624215190241108, "mean_processing_ms": 5.204860509029313, "mean_inference_ms": 1.0017661262924649}, "off_policy_estimator": {}, "info": {"num_steps_trained": 259072, "num_steps_sampled": 100000, "sample_time_ms": 6859.529, "load_time_ms": 14.588, "grad_time_ms": 22751.223, "update_time_ms": 32.479, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01350811030715704, "policy_loss": -0.01423467043787241, "vf_loss": 7.533873081207275, "vf_explained_var": 0.0871770977973938, "kl": 0.014380527660250664, "entropy": 1.31315279006958, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 100000, "episodes_total": 2133, "training_iteration": 25, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-55-23", "timestamp": 1581501323, "time_this_iter_s": 30.106770038604736, "time_total_s": 840.4347891807556, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6ae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 840.4347891807556, "timesteps_since_restore": 100000, "iterations_since_restore": 25, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -21.247999999999994, "episode_len_mean": 40.61, "episodes_this_iter": 100, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.724050632911388}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.628843566713798, "mean_processing_ms": 5.223229151952392, "mean_inference_ms": 1.0004029518636066}, "off_policy_estimator": {}, "info": {"num_steps_trained": 269952, "num_steps_sampled": 104000, "sample_time_ms": 6875.072, "load_time_ms": 14.704, "grad_time_ms": 22929.563, "update_time_ms": 32.508, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.015433389693498611, "policy_loss": 0.014807382598519325, "vf_loss": 7.071817398071289, "vf_explained_var": 0.08834238350391388, "kl": 0.012378728948533535, "entropy": 1.2676550149917603, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 104000, "episodes_total": 2233, "training_iteration": 26, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-55-54", "timestamp": 1581501354, "time_this_iter_s": 30.819923639297485, "time_total_s": 871.2547128200531, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 871.2547128200531, "timesteps_since_restore": 104000, "iterations_since_restore": 26, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -5.200000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -21.305999999999994, "episode_len_mean": 39.84, "episodes_this_iter": 99, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.637383177570089}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.630227975509726, "mean_processing_ms": 5.235681246238495, "mean_inference_ms": 0.9990478554466402}, "off_policy_estimator": {}, "info": {"num_steps_trained": 280704, "num_steps_sampled": 108000, "sample_time_ms": 6876.722, "load_time_ms": 14.605, "grad_time_ms": 23106.326, "update_time_ms": 32.599, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0018160315230488777, "policy_loss": 0.0013636421645060182, "vf_loss": 7.506566524505615, "vf_explained_var": 0.05325240641832352, "kl": 0.008897609077394009, "entropy": 1.2256821393966675, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 108000, "episodes_total": 2332, "training_iteration": 27, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-56-24", "timestamp": 1581501384, "time_this_iter_s": 30.28808832168579, "time_total_s": 901.5428011417389, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 901.5428011417389, "timesteps_since_restore": 108000, "iterations_since_restore": 27, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -5.200000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -22.567999999999984, "episode_len_mean": 43.55, "episodes_this_iter": 91, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -7.119242902208197}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.639251221331454, "mean_processing_ms": 5.256882668664457, "mean_inference_ms": 0.9989407235210878}, "off_policy_estimator": {}, "info": {"num_steps_trained": 291200, "num_steps_sampled": 112000, "sample_time_ms": 6857.832, "load_time_ms": 14.06, "grad_time_ms": 23145.676, "update_time_ms": 32.758, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013689856976270676, "policy_loss": 0.012930480763316154, "vf_loss": 7.158727169036865, "vf_explained_var": 0.08069086074829102, "kl": 0.015044174157083035, "entropy": 1.2431213855743408, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 112000, "episodes_total": 2423, "training_iteration": 28, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-56-55", "timestamp": 1581501415, "time_this_iter_s": 30.28349494934082, "time_total_s": 931.8262960910797, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 931.8262960910797, "timesteps_since_restore": 112000, "iterations_since_restore": 28, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.499065420560743, "episode_len_mean": 37.691588785046726, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.284337349397586}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.637289720397266, "mean_processing_ms": 5.283412653035259, "mean_inference_ms": 0.9986929267748348}, "off_policy_estimator": {}, "info": {"num_steps_trained": 301696, "num_steps_sampled": 116000, "sample_time_ms": 6856.282, "load_time_ms": 14.04, "grad_time_ms": 23497.117, "update_time_ms": 32.918, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.07227632403373718, "policy_loss": 0.07175089418888092, "vf_loss": 7.4913859367370605, "vf_explained_var": 0.11318328976631165, "kl": 0.010358585976064205, "entropy": 1.2064614295959473, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 116000, "episodes_total": 2530, "training_iteration": 29, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-57-29", "timestamp": 1581501449, "time_this_iter_s": 34.188244581222534, "time_total_s": 966.0145406723022, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7cebf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 966.0145406723022, "timesteps_since_restore": 116000, "iterations_since_restore": 29, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.64912280701753, "episode_len_mean": 35.771929824561404, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.952662721893487}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.655582962182033, "mean_processing_ms": 5.340558767463585, "mean_inference_ms": 1.002436248257723}, "off_policy_estimator": {}, "info": {"num_steps_trained": 311808, "num_steps_sampled": 120000, "sample_time_ms": 6983.96, "load_time_ms": 14.096, "grad_time_ms": 23784.706, "update_time_ms": 33.187, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.017191456630825996, "policy_loss": 0.01682961732149124, "vf_loss": 6.673131942749023, "vf_explained_var": 0.11727967113256454, "kl": 0.007103338837623596, "entropy": 1.216963529586792, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 120000, "episodes_total": 2644, "training_iteration": 30, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-58-02", "timestamp": 1581501482, "time_this_iter_s": 33.28663659095764, "time_total_s": 999.3011772632599, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 999.3011772632599, "timesteps_since_restore": 120000, "iterations_since_restore": 30, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.541592920353978, "episode_len_mean": 35.02654867256637, "episodes_this_iter": 113, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.1559006211180085}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.651525590582204, "mean_processing_ms": 5.38582176878406, "mean_inference_ms": 1.0051002580568604}, "off_policy_estimator": {}, "info": {"num_steps_trained": 322048, "num_steps_sampled": 124000, "sample_time_ms": 7075.214, "load_time_ms": 15.057, "grad_time_ms": 24006.925, "update_time_ms": 33.579, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.010311690159142017, "policy_loss": 0.0098011689260602, "vf_loss": 6.819557189941406, "vf_explained_var": 0.1375696212053299, "kl": 0.01007399708032608, "entropy": 1.1395267248153687, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 124000, "episodes_total": 2757, "training_iteration": 31, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-58-34", "timestamp": 1581501514, "time_this_iter_s": 31.92445182800293, "time_total_s": 1031.2256290912628, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1031.2256290912628, "timesteps_since_restore": 124000, "iterations_since_restore": 31, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.23960396039603, "episode_len_mean": 39.28712871287129, "episodes_this_iter": 101, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.976791808873715}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.644817251187982, "mean_processing_ms": 5.415610813505446, "mean_inference_ms": 1.007402753272256}, "off_policy_estimator": {}, "info": {"num_steps_trained": 332544, "num_steps_sampled": 128000, "sample_time_ms": 7181.152, "load_time_ms": 14.451, "grad_time_ms": 24104.836, "update_time_ms": 33.841, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02984900213778019, "policy_loss": 0.02949061617255211, "vf_loss": 7.4324517250061035, "vf_explained_var": 0.0781097486615181, "kl": 0.007019015494734049, "entropy": 1.2422353029251099, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 128000, "episodes_total": 2858, "training_iteration": 32, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-59-07", "timestamp": 1581501547, "time_this_iter_s": 32.29535531997681, "time_total_s": 1063.5209844112396, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce9d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1063.5209844112396, "timesteps_since_restore": 128000, "iterations_since_restore": 32, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.06666666666666, "episode_len_mean": 37.31428571428572, "episodes_this_iter": 105, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.625786163522007}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.658259773399805, "mean_processing_ms": 5.441903877574623, "mean_inference_ms": 1.0103899275460742}, "off_policy_estimator": {}, "info": {"num_steps_trained": 343424, "num_steps_sampled": 132000, "sample_time_ms": 7239.69, "load_time_ms": 14.464, "grad_time_ms": 24342.825, "update_time_ms": 34.085, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014258126728236675, "policy_loss": 0.013745578937232494, "vf_loss": 7.038454532623291, "vf_explained_var": 0.12149520218372345, "kl": 0.010110271163284779, "entropy": 1.1760499477386475, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 132000, "episodes_total": 2963, "training_iteration": 33, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_09-59-40", "timestamp": 1581501580, "time_this_iter_s": 32.91903614997864, "time_total_s": 1096.4400205612183, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce7b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1096.4400205612183, "timesteps_since_restore": 132000, "iterations_since_restore": 33, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.099099099099092, "episode_len_mean": 36.72072072072072, "episodes_this_iter": 111, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.091954022988502}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.658208152660113, "mean_processing_ms": 5.471476067545407, "mean_inference_ms": 1.0107049879737733}, "off_policy_estimator": {}, "info": {"num_steps_trained": 354048, "num_steps_sampled": 136000, "sample_time_ms": 7265.649, "load_time_ms": 15.14, "grad_time_ms": 24409.39, "update_time_ms": 34.412, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02114846557378769, "policy_loss": 0.020448822528123856, "vf_loss": 6.685083389282227, "vf_explained_var": 0.14163336157798767, "kl": 0.01385911088436842, "entropy": 1.15536630153656, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 136000, "episodes_total": 3074, "training_iteration": 34, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-00-11", "timestamp": 1581501611, "time_this_iter_s": 31.302825212478638, "time_total_s": 1127.742845773697, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1127.742845773697, "timesteps_since_restore": 136000, "iterations_since_restore": 34, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.59444444444443, "episode_len_mean": 37.101851851851855, "episodes_this_iter": 108, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.8719298245614}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.669122695294231, "mean_processing_ms": 5.49958529832923, "mean_inference_ms": 1.0134694578166843}, "off_policy_estimator": {}, "info": {"num_steps_trained": 364288, "num_steps_sampled": 140000, "sample_time_ms": 7369.755, "load_time_ms": 14.536, "grad_time_ms": 24388.679, "update_time_ms": 34.878, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02033652924001217, "policy_loss": -0.02073594555258751, "vf_loss": 7.10034704208374, "vf_explained_var": 0.12993179261684418, "kl": 0.007846297696232796, "entropy": 1.1169817447662354, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 140000, "episodes_total": 3182, "training_iteration": 35, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-00-42", "timestamp": 1581501642, "time_this_iter_s": 30.938488721847534, "time_total_s": 1158.6813344955444, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1158.6813344955444, "timesteps_since_restore": 140000, "iterations_since_restore": 35, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -5.000000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.653333333333325, "episode_len_mean": 37.285714285714285, "episodes_this_iter": 105, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.310703363914369}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6638377620896545, "mean_processing_ms": 5.517235737619766, "mean_inference_ms": 1.0137882149192878}, "off_policy_estimator": {}, "info": {"num_steps_trained": 375040, "num_steps_sampled": 144000, "sample_time_ms": 7397.877, "load_time_ms": 14.782, "grad_time_ms": 24417.294, "update_time_ms": 34.761, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03794361650943756, "policy_loss": -0.038504522293806076, "vf_loss": 7.129130840301514, "vf_explained_var": 0.08863907307386398, "kl": 0.011075562797486782, "entropy": 1.1132376194000244, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 144000, "episodes_total": 3287, "training_iteration": 36, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-01-14", "timestamp": 1581501674, "time_this_iter_s": 31.38912534713745, "time_total_s": 1190.0704598426819, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1190.0704598426819, "timesteps_since_restore": 144000, "iterations_since_restore": 36, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -5.000000000000002, "episode_reward_min": -38.80000000000001, "episode_reward_mean": -17.24833333333332, "episode_len_mean": 34.425, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.594054054054051}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.677306770066047, "mean_processing_ms": 5.559758417812591, "mean_inference_ms": 1.0152585398761835}, "off_policy_estimator": {}, "info": {"num_steps_trained": 385280, "num_steps_sampled": 148000, "sample_time_ms": 7506.751, "load_time_ms": 15.597, "grad_time_ms": 24382.564, "update_time_ms": 34.913, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0031318184919655323, "policy_loss": -0.0037408575881272554, "vf_loss": 6.20590877532959, "vf_explained_var": 0.19091936945915222, "kl": 0.012056544423103333, "entropy": 1.145188808441162, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 148000, "episodes_total": 3407, "training_iteration": 37, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-01-45", "timestamp": 1581501705, "time_this_iter_s": 31.036898851394653, "time_total_s": 1221.1073586940765, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1221.1073586940765, "timesteps_since_restore": 148000, "iterations_since_restore": 37, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.489523809523796, "episode_len_mean": 38.285714285714285, "episodes_this_iter": 105, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.415047021943568}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.676450704126722, "mean_processing_ms": 5.5837445519330196, "mean_inference_ms": 1.0174102666658102}, "off_policy_estimator": {}, "info": {"num_steps_trained": 395648, "num_steps_sampled": 152000, "sample_time_ms": 7526.655, "load_time_ms": 15.106, "grad_time_ms": 24424.108, "update_time_ms": 34.832, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.015392656438052654, "policy_loss": 0.014785844832658768, "vf_loss": 6.710569858551025, "vf_explained_var": 0.1021556407213211, "kl": 0.012002049013972282, "entropy": 1.1638374328613281, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 152000, "episodes_total": 3512, "training_iteration": 38, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-02-16", "timestamp": 1581501736, "time_this_iter_s": 30.89280915260315, "time_total_s": 1252.0001678466797, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce8c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1252.0001678466797, "timesteps_since_restore": 152000, "iterations_since_restore": 38, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.365999999999982, "episode_len_mean": 40.11, "episodes_this_iter": 97, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.444936708860755}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.680263551588902, "mean_processing_ms": 5.598022337918743, "mean_inference_ms": 1.0181489331899753}, "off_policy_estimator": {}, "info": {"num_steps_trained": 406016, "num_steps_sampled": 156000, "sample_time_ms": 7551.762, "load_time_ms": 14.944, "grad_time_ms": 24117.146, "update_time_ms": 34.959, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0016302113654091954, "policy_loss": 0.0006564134382642806, "vf_loss": 8.165955543518066, "vf_explained_var": 0.08965780586004257, "kl": 0.019312622025609016, "entropy": 1.143500566482544, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 156000, "episodes_total": 3609, "training_iteration": 39, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-02-47", "timestamp": 1581501767, "time_this_iter_s": 31.37120485305786, "time_total_s": 1283.3713726997375, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6b70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1283.3713726997375, "timesteps_since_restore": 156000, "iterations_since_restore": 39, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.545794392523348, "episode_len_mean": 38.018691588785046, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.318429003021144}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.691308951551355, "mean_processing_ms": 5.625681904030099, "mean_inference_ms": 1.019919195558371}, "off_policy_estimator": {}, "info": {"num_steps_trained": 416512, "num_steps_sampled": 160000, "sample_time_ms": 7512.338, "load_time_ms": 15.586, "grad_time_ms": 23897.853, "update_time_ms": 35.652, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02805572934448719, "policy_loss": -0.028653062880039215, "vf_loss": 7.202327251434326, "vf_explained_var": 0.1362992823123932, "kl": 0.011802728287875652, "entropy": 1.1002072095870972, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 160000, "episodes_total": 3716, "training_iteration": 40, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-03-18", "timestamp": 1581501798, "time_this_iter_s": 30.712003707885742, "time_total_s": 1314.0833764076233, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7cef28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1314.0833764076233, "timesteps_since_restore": 160000, "iterations_since_restore": 40, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.769230769230766, "episode_len_mean": 37.47115384615385, "episodes_this_iter": 104, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.196825396825393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.681338377598206, "mean_processing_ms": 5.63740583443437, "mean_inference_ms": 1.0188259107873525}, "off_policy_estimator": {}, "info": {"num_steps_trained": 426752, "num_steps_sampled": 164000, "sample_time_ms": 7438.827, "load_time_ms": 14.767, "grad_time_ms": 23739.628, "update_time_ms": 35.333, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.023709194734692574, "policy_loss": -0.024168966338038445, "vf_loss": 6.8085479736328125, "vf_explained_var": 0.15984156727790833, "kl": 0.009059175848960876, "entropy": 1.0886876583099365, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 164000, "episodes_total": 3820, "training_iteration": 41, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-03-48", "timestamp": 1581501828, "time_this_iter_s": 29.59549069404602, "time_total_s": 1343.6788671016693, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1343.6788671016693, "timesteps_since_restore": 164000, "iterations_since_restore": 41, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.797999999999984, "episode_len_mean": 41.32, "episodes_this_iter": 97, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.864026402640259}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.685602770525708, "mean_processing_ms": 5.624472340577405, "mean_inference_ms": 1.0182108249414785}, "off_policy_estimator": {}, "info": {"num_steps_trained": 436992, "num_steps_sampled": 168000, "sample_time_ms": 7350.466, "load_time_ms": 14.548, "grad_time_ms": 23532.128, "update_time_ms": 35.082, "learner": {"policy_0": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04319102689623833, "policy_loss": -0.04435507953166962, "vf_loss": 7.109929084777832, "vf_explained_var": 0.07209176570177078, "kl": 0.023138761520385742, "entropy": 1.0219212770462036, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 168000, "episodes_total": 3917, "training_iteration": 42, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-04-17", "timestamp": 1581501857, "time_this_iter_s": 29.333017826080322, "time_total_s": 1373.0118849277496, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b68c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1373.0118849277496, "timesteps_since_restore": 168000, "iterations_since_restore": 42, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.515686274509793, "episode_len_mean": 39.833333333333336, "episodes_this_iter": 102, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.728617363344047}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.683763435088497, "mean_processing_ms": 5.627442276641668, "mean_inference_ms": 1.0172956936610646}, "off_policy_estimator": {}, "info": {"num_steps_trained": 447360, "num_steps_sampled": 172000, "sample_time_ms": 7307.311, "load_time_ms": 14.49, "grad_time_ms": 23270.333, "update_time_ms": 34.887, "learner": {"policy_0": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": -0.012149509973824024, "policy_loss": -0.013254686258733273, "vf_loss": 7.242974758148193, "vf_explained_var": 0.12975719571113586, "kl": 0.014639083296060562, "entropy": 1.064186930656433, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 172000, "episodes_total": 4019, "training_iteration": 43, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-04-47", "timestamp": 1581501887, "time_this_iter_s": 29.868605136871338, "time_total_s": 1402.880490064621, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1402.880490064621, "timesteps_since_restore": 172000, "iterations_since_restore": 43, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.765999999999984, "episode_len_mean": 40.01, "episodes_this_iter": 98, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.65521885521885}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.677265470876969, "mean_processing_ms": 5.623845947186864, "mean_inference_ms": 1.0173771753029184}, "off_policy_estimator": {}, "info": {"num_steps_trained": 457600, "num_steps_sampled": 176000, "sample_time_ms": 7315.975, "load_time_ms": 14.496, "grad_time_ms": 23085.446, "update_time_ms": 34.968, "learner": {"policy_0": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.026498664170503616, "policy_loss": 0.025982419028878212, "vf_loss": 7.780808925628662, "vf_explained_var": 0.13379472494125366, "kl": 0.006779597606509924, "entropy": 1.0658382177352905, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 176000, "episodes_total": 4117, "training_iteration": 44, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-05-17", "timestamp": 1581501917, "time_this_iter_s": 29.53908348083496, "time_total_s": 1432.419573545456, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1432.419573545456, "timesteps_since_restore": 176000, "iterations_since_restore": 44, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -23.69799999999998, "episode_len_mean": 46.03, "episodes_this_iter": 89, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -7.694155844155839}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6874208689567185, "mean_processing_ms": 5.633990388672272, "mean_inference_ms": 1.0170122655071299}, "off_policy_estimator": {}, "info": {"num_steps_trained": 467968, "num_steps_sampled": 180000, "sample_time_ms": 7199.561, "load_time_ms": 14.547, "grad_time_ms": 23075.782, "update_time_ms": 34.949, "learner": {"policy_0": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0172407329082489, "policy_loss": -0.018089329823851585, "vf_loss": 7.4110212326049805, "vf_explained_var": 0.08931376785039902, "kl": 0.011215764097869396, "entropy": 1.0243420600891113, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 180000, "episodes_total": 4206, "training_iteration": 45, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-05-47", "timestamp": 1581501947, "time_this_iter_s": 29.677347898483276, "time_total_s": 1462.0969214439392, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7cee18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1462.0969214439392, "timesteps_since_restore": 180000, "iterations_since_restore": 45, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.08627450980391, "episode_len_mean": 39.28431372549019, "episodes_this_iter": 102, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.545686900958462}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.692926307782289, "mean_processing_ms": 5.6509800294720325, "mean_inference_ms": 1.0170619808042505}, "off_policy_estimator": {}, "info": {"num_steps_trained": 478336, "num_steps_sampled": 184000, "sample_time_ms": 7196.834, "load_time_ms": 14.263, "grad_time_ms": 22922.945, "update_time_ms": 34.912, "learner": {"policy_0": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00943151954561472, "policy_loss": 0.008287078700959682, "vf_loss": 7.055464267730713, "vf_explained_var": 0.1493557244539261, "kl": 0.015165155753493309, "entropy": 0.9378218650817871, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 184000, "episodes_total": 4308, "training_iteration": 46, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-06-16", "timestamp": 1581501976, "time_this_iter_s": 29.829216480255127, "time_total_s": 1491.9261379241943, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ceae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1491.9261379241943, "timesteps_since_restore": 184000, "iterations_since_restore": 46, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.803999999999977, "episode_len_mean": 41.22, "episodes_this_iter": 96, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.776547231270353}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.699784700167727, "mean_processing_ms": 5.656275736124573, "mean_inference_ms": 1.0171013676512732}, "off_policy_estimator": {}, "info": {"num_steps_trained": 488704, "num_steps_sampled": 188000, "sample_time_ms": 7157.784, "load_time_ms": 14.149, "grad_time_ms": 22871.838, "update_time_ms": 34.89, "learner": {"policy_0": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.008913781493902206, "policy_loss": 0.0083169499412179, "vf_loss": 7.397976398468018, "vf_explained_var": 0.10796404629945755, "kl": 0.007859116420149803, "entropy": 0.9018207788467407, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 188000, "episodes_total": 4404, "training_iteration": 47, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-06-47", "timestamp": 1581502007, "time_this_iter_s": 30.133445739746094, "time_total_s": 1522.0595836639404, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff2b5b519d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1522.0595836639404, "timesteps_since_restore": 188000, "iterations_since_restore": 47, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.20980392156861, "episode_len_mean": 39.77450980392157, "episodes_this_iter": 102, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.482389937106914}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6956597438084025, "mean_processing_ms": 5.660582623553471, "mean_inference_ms": 1.0163074347736518}, "off_policy_estimator": {}, "info": {"num_steps_trained": 499072, "num_steps_sampled": 192000, "sample_time_ms": 7114.865, "load_time_ms": 14.114, "grad_time_ms": 22791.408, "update_time_ms": 34.777, "learner": {"policy_0": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0312516912817955, "policy_loss": 0.030577052384614944, "vf_loss": 7.454044342041016, "vf_explained_var": 0.15377452969551086, "kl": 0.008895830251276493, "entropy": 0.9016671180725098, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 192000, "episodes_total": 4506, "training_iteration": 48, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-07-16", "timestamp": 1581502036, "time_this_iter_s": 29.66231656074524, "time_total_s": 1551.7219002246857, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1551.7219002246857, "timesteps_since_restore": 192000, "iterations_since_restore": 48, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.754782608695642, "episode_len_mean": 34.278260869565216, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.023008849557518}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.687438758357761, "mean_processing_ms": 5.671237375090708, "mean_inference_ms": 1.0163985784151217}, "off_policy_estimator": {}, "info": {"num_steps_trained": 509568, "num_steps_sampled": 196000, "sample_time_ms": 7113.72, "load_time_ms": 14.13, "grad_time_ms": 22681.685, "update_time_ms": 34.602, "learner": {"policy_0": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.040100984275341034, "policy_loss": 0.039781488478183746, "vf_loss": 7.651028633117676, "vf_explained_var": 0.10786442458629608, "kl": 0.004157933406531811, "entropy": 0.9136319160461426, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 196000, "episodes_total": 4621, "training_iteration": 49, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-07-47", "timestamp": 1581502067, "time_this_iter_s": 30.25881576538086, "time_total_s": 1581.9807159900665, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff2b5b51bf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1581.9807159900665, "timesteps_since_restore": 196000, "iterations_since_restore": 49, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.431481481481477, "episode_len_mean": 37.574074074074076, "episodes_this_iter": 108, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.831578947368417}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.699546975951228, "mean_processing_ms": 5.688188485794363, "mean_inference_ms": 1.0169299412899475}, "off_policy_estimator": {}, "info": {"num_steps_trained": 520576, "num_steps_sampled": 200000, "sample_time_ms": 7077.341, "load_time_ms": 14.683, "grad_time_ms": 22785.253, "update_time_ms": 33.762, "learner": {"policy_0": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.029844341799616814, "policy_loss": 0.029412882402539253, "vf_loss": 7.402658939361572, "vf_explained_var": 0.07814072072505951, "kl": 0.011308059096336365, "entropy": 0.893719494342804, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 200000, "episodes_total": 4729, "training_iteration": 50, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-08-18", "timestamp": 1581502098, "time_this_iter_s": 31.381609678268433, "time_total_s": 1613.362325668335, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b6bf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1613.362325668335, "timesteps_since_restore": 200000, "iterations_since_restore": 50, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.5128205128205, "episode_len_mean": 34.495726495726494, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.224137931034479}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.690639838658324, "mean_processing_ms": 5.712639886108663, "mean_inference_ms": 1.0160209657632082}, "off_policy_estimator": {}, "info": {"num_steps_trained": 531584, "num_steps_sampled": 204000, "sample_time_ms": 7073.369, "load_time_ms": 14.676, "grad_time_ms": 22943.435, "update_time_ms": 33.561, "learner": {"policy_0": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0063890391029417515, "policy_loss": 0.006100121419876814, "vf_loss": 7.141729831695557, "vf_explained_var": 0.05605598911643028, "kl": 0.007513981778174639, "entropy": 0.8904017806053162, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 204000, "episodes_total": 4846, "training_iteration": 51, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-08-50", "timestamp": 1581502130, "time_this_iter_s": 31.134811401367188, "time_total_s": 1644.4971370697021, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff2b5b51c80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1644.4971370697021, "timesteps_since_restore": 204000, "iterations_since_restore": 51, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -21.254901960784306, "episode_len_mean": 37.73529411764706, "episodes_this_iter": 102, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.948717948717943}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.682056438309822, "mean_processing_ms": 5.7156763887304285, "mean_inference_ms": 1.0148444671533392}, "off_policy_estimator": {}, "info": {"num_steps_trained": 542976, "num_steps_sampled": 208000, "sample_time_ms": 7068.064, "load_time_ms": 15.021, "grad_time_ms": 23220.07, "update_time_ms": 33.863, "learner": {"policy_0": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.004492477979511023, "policy_loss": 0.004115932621061802, "vf_loss": 8.332537651062012, "vf_explained_var": 0.014854629524052143, "kl": 0.009818953461945057, "entropy": 0.8408443927764893, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 208000, "episodes_total": 4948, "training_iteration": 52, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-09-22", "timestamp": 1581502162, "time_this_iter_s": 32.052420139312744, "time_total_s": 1676.549557209015, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff2b5b5e268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1676.549557209015, "timesteps_since_restore": 208000, "iterations_since_restore": 52, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.282882882882877, "episode_len_mean": 36.73873873873874, "episodes_this_iter": 111, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.389253731343279}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.69380052568409, "mean_processing_ms": 5.735816988098531, "mean_inference_ms": 1.0157452331363621}, "off_policy_estimator": {}, "info": {"num_steps_trained": 553728, "num_steps_sampled": 212000, "sample_time_ms": 7109.249, "load_time_ms": 15.676, "grad_time_ms": 23307.494, "update_time_ms": 33.936, "learner": {"policy_0": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011926491744816303, "policy_loss": -0.012386991642415524, "vf_loss": 7.9642767906188965, "vf_explained_var": 0.04841342940926552, "kl": 0.012067618779838085, "entropy": 0.8375067710876465, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 212000, "episodes_total": 5059, "training_iteration": 53, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-09-53", "timestamp": 1581502193, "time_this_iter_s": 31.16203284263611, "time_total_s": 1707.711590051651, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff2b5b51b70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1707.711590051651, "timesteps_since_restore": 212000, "iterations_since_restore": 53, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -21.27999999999999, "episode_len_mean": 40.71, "episodes_this_iter": 98, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.820512820512815}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.703216998181103, "mean_processing_ms": 5.73878143090829, "mean_inference_ms": 1.0148162472390472}, "off_policy_estimator": {}, "info": {"num_steps_trained": 564352, "num_steps_sampled": 216000, "sample_time_ms": 7123.58, "load_time_ms": 14.983, "grad_time_ms": 23391.836, "update_time_ms": 33.962, "learner": {"policy_0": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.010823486372828484, "policy_loss": -0.011262387968599796, "vf_loss": 8.289693832397461, "vf_explained_var": 0.005617043934762478, "kl": 0.011482836678624153, "entropy": 0.8109542727470398, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 216000, "episodes_total": 5157, "training_iteration": 54, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-10-24", "timestamp": 1581502224, "time_this_iter_s": 30.518913507461548, "time_total_s": 1738.2305035591125, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff2b5b51d08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1738.2305035591125, "timesteps_since_restore": 216000, "iterations_since_restore": 54, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -22.405999999999995, "episode_len_mean": 40.35, "episodes_this_iter": 99, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.958385093167697}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.688861215715642, "mean_processing_ms": 5.726716668729106, "mean_inference_ms": 1.0158367500610255}, "off_policy_estimator": {}, "info": {"num_steps_trained": 575616, "num_steps_sampled": 220000, "sample_time_ms": 7152.998, "load_time_ms": 14.843, "grad_time_ms": 23577.275, "update_time_ms": 33.383, "learner": {"policy_0": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.016737492755055428, "policy_loss": 0.01635938137769699, "vf_loss": 8.355234146118164, "vf_explained_var": 0.01900762878358364, "kl": 0.009860261343419552, "entropy": 0.8615232706069946, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 220000, "episodes_total": 5256, "training_iteration": 55, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-10-56", "timestamp": 1581502256, "time_this_iter_s": 31.819106101989746, "time_total_s": 1770.0496096611023, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1770.0496096611023, "timesteps_since_restore": 220000, "iterations_since_restore": 55, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.743396226415083, "episode_len_mean": 37.820754716981135, "episodes_this_iter": 106, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.429239766081866}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.684914435743157, "mean_processing_ms": 5.7400576074212175, "mean_inference_ms": 1.0152047668403372}, "off_policy_estimator": {}, "info": {"num_steps_trained": 586624, "num_steps_sampled": 224000, "sample_time_ms": 7189.166, "load_time_ms": 15.419, "grad_time_ms": 23722.28, "update_time_ms": 33.449, "learner": {"policy_0": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.009274165146052837, "policy_loss": -0.009603203274309635, "vf_loss": 7.726531982421875, "vf_explained_var": 0.07129333168268204, "kl": 0.008568407036364079, "entropy": 0.796917736530304, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 224000, "episodes_total": 5362, "training_iteration": 56, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-11-27", "timestamp": 1581502287, "time_this_iter_s": 31.648334503173828, "time_total_s": 1801.6979441642761, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce0d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1801.6979441642761, "timesteps_since_restore": 224000, "iterations_since_restore": 56, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.514851485148498, "episode_len_mean": 38.59405940594059, "episodes_this_iter": 101, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.277070063694264}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.690957185598572, "mean_processing_ms": 5.742163360884087, "mean_inference_ms": 1.0147322426827619}, "off_policy_estimator": {}, "info": {"num_steps_trained": 596992, "num_steps_sampled": 228000, "sample_time_ms": 7112.847, "load_time_ms": 14.753, "grad_time_ms": 23715.779, "update_time_ms": 33.263, "learner": {"policy_0": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02740606479346752, "policy_loss": 0.026713473722338676, "vf_loss": 8.975756645202637, "vf_explained_var": -0.008485574275255203, "kl": 0.018229879438877106, "entropy": 0.7729442119598389, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 228000, "episodes_total": 5463, "training_iteration": 57, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-11-57", "timestamp": 1581502317, "time_this_iter_s": 29.29692506790161, "time_total_s": 1830.9948692321777, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1830.9948692321777, "timesteps_since_restore": 228000, "iterations_since_restore": 57, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.218518518518504, "episode_len_mean": 38.44444444444444, "episodes_this_iter": 108, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.384795321637423}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.693874066859804, "mean_processing_ms": 5.747824432584139, "mean_inference_ms": 1.014053260282425}, "off_policy_estimator": {}, "info": {"num_steps_trained": 607744, "num_steps_sampled": 232000, "sample_time_ms": 7163.369, "load_time_ms": 14.742, "grad_time_ms": 23799.156, "update_time_ms": 33.209, "learner": {"policy_0": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04278424754738808, "policy_loss": -0.043141625821590424, "vf_loss": 7.988709449768066, "vf_explained_var": 0.04249890521168709, "kl": 0.009316889569163322, "entropy": 0.7450974583625793, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 232000, "episodes_total": 5571, "training_iteration": 58, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-12-28", "timestamp": 1581502348, "time_this_iter_s": 30.996949434280396, "time_total_s": 1861.9918186664581, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1861.9918186664581, "timesteps_since_restore": 232000, "iterations_since_restore": 58, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.57009345794391, "episode_len_mean": 36.61682242990654, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.931343283582086}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6928232764883315, "mean_processing_ms": 5.757828367131164, "mean_inference_ms": 1.0139214255199052}, "off_policy_estimator": {}, "info": {"num_steps_trained": 617984, "num_steps_sampled": 236000, "sample_time_ms": 7169.408, "load_time_ms": 15.268, "grad_time_ms": 23782.102, "update_time_ms": 33.079, "learner": {"policy_0": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.007766932249069214, "policy_loss": -0.007929499261081219, "vf_loss": 7.300224304199219, "vf_explained_var": 0.12001971900463104, "kl": 0.004140625707805157, "entropy": 0.732809841632843, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 236000, "episodes_total": 5678, "training_iteration": 59, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-12-58", "timestamp": 1581502378, "time_this_iter_s": 30.155356645584106, "time_total_s": 1892.1471753120422, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7cea60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1892.1471753120422, "timesteps_since_restore": 236000, "iterations_since_restore": 59, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.52105263157893, "episode_len_mean": 35.71052631578947, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.789565217391301}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6993817112769305, "mean_processing_ms": 5.76544821921946, "mean_inference_ms": 1.013901533784738}, "off_policy_estimator": {}, "info": {"num_steps_trained": 628096, "num_steps_sampled": 240000, "sample_time_ms": 7187.025, "load_time_ms": 14.087, "grad_time_ms": 23616.443, "update_time_ms": 33.426, "learner": {"policy_0": {"cur_kl_coeff": 0.01875000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 0.003825272899121046, "policy_loss": 0.0036136514972895384, "vf_loss": 7.195443153381348, "vf_explained_var": 0.1346682608127594, "kl": 0.010902718640863895, "entropy": 0.7286030054092407, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 240000, "episodes_total": 5792, "training_iteration": 60, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-13-28", "timestamp": 1581502408, "time_this_iter_s": 29.890970706939697, "time_total_s": 1922.038146018982, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ced90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1922.038146018982, "timesteps_since_restore": 240000, "iterations_since_restore": 60, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.2690909090909, "episode_len_mean": 35.518181818181816, "episodes_this_iter": 110, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.910588235294114}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.701335996919812, "mean_processing_ms": 5.7803583965808745, "mean_inference_ms": 1.0134253628571792}, "off_policy_estimator": {}, "info": {"num_steps_trained": 638720, "num_steps_sampled": 244000, "sample_time_ms": 7198.582, "load_time_ms": 13.894, "grad_time_ms": 23544.022, "update_time_ms": 33.613, "learner": {"policy_0": {"cur_kl_coeff": 0.01875000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03855116292834282, "policy_loss": -0.038668472319841385, "vf_loss": 7.27595853805542, "vf_explained_var": 0.13182374835014343, "kl": 0.005868901498615742, "entropy": 0.6586284637451172, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 244000, "episodes_total": 5902, "training_iteration": 61, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-13-59", "timestamp": 1581502439, "time_this_iter_s": 30.526474714279175, "time_total_s": 1952.564620733261, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7daae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1952.564620733261, "timesteps_since_restore": 244000, "iterations_since_restore": 61, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.08095238095237, "episode_len_mean": 31.738095238095237, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.332105263157892}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.687354033670978, "mean_processing_ms": 5.799536122604912, "mean_inference_ms": 1.0132983924052172}, "off_policy_estimator": {}, "info": {"num_steps_trained": 649088, "num_steps_sampled": 248000, "sample_time_ms": 7252.664, "load_time_ms": 14.26, "grad_time_ms": 23316.515, "update_time_ms": 33.418, "learner": {"policy_0": {"cur_kl_coeff": 0.01875000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": -0.014295770786702633, "policy_loss": -0.014373738318681717, "vf_loss": 6.785926342010498, "vf_explained_var": 0.16857914626598358, "kl": 0.00379606313072145, "entropy": 0.7130740880966187, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 248000, "episodes_total": 6028, "training_iteration": 62, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-14-29", "timestamp": 1581502469, "time_this_iter_s": 30.31947898864746, "time_total_s": 1982.8840997219086, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7dae18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1982.8840997219086, "timesteps_since_restore": 248000, "iterations_since_restore": 62, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.702608695652167, "episode_len_mean": 35.18260869565217, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.092917847025491}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.696031067258901, "mean_processing_ms": 5.810066675665103, "mean_inference_ms": 1.0126029814608264}, "off_policy_estimator": {}, "info": {"num_steps_trained": 659968, "num_steps_sampled": 252000, "sample_time_ms": 7259.521, "load_time_ms": 13.687, "grad_time_ms": 23334.318, "update_time_ms": 33.512, "learner": {"policy_0": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 9.999999747378752e-05, "total_loss": -0.012692688032984734, "policy_loss": -0.012861601077020168, "vf_loss": 7.313960552215576, "vf_explained_var": 0.12848997116088867, "kl": 0.017237048596143723, "entropy": 0.6654142737388611, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 252000, "episodes_total": 6143, "training_iteration": 63, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-15-01", "timestamp": 1581502501, "time_this_iter_s": 31.4041531085968, "time_total_s": 2014.2882528305054, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da7b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2014.2882528305054, "timesteps_since_restore": 252000, "iterations_since_restore": 63, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.317355371900824, "episode_len_mean": 33.12396694214876, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.694021739130432}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.684227598994103, "mean_processing_ms": 5.833546997218974, "mean_inference_ms": 1.0119962453904519}, "off_policy_estimator": {}, "info": {"num_steps_trained": 670720, "num_steps_sampled": 256000, "sample_time_ms": 7293.062, "load_time_ms": 13.66, "grad_time_ms": 23364.858, "update_time_ms": 33.003, "learner": {"policy_0": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 9.999999747378752e-05, "total_loss": 0.009187193587422371, "policy_loss": 0.008981878869235516, "vf_loss": 7.106588363647461, "vf_explained_var": 0.14930744469165802, "kl": 0.02114206738770008, "entropy": 0.6584647297859192, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 256000, "episodes_total": 6264, "training_iteration": 64, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-15-32", "timestamp": 1581502532, "time_this_iter_s": 31.158627033233643, "time_total_s": 2045.446879863739, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce6a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2045.446879863739, "timesteps_since_restore": 256000, "iterations_since_restore": 64, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.37407407407406, "episode_len_mean": 37.0462962962963, "episodes_this_iter": 108, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.087116564417174}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.683943152990198, "mean_processing_ms": 5.834658218166317, "mean_inference_ms": 1.0122436943324364}, "off_policy_estimator": {}, "info": {"num_steps_trained": 680832, "num_steps_sampled": 260000, "sample_time_ms": 7298.79, "load_time_ms": 14.175, "grad_time_ms": 23131.212, "update_time_ms": 33.12, "learner": {"policy_0": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 9.999999747378752e-05, "total_loss": -0.015231645666062832, "policy_loss": -0.015293091535568237, "vf_loss": 7.531378269195557, "vf_explained_var": 0.11346396058797836, "kl": 0.0038342068437486887, "entropy": 0.6991311311721802, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 260000, "episodes_total": 6372, "training_iteration": 65, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-16-02", "timestamp": 1581502562, "time_this_iter_s": 29.545382022857666, "time_total_s": 2074.9922618865967, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2074.9922618865967, "timesteps_since_restore": 260000, "iterations_since_restore": 65, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -21.227999999999987, "episode_len_mean": 39.61, "episodes_this_iter": 99, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.760509554140122}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.676234724178997, "mean_processing_ms": 5.8280031508427275, "mean_inference_ms": 1.011592875919983}, "off_policy_estimator": {}, "info": {"num_steps_trained": 691840, "num_steps_sampled": 264000, "sample_time_ms": 7167.969, "load_time_ms": 13.647, "grad_time_ms": 23132.251, "update_time_ms": 32.986, "learner": {"policy_0": {"cur_kl_coeff": 0.007031249813735485, "cur_lr": 9.999999747378752e-05, "total_loss": 0.032062869518995285, "policy_loss": 0.03195999190211296, "vf_loss": 7.909139156341553, "vf_explained_var": 0.09725254774093628, "kl": 0.013506866060197353, "entropy": 0.7360318899154663, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 264000, "episodes_total": 6471, "training_iteration": 66, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-16-32", "timestamp": 1581502592, "time_this_iter_s": 30.34263515472412, "time_total_s": 2105.334897041321, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2105.334897041321, "timesteps_since_restore": 264000, "iterations_since_restore": 66, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.519298245614024, "episode_len_mean": 35.75438596491228, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.302089552238801}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.668501828726173, "mean_processing_ms": 5.835299482954164, "mean_inference_ms": 1.0109241047701374}, "off_policy_estimator": {}, "info": {"num_steps_trained": 702208, "num_steps_sampled": 268000, "sample_time_ms": 7217.049, "load_time_ms": 13.524, "grad_time_ms": 23134.619, "update_time_ms": 33.106, "learner": {"policy_0": {"cur_kl_coeff": 0.007031249813735485, "cur_lr": 9.999999747378752e-05, "total_loss": -0.030775992199778557, "policy_loss": -0.030945591628551483, "vf_loss": 7.464855670928955, "vf_explained_var": 0.12397627532482147, "kl": 0.02305883914232254, "entropy": 0.7178667187690735, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 268000, "episodes_total": 6585, "training_iteration": 67, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-17-02", "timestamp": 1581502622, "time_this_iter_s": 29.81162452697754, "time_total_s": 2135.1465215682983, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7dabf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2135.1465215682983, "timesteps_since_restore": 268000, "iterations_since_restore": 67, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.66548672566371, "episode_len_mean": 35.23893805309734, "episodes_this_iter": 113, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.2773809523809465}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.675168491148344, "mean_processing_ms": 5.847242516938823, "mean_inference_ms": 1.0102501693194093}, "off_policy_estimator": {}, "info": {"num_steps_trained": 712960, "num_steps_sampled": 272000, "sample_time_ms": 7211.154, "load_time_ms": 14.262, "grad_time_ms": 23147.571, "update_time_ms": 33.363, "learner": {"policy_0": {"cur_kl_coeff": 0.010546875186264515, "cur_lr": 9.999999747378752e-05, "total_loss": 0.004050613380968571, "policy_loss": 0.004006735049188137, "vf_loss": 7.205667495727539, "vf_explained_var": 0.1349175125360489, "kl": 0.0034768362529575825, "entropy": 0.7164962291717529, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 272000, "episodes_total": 6698, "training_iteration": 68, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-17-34", "timestamp": 1581502654, "time_this_iter_s": 31.078388452529907, "time_total_s": 2166.2249100208282, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bda60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2166.2249100208282, "timesteps_since_restore": 272000, "iterations_since_restore": 68, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.73153153153152, "episode_len_mean": 35.909909909909906, "episodes_this_iter": 111, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.228481012658223}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.651252144106745, "mean_processing_ms": 5.845164057511793, "mean_inference_ms": 1.0100953407881952}, "off_policy_estimator": {}, "info": {"num_steps_trained": 723072, "num_steps_sampled": 276000, "sample_time_ms": 7174.062, "load_time_ms": 13.975, "grad_time_ms": 23129.814, "update_time_ms": 33.351, "learner": {"policy_0": {"cur_kl_coeff": 0.0052734375931322575, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013108051382005215, "policy_loss": 0.013069855980575085, "vf_loss": 7.59948205947876, "vf_explained_var": 0.12358278036117554, "kl": 0.005803019739687443, "entropy": 0.744170606136322, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 276000, "episodes_total": 6809, "training_iteration": 69, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-18-03", "timestamp": 1581502683, "time_this_iter_s": 29.603063821792603, "time_total_s": 2195.827973842621, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7dad08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2195.827973842621, "timesteps_since_restore": 276000, "iterations_since_restore": 69, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.209523809523798, "episode_len_mean": 38.819047619047616, "episodes_this_iter": 105, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.779552715654947}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.658394313945201, "mean_processing_ms": 5.856050537765566, "mean_inference_ms": 1.010197603587112}, "off_policy_estimator": {}, "info": {"num_steps_trained": 733696, "num_steps_sampled": 280000, "sample_time_ms": 7154.276, "load_time_ms": 13.804, "grad_time_ms": 23218.219, "update_time_ms": 33.671, "learner": {"policy_0": {"cur_kl_coeff": 0.0052734375931322575, "cur_lr": 9.999999747378752e-05, "total_loss": -0.06513575464487076, "policy_loss": -0.06518267095088959, "vf_loss": 7.875473499298096, "vf_explained_var": 0.10130886733531952, "kl": 0.007401322014629841, "entropy": 0.7126591801643372, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 280000, "episodes_total": 6914, "training_iteration": 70, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-18-34", "timestamp": 1581502714, "time_this_iter_s": 30.578107595443726, "time_total_s": 2226.4060814380646, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2226.4060814380646, "timesteps_since_restore": 280000, "iterations_since_restore": 70, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.689719626168213, "episode_len_mean": 36.429906542056074, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.4302250803858465}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.65261412977848, "mean_processing_ms": 5.872201970163879, "mean_inference_ms": 1.0093889390715103}, "off_policy_estimator": {}, "info": {"num_steps_trained": 744064, "num_steps_sampled": 284000, "sample_time_ms": 7110.764, "load_time_ms": 14.439, "grad_time_ms": 23158.34, "update_time_ms": 33.665, "learner": {"policy_0": {"cur_kl_coeff": 0.0052734375931322575, "cur_lr": 9.999999747378752e-05, "total_loss": -0.005784780252724886, "policy_loss": -0.005832455586642027, "vf_loss": 7.703636646270752, "vf_explained_var": 0.12302631884813309, "kl": 0.007578931283205748, "entropy": 0.7728989124298096, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 284000, "episodes_total": 7021, "training_iteration": 71, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-19-04", "timestamp": 1581502744, "time_this_iter_s": 29.497403383255005, "time_total_s": 2255.9034848213196, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2255.9034848213196, "timesteps_since_restore": 284000, "iterations_since_restore": 71, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.663366336633647, "episode_len_mean": 40.7029702970297, "episodes_this_iter": 101, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -7.026936026936022}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.649840316094441, "mean_processing_ms": 5.858534301889856, "mean_inference_ms": 1.0094546622641019}, "off_policy_estimator": {}, "info": {"num_steps_trained": 754432, "num_steps_sampled": 288000, "sample_time_ms": 7045.791, "load_time_ms": 14.086, "grad_time_ms": 23170.924, "update_time_ms": 33.673, "learner": {"policy_0": {"cur_kl_coeff": 0.0052734375931322575, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0014835820766165853, "policy_loss": 0.0014519544783979654, "vf_loss": 7.788111686706543, "vf_explained_var": 0.09886698424816132, "kl": 0.004522038623690605, "entropy": 0.6994117498397827, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 288000, "episodes_total": 7122, "training_iteration": 72, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-19-34", "timestamp": 1581502774, "time_this_iter_s": 29.79182267189026, "time_total_s": 2285.69530749321, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2285.69530749321, "timesteps_since_restore": 288000, "iterations_since_restore": 72, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.29333333333331, "episode_len_mean": 38.17142857142857, "episodes_this_iter": 105, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.4107594936708825}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.639630625750963, "mean_processing_ms": 5.8634365954617165, "mean_inference_ms": 1.0078367285674115}, "off_policy_estimator": {}, "info": {"num_steps_trained": 764672, "num_steps_sampled": 292000, "sample_time_ms": 6986.014, "load_time_ms": 14.032, "grad_time_ms": 23026.137, "update_time_ms": 33.569, "learner": {"policy_0": {"cur_kl_coeff": 0.0026367187965661287, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013002032414078712, "policy_loss": 0.012970512732863426, "vf_loss": 7.451590538024902, "vf_explained_var": 0.12472961843013763, "kl": 0.009125685319304466, "entropy": 0.6239809989929199, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 292000, "episodes_total": 7227, "training_iteration": 73, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-20-03", "timestamp": 1581502803, "time_this_iter_s": 29.356747150421143, "time_total_s": 2315.052054643631, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da8c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2315.052054643631, "timesteps_since_restore": 292000, "iterations_since_restore": 73, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.193220338983043, "episode_len_mean": 33.228813559322035, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.020178041543023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.646632552276607, "mean_processing_ms": 5.886920507883404, "mean_inference_ms": 1.0087451546860922}, "off_policy_estimator": {}, "info": {"num_steps_trained": 775296, "num_steps_sampled": 296000, "sample_time_ms": 6998.621, "load_time_ms": 14.789, "grad_time_ms": 22988.525, "update_time_ms": 33.781, "learner": {"policy_0": {"cur_kl_coeff": 0.0026367187965661287, "cur_lr": 9.999999747378752e-05, "total_loss": -0.018669068813323975, "policy_loss": -0.018701396882534027, "vf_loss": 7.452022552490234, "vf_explained_var": 0.13237589597702026, "kl": 0.009434225037693977, "entropy": 0.7321689128875732, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 296000, "episodes_total": 7345, "training_iteration": 74, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-20-34", "timestamp": 1581502834, "time_this_iter_s": 30.914137840270996, "time_total_s": 2345.966192483902, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7daa60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2345.966192483902, "timesteps_since_restore": 296000, "iterations_since_restore": 74, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.681999999999984, "episode_len_mean": 41.04, "episodes_this_iter": 100, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.893999999999993}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.633922580718463, "mean_processing_ms": 5.875568106088842, "mean_inference_ms": 1.008205344492722}, "off_policy_estimator": {}, "info": {"num_steps_trained": 785536, "num_steps_sampled": 300000, "sample_time_ms": 6941.43, "load_time_ms": 14.224, "grad_time_ms": 23029.121, "update_time_ms": 33.91, "learner": {"policy_0": {"cur_kl_coeff": 0.0026367187965661287, "cur_lr": 9.999999747378752e-05, "total_loss": 0.008518597111105919, "policy_loss": 0.008455685339868069, "vf_loss": 7.330223083496094, "vf_explained_var": 0.10235331952571869, "kl": 0.021079551428556442, "entropy": 0.646109402179718, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 300000, "episodes_total": 7445, "training_iteration": 75, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-21-04", "timestamp": 1581502864, "time_this_iter_s": 29.375421047210693, "time_total_s": 2375.3416135311127, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ced08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2375.3416135311127, "timesteps_since_restore": 300000, "iterations_since_restore": 75, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.563333333333322, "episode_len_mean": 33.016666666666666, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.678857142857139}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6283150237590345, "mean_processing_ms": 5.8879184760544225, "mean_inference_ms": 1.0072964075759254}, "off_policy_estimator": {}, "info": {"num_steps_trained": 795904, "num_steps_sampled": 304000, "sample_time_ms": 7012.251, "load_time_ms": 14.035, "grad_time_ms": 22876.771, "update_time_ms": 33.793, "learner": {"policy_0": {"cur_kl_coeff": 0.003955078311264515, "cur_lr": 9.999999747378752e-05, "total_loss": 0.029212236404418945, "policy_loss": 0.02914808690547943, "vf_loss": 7.46612024307251, "vf_explained_var": 0.13901667296886444, "kl": 0.014331052079796791, "entropy": 0.6858068108558655, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 304000, "episodes_total": 7565, "training_iteration": 76, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-21-33", "timestamp": 1581502893, "time_this_iter_s": 29.525811195373535, "time_total_s": 2404.867424726486, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3452646a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2404.867424726486, "timesteps_since_restore": 304000, "iterations_since_restore": 76, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.255555555555535, "episode_len_mean": 35.71296296296296, "episodes_this_iter": 108, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.80560747663551}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.634272794331385, "mean_processing_ms": 5.8872029661727465, "mean_inference_ms": 1.007031192227537}, "off_policy_estimator": {}, "info": {"num_steps_trained": 805632, "num_steps_sampled": 308000, "sample_time_ms": 6973.89, "load_time_ms": 14.015, "grad_time_ms": 22739.587, "update_time_ms": 33.786, "learner": {"policy_0": {"cur_kl_coeff": 0.003955078311264515, "cur_lr": 9.999999747378752e-05, "total_loss": -0.010973627679049969, "policy_loss": -0.011055104434490204, "vf_loss": 7.403257846832275, "vf_explained_var": 0.1545153558254242, "kl": 0.0187285877764225, "entropy": 0.6384885907173157, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 308000, "episodes_total": 7673, "training_iteration": 77, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-22-01", "timestamp": 1581502921, "time_this_iter_s": 28.056344747543335, "time_total_s": 2432.9237694740295, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2432.9237694740295, "timesteps_since_restore": 308000, "iterations_since_restore": 77, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.998198198198175, "episode_len_mean": 37.85585585585586, "episodes_this_iter": 111, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.48861538461538}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.637344041727114, "mean_processing_ms": 5.893782574141598, "mean_inference_ms": 1.0064576921995831}, "off_policy_estimator": {}, "info": {"num_steps_trained": 815872, "num_steps_sampled": 312000, "sample_time_ms": 6921.291, "load_time_ms": 13.861, "grad_time_ms": 22620.976, "update_time_ms": 33.382, "learner": {"policy_0": {"cur_kl_coeff": 0.003955078311264515, "cur_lr": 9.999999747378752e-05, "total_loss": 0.005643873009830713, "policy_loss": 0.0055974856950342655, "vf_loss": 7.231283664703369, "vf_explained_var": 0.14263345301151276, "kl": 0.009898553602397442, "entropy": 0.6614516377449036, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 312000, "episodes_total": 7784, "training_iteration": 78, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-22-31", "timestamp": 1581502951, "time_this_iter_s": 29.359936714172363, "time_total_s": 2462.283706188202, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2462.283706188202, "timesteps_since_restore": 312000, "iterations_since_restore": 78, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.10937499999999, "episode_len_mean": 31.15625, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.255434782608694}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.629650362089045, "mean_processing_ms": 5.911829826706665, "mean_inference_ms": 1.0073342308070148}, "off_policy_estimator": {}, "info": {"num_steps_trained": 825856, "num_steps_sampled": 316000, "sample_time_ms": 7043.269, "load_time_ms": 13.606, "grad_time_ms": 22546.719, "update_time_ms": 33.767, "learner": {"policy_0": {"cur_kl_coeff": 0.003955078311264515, "cur_lr": 9.999999747378752e-05, "total_loss": 0.008188686333596706, "policy_loss": 0.008122281171381474, "vf_loss": 6.816584587097168, "vf_explained_var": 0.2049710899591446, "kl": 0.01506603229790926, "entropy": 0.6779742240905762, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 316000, "episodes_total": 7912, "training_iteration": 79, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-23-01", "timestamp": 1581502981, "time_this_iter_s": 30.08057713508606, "time_total_s": 2492.364283323288, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3452649d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2492.364283323288, "timesteps_since_restore": 316000, "iterations_since_restore": 79, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.998347107438002, "episode_len_mean": 32.19834710743802, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.627325581395345}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.630961071983472, "mean_processing_ms": 5.923965049030303, "mean_inference_ms": 1.0068381037288252}, "off_policy_estimator": {}, "info": {"num_steps_trained": 836096, "num_steps_sampled": 320000, "sample_time_ms": 7058.833, "load_time_ms": 13.851, "grad_time_ms": 22472.408, "update_time_ms": 33.009, "learner": {"policy_0": {"cur_kl_coeff": 0.003955078311264515, "cur_lr": 9.999999747378752e-05, "total_loss": -0.025314930826425552, "policy_loss": -0.02536989375948906, "vf_loss": 8.018173217773438, "vf_explained_var": 0.16657085716724396, "kl": 0.011868567205965519, "entropy": 0.6792956590652466, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 320000, "episodes_total": 8033, "training_iteration": 80, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-23-31", "timestamp": 1581503011, "time_this_iter_s": 29.98862648010254, "time_total_s": 2522.3529098033905, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2522.3529098033905, "timesteps_since_restore": 320000, "iterations_since_restore": 80, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.00186915887849, "episode_len_mean": 37.74766355140187, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.353749999999996}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.633269697091695, "mean_processing_ms": 5.935864679005715, "mean_inference_ms": 1.0065573358611652}, "off_policy_estimator": {}, "info": {"num_steps_trained": 846464, "num_steps_sampled": 324000, "sample_time_ms": 7083.941, "load_time_ms": 13.113, "grad_time_ms": 22474.621, "update_time_ms": 33.025, "learner": {"policy_0": {"cur_kl_coeff": 0.003955078311264515, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01919722557067871, "policy_loss": -0.019228827208280563, "vf_loss": 7.398014545440674, "vf_explained_var": 0.12298533320426941, "kl": 0.006119236350059509, "entropy": 0.6519735455513, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 324000, "episodes_total": 8140, "training_iteration": 81, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-24-01", "timestamp": 1581503041, "time_this_iter_s": 29.763644456863403, "time_total_s": 2552.116554260254, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2552.116554260254, "timesteps_since_restore": 324000, "iterations_since_restore": 81, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.861666666666657, "episode_len_mean": 33.125, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.620555555555553}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6292211084542, "mean_processing_ms": 5.9484807505358095, "mean_inference_ms": 1.0065566667937025}, "off_policy_estimator": {}, "info": {"num_steps_trained": 856832, "num_steps_sampled": 328000, "sample_time_ms": 7139.358, "load_time_ms": 13.485, "grad_time_ms": 22467.865, "update_time_ms": 33.16, "learner": {"policy_0": {"cur_kl_coeff": 0.003955078311264515, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02659214287996292, "policy_loss": -0.02661466971039772, "vf_loss": 6.684404373168945, "vf_explained_var": 0.15008306503295898, "kl": 0.004006572533398867, "entropy": 0.6319021582603455, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 328000, "episodes_total": 8260, "training_iteration": 82, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-24-32", "timestamp": 1581503072, "time_this_iter_s": 30.284128189086914, "time_total_s": 2582.400682449341, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2582.400682449341, "timesteps_since_restore": 328000, "iterations_since_restore": 82, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.869999999999987, "episode_len_mean": 33.666666666666664, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.902040816326527}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.626552645271086, "mean_processing_ms": 5.947179231626759, "mean_inference_ms": 1.006001706645841}, "off_policy_estimator": {}, "info": {"num_steps_trained": 867072, "num_steps_sampled": 332000, "sample_time_ms": 7121.266, "load_time_ms": 13.737, "grad_time_ms": 22470.51, "update_time_ms": 33.196, "learner": {"policy_0": {"cur_kl_coeff": 0.0019775391556322575, "cur_lr": 9.999999747378752e-05, "total_loss": -0.022593894973397255, "policy_loss": -0.022615360096096992, "vf_loss": 6.850171089172363, "vf_explained_var": 0.17797204852104187, "kl": 0.007390071637928486, "entropy": 0.6744130253791809, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 332000, "episodes_total": 8380, "training_iteration": 83, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-25-01", "timestamp": 1581503101, "time_this_iter_s": 29.206193685531616, "time_total_s": 2611.6068761348724, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2611.6068761348724, "timesteps_since_restore": 332000, "iterations_since_restore": 83, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.666055045871552, "episode_len_mean": 36.68807339449541, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.542122186495173}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.629868333139342, "mean_processing_ms": 5.948621084314549, "mean_inference_ms": 1.0067066689600557}, "off_policy_estimator": {}, "info": {"num_steps_trained": 877440, "num_steps_sampled": 336000, "sample_time_ms": 7096.895, "load_time_ms": 12.958, "grad_time_ms": 22419.156, "update_time_ms": 33.248, "learner": {"policy_0": {"cur_kl_coeff": 0.0019775391556322575, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01813337951898575, "policy_loss": -0.018172115087509155, "vf_loss": 7.166874408721924, "vf_explained_var": 0.10018908232450485, "kl": 0.015962883830070496, "entropy": 0.6293594837188721, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 336000, "episodes_total": 8489, "training_iteration": 84, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-25-31", "timestamp": 1581503131, "time_this_iter_s": 30.149857997894287, "time_total_s": 2641.7567341327667, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2641.7567341327667, "timesteps_since_restore": 336000, "iterations_since_restore": 84, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.196226415094323, "episode_len_mean": 37.10377358490566, "episodes_this_iter": 106, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.459682539682534}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.63070361822201, "mean_processing_ms": 5.957569936808613, "mean_inference_ms": 1.0049931848698779}, "off_policy_estimator": {}, "info": {"num_steps_trained": 887936, "num_steps_sampled": 340000, "sample_time_ms": 7129.944, "load_time_ms": 12.846, "grad_time_ms": 22449.833, "update_time_ms": 32.992, "learner": {"policy_0": {"cur_kl_coeff": 0.0019775391556322575, "cur_lr": 9.999999747378752e-05, "total_loss": 0.018766535446047783, "policy_loss": 0.01873818226158619, "vf_loss": 7.363522529602051, "vf_explained_var": 0.09941918402910233, "kl": 0.010614393278956413, "entropy": 0.6434998512268066, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 340000, "episodes_total": 8595, "training_iteration": 85, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-26-01", "timestamp": 1581503161, "time_this_iter_s": 30.010729551315308, "time_total_s": 2671.767463684082, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fcae18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2671.767463684082, "timesteps_since_restore": 340000, "iterations_since_restore": 85, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.596116504854358, "episode_len_mean": 39.592233009708735, "episodes_this_iter": 103, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.9326797385620855}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6197868886159705, "mean_processing_ms": 5.948956094786805, "mean_inference_ms": 1.0063554848749716}, "off_policy_estimator": {}, "info": {"num_steps_trained": 898560, "num_steps_sampled": 344000, "sample_time_ms": 7126.726, "load_time_ms": 13.603, "grad_time_ms": 22503.4, "update_time_ms": 33.678, "learner": {"policy_0": {"cur_kl_coeff": 0.0019775391556322575, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014197125099599361, "policy_loss": 0.01416597981005907, "vf_loss": 7.868326663970947, "vf_explained_var": 0.04757960885763168, "kl": 0.01177264004945755, "entropy": 0.5305320620536804, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 344000, "episodes_total": 8698, "training_iteration": 86, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-26-32", "timestamp": 1581503192, "time_this_iter_s": 30.043092966079712, "time_total_s": 2701.8105566501617, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2701.8105566501617, "timesteps_since_restore": 344000, "iterations_since_restore": 86, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.37543859649122, "episode_len_mean": 34.85964912280702, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.216023738872399}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6209967963262475, "mean_processing_ms": 5.960753834740896, "mean_inference_ms": 1.005590490900549}, "off_policy_estimator": {}, "info": {"num_steps_trained": 909312, "num_steps_sampled": 348000, "sample_time_ms": 7189.228, "load_time_ms": 13.861, "grad_time_ms": 22723.616, "update_time_ms": 33.694, "learner": {"policy_0": {"cur_kl_coeff": 0.0019775391556322575, "cur_lr": 9.999999747378752e-05, "total_loss": 4.281352084944956e-05, "policy_loss": 1.730911753838882e-05, "vf_loss": 8.419489860534668, "vf_explained_var": 0.04049385339021683, "kl": 0.00864192470908165, "entropy": 0.5267712473869324, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 348000, "episodes_total": 8812, "training_iteration": 87, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-27-03", "timestamp": 1581503223, "time_this_iter_s": 30.88507103919983, "time_total_s": 2732.6956276893616, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264ae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2732.6956276893616, "timesteps_since_restore": 348000, "iterations_since_restore": 87, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.829357798165123, "episode_len_mean": 36.72477064220183, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.4338557993730365}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.617610051947285, "mean_processing_ms": 5.964346795836671, "mean_inference_ms": 1.004823167942425}, "off_policy_estimator": {}, "info": {"num_steps_trained": 919808, "num_steps_sampled": 352000, "sample_time_ms": 7224.982, "load_time_ms": 13.237, "grad_time_ms": 22786.165, "update_time_ms": 33.516, "learner": {"policy_0": {"cur_kl_coeff": 0.0019775391556322575, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014941634610295296, "policy_loss": 0.014919363893568516, "vf_loss": 7.7562575340271, "vf_explained_var": 0.049503494054079056, "kl": 0.007339067757129669, "entropy": 0.4837125539779663, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 352000, "episodes_total": 8921, "training_iteration": 88, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-27-33", "timestamp": 1581503253, "time_this_iter_s": 30.334354400634766, "time_total_s": 2763.0299820899963, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3452647b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2763.0299820899963, "timesteps_since_restore": 352000, "iterations_since_restore": 88, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.48376068376068, "episode_len_mean": 34.44444444444444, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.161253561253557}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.619828368630822, "mean_processing_ms": 5.985804005538119, "mean_inference_ms": 1.0056620443619622}, "off_policy_estimator": {}, "info": {"num_steps_trained": 930688, "num_steps_sampled": 356000, "sample_time_ms": 7208.062, "load_time_ms": 13.764, "grad_time_ms": 22996.131, "update_time_ms": 33.4, "learner": {"policy_0": {"cur_kl_coeff": 0.0019775391556322575, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04163656756281853, "policy_loss": 0.04161520302295685, "vf_loss": 8.317962646484375, "vf_explained_var": 0.05288691073656082, "kl": 0.00660053500905633, "entropy": 0.4585445523262024, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 356000, "episodes_total": 9038, "training_iteration": 89, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-28-05", "timestamp": 1581503285, "time_this_iter_s": 32.01503276824951, "time_total_s": 2795.045014858246, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fcac80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2795.045014858246, "timesteps_since_restore": 356000, "iterations_since_restore": 89, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.91262135922329, "episode_len_mean": 39.33009708737864, "episodes_this_iter": 103, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.903846153846148}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.615806383522803, "mean_processing_ms": 5.975501549680372, "mean_inference_ms": 1.005923732018351}, "off_policy_estimator": {}, "info": {"num_steps_trained": 941568, "num_steps_sampled": 360000, "sample_time_ms": 7180.913, "load_time_ms": 14.052, "grad_time_ms": 23142.364, "update_time_ms": 33.344, "learner": {"policy_0": {"cur_kl_coeff": 0.0019775391556322575, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01328996941447258, "policy_loss": -0.013310737907886505, "vf_loss": 7.90375280380249, "vf_explained_var": -0.05608650669455528, "kl": 0.006506488658487797, "entropy": 0.41847822070121765, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 360000, "episodes_total": 9141, "training_iteration": 90, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-28-37", "timestamp": 1581503317, "time_this_iter_s": 31.18000078201294, "time_total_s": 2826.225015640259, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264d90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2826.225015640259, "timesteps_since_restore": 360000, "iterations_since_restore": 90, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.14957983193277, "episode_len_mean": 32.714285714285715, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.847564469914036}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6202397552388925, "mean_processing_ms": 5.975478936780416, "mean_inference_ms": 1.0056281769667073}, "off_policy_estimator": {}, "info": {"num_steps_trained": 952192, "num_steps_sampled": 364000, "sample_time_ms": 7226.938, "load_time_ms": 14.132, "grad_time_ms": 23184.059, "update_time_ms": 33.12, "learner": {"policy_0": {"cur_kl_coeff": 0.0019775391556322575, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03569568693637848, "policy_loss": 0.03567931056022644, "vf_loss": 8.004709243774414, "vf_explained_var": 0.027708783745765686, "kl": 0.004232274368405342, "entropy": 0.43403199315071106, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 364000, "episodes_total": 9260, "training_iteration": 91, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-29-08", "timestamp": 1581503348, "time_this_iter_s": 30.640531539916992, "time_total_s": 2856.865547180176, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da9d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2856.865547180176, "timesteps_since_restore": 364000, "iterations_since_restore": 91, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.011320754716966, "episode_len_mean": 37.66981132075472, "episodes_this_iter": 106, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.20061538461538}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6237173763295925, "mean_processing_ms": 5.997581678914828, "mean_inference_ms": 1.0043115403806255}, "off_policy_estimator": {}, "info": {"num_steps_trained": 962560, "num_steps_sampled": 368000, "sample_time_ms": 7201.146, "load_time_ms": 14.099, "grad_time_ms": 23173.221, "update_time_ms": 33.037, "learner": {"policy_0": {"cur_kl_coeff": 0.0009887695778161287, "cur_lr": 9.999999747378752e-05, "total_loss": 0.031554970890283585, "policy_loss": 0.03154202178120613, "vf_loss": 7.834536552429199, "vf_explained_var": 0.05991681292653084, "kl": 0.005166969727724791, "entropy": 0.44338682293891907, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 368000, "episodes_total": 9366, "training_iteration": 92, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-29-38", "timestamp": 1581503378, "time_this_iter_s": 29.916633129119873, "time_total_s": 2886.7821803092957, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2886.7821803092957, "timesteps_since_restore": 368000, "iterations_since_restore": 92, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.3748031496063, "episode_len_mean": 31.716535433070867, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.806842105263154}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.619683120987184, "mean_processing_ms": 6.00312870986605, "mean_inference_ms": 1.0050172870859246}, "off_policy_estimator": {}, "info": {"num_steps_trained": 973696, "num_steps_sampled": 372000, "sample_time_ms": 7330.815, "load_time_ms": 13.936, "grad_time_ms": 23363.365, "update_time_ms": 33.033, "learner": {"policy_0": {"cur_kl_coeff": 0.0009887695778161287, "cur_lr": 9.999999747378752e-05, "total_loss": 0.009271929040551186, "policy_loss": 0.009261958301067352, "vf_loss": 7.692511081695557, "vf_explained_var": 0.05671345070004463, "kl": 0.0023078261874616146, "entropy": 0.4094645082950592, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 372000, "episodes_total": 9493, "training_iteration": 93, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-30-10", "timestamp": 1581503410, "time_this_iter_s": 32.40060234069824, "time_total_s": 2919.182782649994, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2919.182782649994, "timesteps_since_restore": 372000, "iterations_since_restore": 93, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.27962962962963, "episode_len_mean": 36.898148148148145, "episodes_this_iter": 108, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.537910447761188}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.61750733240092, "mean_processing_ms": 5.994568741906035, "mean_inference_ms": 1.0041632349519882}, "off_policy_estimator": {}, "info": {"num_steps_trained": 984832, "num_steps_sampled": 376000, "sample_time_ms": 7289.193, "load_time_ms": 14.068, "grad_time_ms": 23540.74, "update_time_ms": 32.802, "learner": {"policy_0": {"cur_kl_coeff": 0.0004943847889080644, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03070806711912155, "policy_loss": -0.030717570334672928, "vf_loss": 7.732757091522217, "vf_explained_var": 0.044308584183454514, "kl": 0.003587071318179369, "entropy": 0.3651561439037323, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 376000, "episodes_total": 9601, "training_iteration": 94, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-30-42", "timestamp": 1581503442, "time_this_iter_s": 31.506402254104614, "time_total_s": 2950.6891849040985, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2950.6891849040985, "timesteps_since_restore": 376000, "iterations_since_restore": 94, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.217699115044248, "episode_len_mean": 35.6283185840708, "episodes_this_iter": 113, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.349707602339177}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.623223395912517, "mean_processing_ms": 5.9997317095302405, "mean_inference_ms": 1.0046372068844955}, "off_policy_estimator": {}, "info": {"num_steps_trained": 995840, "num_steps_sampled": 380000, "sample_time_ms": 7359.472, "load_time_ms": 14.791, "grad_time_ms": 23661.76, "update_time_ms": 32.869, "learner": {"policy_0": {"cur_kl_coeff": 0.0002471923944540322, "cur_lr": 9.999999747378752e-05, "total_loss": -0.016128983348608017, "policy_loss": -0.016137119382619858, "vf_loss": 7.45829439163208, "vf_explained_var": 0.023313799872994423, "kl": 0.0027392145711928606, "entropy": 0.38852789998054504, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 380000, "episodes_total": 9714, "training_iteration": 95, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-31-14", "timestamp": 1581503474, "time_this_iter_s": 31.933400869369507, "time_total_s": 2982.622585773468, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2982.622585773468, "timesteps_since_restore": 380000, "iterations_since_restore": 95, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.18239999999999, "episode_len_mean": 32.064, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.281462140992164}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.614652867897706, "mean_processing_ms": 6.028402689253646, "mean_inference_ms": 1.0053310375514748}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1006208, "num_steps_sampled": 384000, "sample_time_ms": 7464.027, "load_time_ms": 14.208, "grad_time_ms": 23619.033, "update_time_ms": 32.976, "learner": {"policy_0": {"cur_kl_coeff": 0.0001235961972270161, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01054174080491066, "policy_loss": 0.010533971711993217, "vf_loss": 7.310192108154297, "vf_explained_var": 0.017407691106200218, "kl": 0.003732618410140276, "entropy": 0.45811331272125244, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 384000, "episodes_total": 9839, "training_iteration": 96, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-31-45", "timestamp": 1581503505, "time_this_iter_s": 30.65617299079895, "time_total_s": 3013.278758764267, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b801e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3013.278758764267, "timesteps_since_restore": 384000, "iterations_since_restore": 96, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.58130841121495, "episode_len_mean": 37.00934579439252, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.329909365558907}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.614012708897078, "mean_processing_ms": 6.020252785034383, "mean_inference_ms": 1.0048241502231536}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1017088, "num_steps_sampled": 388000, "sample_time_ms": 7415.494, "load_time_ms": 14.159, "grad_time_ms": 23649.09, "update_time_ms": 32.679, "learner": {"policy_0": {"cur_kl_coeff": 6.179809861350805e-05, "cur_lr": 9.999999747378752e-05, "total_loss": -0.026300517842173576, "policy_loss": -0.026308216154575348, "vf_loss": 7.513362407684326, "vf_explained_var": 0.013002464547753334, "kl": 0.0031078304164111614, "entropy": 0.4795365631580353, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 388000, "episodes_total": 9946, "training_iteration": 97, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-32-16", "timestamp": 1581503536, "time_this_iter_s": 30.697096347808838, "time_total_s": 3043.975855112076, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b807b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3043.975855112076, "timesteps_since_restore": 388000, "iterations_since_restore": 97, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.49444444444444, "episode_len_mean": 36.77777777777778, "episodes_this_iter": 108, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.478153846153842}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.617950080420168, "mean_processing_ms": 6.027375343846394, "mean_inference_ms": 1.0042967928744195}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1027712, "num_steps_sampled": 392000, "sample_time_ms": 7402.08, "load_time_ms": 14.88, "grad_time_ms": 23672.617, "update_time_ms": 32.954, "learner": {"policy_0": {"cur_kl_coeff": 3.089904930675402e-05, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00463561387732625, "policy_loss": 0.004627231974154711, "vf_loss": 8.249105453491211, "vf_explained_var": -0.017892291769385338, "kl": 0.004296104423701763, "entropy": 0.5148361325263977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 392000, "episodes_total": 10054, "training_iteration": 98, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-32-46", "timestamp": 1581503566, "time_this_iter_s": 30.44468593597412, "time_total_s": 3074.42054104805, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3074.42054104805, "timesteps_since_restore": 392000, "iterations_since_restore": 98, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.727450980392145, "episode_len_mean": 38.8921568627451, "episodes_this_iter": 102, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.7331210191082755}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.609660554433172, "mean_processing_ms": 6.02995127209882, "mean_inference_ms": 1.0037313261721905}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1038592, "num_steps_sampled": 396000, "sample_time_ms": 7319.486, "load_time_ms": 14.392, "grad_time_ms": 23687.653, "update_time_ms": 32.506, "learner": {"policy_0": {"cur_kl_coeff": 1.544952465337701e-05, "cur_lr": 9.999999747378752e-05, "total_loss": -0.021328920498490334, "policy_loss": -0.02133723720908165, "vf_loss": 8.20339584350586, "vf_explained_var": -0.04434063285589218, "kl": 0.0070899599231779575, "entropy": 0.4802076518535614, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 396000, "episodes_total": 10156, "training_iteration": 99, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-33-18", "timestamp": 1581503598, "time_this_iter_s": 31.328816175460815, "time_total_s": 3105.7493572235107, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80ae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3105.7493572235107, "timesteps_since_restore": 396000, "iterations_since_restore": 99, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.63749999999999, "episode_len_mean": 36.848214285714285, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.195492957746476}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.619740921652773, "mean_processing_ms": 6.0105624713706804, "mean_inference_ms": 1.0048828030188506}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1049472, "num_steps_sampled": 400000, "sample_time_ms": 7360.083, "load_time_ms": 13.937, "grad_time_ms": 23678.592, "update_time_ms": 32.773, "learner": {"policy_0": {"cur_kl_coeff": 1.544952465337701e-05, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0009271062444895506, "policy_loss": -0.0009356619557365775, "vf_loss": 8.513772010803223, "vf_explained_var": -0.0433778241276741, "kl": 0.00313037377782166, "entropy": 0.5082111358642578, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 400000, "episodes_total": 10268, "training_iteration": 100, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-33-49", "timestamp": 1581503629, "time_this_iter_s": 31.49387836456299, "time_total_s": 3137.2432355880737, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3137.2432355880737, "timesteps_since_restore": 400000, "iterations_since_restore": 100, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.248214285714276, "episode_len_mean": 35.25, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.028908554572268}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.616937564239605, "mean_processing_ms": 6.026136763514364, "mean_inference_ms": 1.0051538701473564}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1059840, "num_steps_sampled": 404000, "sample_time_ms": 7436.276, "load_time_ms": 14.67, "grad_time_ms": 23638.157, "update_time_ms": 33.172, "learner": {"policy_0": {"cur_kl_coeff": 7.724762326688506e-06, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03692612051963806, "policy_loss": -0.03693418577313423, "vf_loss": 8.030139923095703, "vf_explained_var": -0.006465495564043522, "kl": 0.004645369481295347, "entropy": 0.5372270941734314, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 404000, "episodes_total": 10380, "training_iteration": 101, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-34-20", "timestamp": 1581503660, "time_this_iter_s": 31.009304523468018, "time_total_s": 3168.2525401115417, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3168.2525401115417, "timesteps_since_restore": 404000, "iterations_since_restore": 101, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.50769230769229, "episode_len_mean": 34.717948717948715, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.8862068965517205}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6105180450306325, "mean_processing_ms": 6.041885357199169, "mean_inference_ms": 1.0038447994441095}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1070208, "num_steps_sampled": 408000, "sample_time_ms": 7462.241, "load_time_ms": 14.035, "grad_time_ms": 23648.816, "update_time_ms": 33.115, "learner": {"policy_0": {"cur_kl_coeff": 3.862381163344253e-06, "cur_lr": 9.999999747378752e-05, "total_loss": -0.06762745976448059, "policy_loss": -0.0676356628537178, "vf_loss": 8.191155433654785, "vf_explained_var": 0.000986008788459003, "kl": 0.005010145250707865, "entropy": 0.5186324715614319, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 408000, "episodes_total": 10497, "training_iteration": 102, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-34-51", "timestamp": 1581503691, "time_this_iter_s": 30.277374505996704, "time_total_s": 3198.5299146175385, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bdea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3198.5299146175385, "timesteps_since_restore": 408000, "iterations_since_restore": 102, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.49357798165136, "episode_len_mean": 36.10091743119266, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.053453453453449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6112732074043095, "mean_processing_ms": 6.022168329647746, "mean_inference_ms": 1.0043197774755637}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1080704, "num_steps_sampled": 412000, "sample_time_ms": 7330.948, "load_time_ms": 13.915, "grad_time_ms": 23495.11, "update_time_ms": 33.088, "learner": {"policy_0": {"cur_kl_coeff": 3.862381163344253e-06, "cur_lr": 9.999999747378752e-05, "total_loss": -0.05514892190694809, "policy_loss": -0.05515735223889351, "vf_loss": 8.412155151367188, "vf_explained_var": -0.003660432528704405, "kl": 0.0060752322897315025, "entropy": 0.4646371006965637, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 412000, "episodes_total": 10606, "training_iteration": 103, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-35-21", "timestamp": 1581503721, "time_this_iter_s": 29.54999089241028, "time_total_s": 3228.0799055099487, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3228.0799055099487, "timesteps_since_restore": 412000, "iterations_since_restore": 103, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.569230769230753, "episode_len_mean": 38.0, "episodes_this_iter": 104, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.523076923076918}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6056694167085945, "mean_processing_ms": 6.035053634735515, "mean_inference_ms": 1.003515540502718}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1091200, "num_steps_sampled": 416000, "sample_time_ms": 7324.161, "load_time_ms": 13.691, "grad_time_ms": 23379.298, "update_time_ms": 33.373, "learner": {"policy_0": {"cur_kl_coeff": 3.862381163344253e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 0.022539803758263588, "policy_loss": 0.022531386464834213, "vf_loss": 8.399761199951172, "vf_explained_var": -0.01122705265879631, "kl": 0.005563075188547373, "entropy": 0.4326978623867035, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 416000, "episodes_total": 10710, "training_iteration": 104, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-35-51", "timestamp": 1581503751, "time_this_iter_s": 30.282235622406006, "time_total_s": 3258.3621411323547, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3258.3621411323547, "timesteps_since_restore": 416000, "iterations_since_restore": 104, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.89107142857141, "episode_len_mean": 36.13392857142857, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.9994011976047865}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6094398320891985, "mean_processing_ms": 6.031663082597407, "mean_inference_ms": 1.00224910460734}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1101440, "num_steps_sampled": 420000, "sample_time_ms": 7264.596, "load_time_ms": 13.521, "grad_time_ms": 23201.763, "update_time_ms": 33.322, "learner": {"policy_0": {"cur_kl_coeff": 3.862381163344253e-06, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02802150510251522, "policy_loss": -0.02802964486181736, "vf_loss": 8.126465797424316, "vf_explained_var": 0.031753960996866226, "kl": 0.005198412574827671, "entropy": 0.4453534185886383, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 420000, "episodes_total": 10822, "training_iteration": 105, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-36-21", "timestamp": 1581503781, "time_this_iter_s": 29.560049533843994, "time_total_s": 3287.9221906661987, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd9d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3287.9221906661987, "timesteps_since_restore": 420000, "iterations_since_restore": 105, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.546551724137917, "episode_len_mean": 34.491379310344826, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.78238636363636}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.610709022256282, "mean_processing_ms": 6.038221368835772, "mean_inference_ms": 1.0042424531206007}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1111808, "num_steps_sampled": 424000, "sample_time_ms": 7208.196, "load_time_ms": 13.497, "grad_time_ms": 23203.618, "update_time_ms": 33.397, "learner": {"policy_0": {"cur_kl_coeff": 3.862381163344253e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0011526438174769282, "policy_loss": 0.0011447792639955878, "vf_loss": 7.855289459228516, "vf_explained_var": 0.02680543065071106, "kl": 0.005016646813601255, "entropy": 0.4328688085079193, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 424000, "episodes_total": 10938, "training_iteration": 106, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-36-51", "timestamp": 1581503811, "time_this_iter_s": 30.11113405227661, "time_total_s": 3318.0333247184753, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264a60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3318.0333247184753, "timesteps_since_restore": 424000, "iterations_since_restore": 106, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.635114503816785, "episode_len_mean": 30.83969465648855, "episodes_this_iter": 131, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.333854166666664}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.611090163254718, "mean_processing_ms": 6.044746920646284, "mean_inference_ms": 1.0038508038972136}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1122176, "num_steps_sampled": 428000, "sample_time_ms": 7249.661, "load_time_ms": 13.459, "grad_time_ms": 23082.962, "update_time_ms": 33.48, "learner": {"policy_0": {"cur_kl_coeff": 3.862381163344253e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 0.004220043309032917, "policy_loss": 0.004212522879242897, "vf_loss": 7.514206886291504, "vf_explained_var": 0.061544470489025116, "kl": 0.003496552584692836, "entropy": 0.3880768418312073, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 428000, "episodes_total": 11069, "training_iteration": 107, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-37-21", "timestamp": 1581503841, "time_this_iter_s": 29.909403800964355, "time_total_s": 3347.9427285194397, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3347.9427285194397, "timesteps_since_restore": 428000, "iterations_since_restore": 107, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.053448275862053, "episode_len_mean": 34.18103448275862, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.801173020527855}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.609421486833622, "mean_processing_ms": 6.053860706479252, "mean_inference_ms": 1.0033326479030629}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1132544, "num_steps_sampled": 432000, "sample_time_ms": 7256.661, "load_time_ms": 13.41, "grad_time_ms": 23018.415, "update_time_ms": 33.652, "learner": {"policy_0": {"cur_kl_coeff": 1.9311905816721264e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 0.06446114927530289, "policy_loss": 0.06445338577032089, "vf_loss": 7.7645955085754395, "vf_explained_var": 0.048974595963954926, "kl": 0.005334275774657726, "entropy": 0.36936742067337036, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 432000, "episodes_total": 11185, "training_iteration": 108, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-37-51", "timestamp": 1581503871, "time_this_iter_s": 29.870970726013184, "time_total_s": 3377.813699245453, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3377.813699245453, "timesteps_since_restore": 432000, "iterations_since_restore": 108, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.198333333333327, "episode_len_mean": 33.225, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.7971910112359515}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.611226158886089, "mean_processing_ms": 6.0551076466800975, "mean_inference_ms": 1.0032143012168835}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1143168, "num_steps_sampled": 436000, "sample_time_ms": 7214.007, "load_time_ms": 13.47, "grad_time_ms": 22958.977, "update_time_ms": 33.877, "learner": {"policy_0": {"cur_kl_coeff": 1.9311905816721264e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04839055612683296, "policy_loss": 0.04838266596198082, "vf_loss": 7.883785247802734, "vf_explained_var": 0.048894163221120834, "kl": 0.0036499607376754284, "entropy": 0.3821088969707489, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 436000, "episodes_total": 11305, "training_iteration": 109, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-38-22", "timestamp": 1581503902, "time_this_iter_s": 30.311429262161255, "time_total_s": 3408.125128507614, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3408.125128507614, "timesteps_since_restore": 436000, "iterations_since_restore": 109, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.855932203389816, "episode_len_mean": 33.96610169491525, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.571428571428568}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6100158186389555, "mean_processing_ms": 6.052962573851941, "mean_inference_ms": 1.0041181111454875}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1153280, "num_steps_sampled": 440000, "sample_time_ms": 7207.43, "load_time_ms": 13.393, "grad_time_ms": 22782.468, "update_time_ms": 34.081, "learner": {"policy_0": {"cur_kl_coeff": 9.655952908360632e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 0.048808302730321884, "policy_loss": 0.048800382763147354, "vf_loss": 7.918972969055176, "vf_explained_var": 0.056784238666296005, "kl": 0.004267571493983269, "entropy": 0.42654940485954285, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 440000, "episodes_total": 11423, "training_iteration": 110, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-38-52", "timestamp": 1581503932, "time_this_iter_s": 29.665363311767578, "time_total_s": 3437.7904918193817, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff2b5b5e378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3437.7904918193817, "timesteps_since_restore": 440000, "iterations_since_restore": 110, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.930357142857133, "episode_len_mean": 35.660714285714285, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.90647058823529}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.614617767099213, "mean_processing_ms": 6.064808249653665, "mean_inference_ms": 1.0027475088996565}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1163648, "num_steps_sampled": 444000, "sample_time_ms": 7106.254, "load_time_ms": 13.318, "grad_time_ms": 22799.751, "update_time_ms": 34.136, "learner": {"policy_0": {"cur_kl_coeff": 4.827976454180316e-07, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01130655501037836, "policy_loss": -0.011314351111650467, "vf_loss": 7.79413366317749, "vf_explained_var": 0.06273306161165237, "kl": 0.0034201727248728275, "entropy": 0.41064801812171936, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 444000, "episodes_total": 11535, "training_iteration": 111, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-39-22", "timestamp": 1581503962, "time_this_iter_s": 30.169870853424072, "time_total_s": 3467.960362672806, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264c80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3467.960362672806, "timesteps_since_restore": 444000, "iterations_since_restore": 111, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.191228070175427, "episode_len_mean": 35.51754385964912, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.046064139941686}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6091295655662545, "mean_processing_ms": 6.068575988245818, "mean_inference_ms": 1.0039692572728054}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1174016, "num_steps_sampled": 448000, "sample_time_ms": 7102.834, "load_time_ms": 13.31, "grad_time_ms": 22786.99, "update_time_ms": 34.011, "learner": {"policy_0": {"cur_kl_coeff": 2.413988227090158e-07, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01891358569264412, "policy_loss": -0.01892101764678955, "vf_loss": 7.429540634155273, "vf_explained_var": 0.05747419595718384, "kl": 0.005357027985155582, "entropy": 0.4905029237270355, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 448000, "episodes_total": 11649, "training_iteration": 112, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-39-52", "timestamp": 1581503992, "time_this_iter_s": 30.113128423690796, "time_total_s": 3498.0734910964966, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bdf28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3498.0734910964966, "timesteps_since_restore": 448000, "iterations_since_restore": 112, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.729914529914524, "episode_len_mean": 34.35897435897436, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.9268571428571395}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.613844209502875, "mean_processing_ms": 6.078680166135643, "mean_inference_ms": 1.0026837619641904}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1184768, "num_steps_sampled": 452000, "sample_time_ms": 7151.222, "load_time_ms": 13.26, "grad_time_ms": 22883.309, "update_time_ms": 34.197, "learner": {"policy_0": {"cur_kl_coeff": 2.413988227090158e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014172900468111038, "policy_loss": 0.01416532788425684, "vf_loss": 7.575380802154541, "vf_explained_var": 0.07946189492940903, "kl": 0.003837774507701397, "entropy": 0.45102736353874207, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 452000, "episodes_total": 11766, "training_iteration": 113, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-40-23", "timestamp": 1581504023, "time_this_iter_s": 30.998270273208618, "time_total_s": 3529.071761369705, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3452648c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3529.071761369705, "timesteps_since_restore": 452000, "iterations_since_restore": 113, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.534453781512603, "episode_len_mean": 33.42016806722689, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.828491620111728}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.609342501920325, "mean_processing_ms": 6.075669026405751, "mean_inference_ms": 1.0032646660459685}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1195392, "num_steps_sampled": 456000, "sample_time_ms": 7176.834, "load_time_ms": 14.068, "grad_time_ms": 22890.615, "update_time_ms": 34.035, "learner": {"policy_0": {"cur_kl_coeff": 1.206994113545079e-07, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011857038363814354, "policy_loss": -0.011864375323057175, "vf_loss": 7.341924667358398, "vf_explained_var": 0.08172211796045303, "kl": 0.006465969141572714, "entropy": 0.40247830748558044, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 456000, "episodes_total": 11885, "training_iteration": 114, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-40-54", "timestamp": 1581504054, "time_this_iter_s": 30.61936855316162, "time_total_s": 3559.691129922867, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3452641e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3559.691129922867, "timesteps_since_restore": 456000, "iterations_since_restore": 114, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.697478991596626, "episode_len_mean": 33.26890756302521, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.48895027624309}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.601539210369656, "mean_processing_ms": 6.078952959910116, "mean_inference_ms": 1.0032242301126562}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1205888, "num_steps_sampled": 460000, "sample_time_ms": 7208.109, "load_time_ms": 13.541, "grad_time_ms": 22919.585, "update_time_ms": 34.28, "learner": {"policy_0": {"cur_kl_coeff": 1.206994113545079e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 0.034783728420734406, "policy_loss": 0.03477594628930092, "vf_loss": 7.783777236938477, "vf_explained_var": 0.08504670113325119, "kl": 0.0023392897564917803, "entropy": 0.38699081540107727, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 460000, "episodes_total": 12004, "training_iteration": 115, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-41-25", "timestamp": 1581504085, "time_this_iter_s": 30.156404733657837, "time_total_s": 3589.8475346565247, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd7b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3589.8475346565247, "timesteps_since_restore": 460000, "iterations_since_restore": 115, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.7829457364341, "episode_len_mean": 31.852713178294575, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.494923857868018}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.615608850479244, "mean_processing_ms": 6.095781806899723, "mean_inference_ms": 1.0023380553233343}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1216640, "num_steps_sampled": 464000, "sample_time_ms": 7240.192, "load_time_ms": 13.569, "grad_time_ms": 23042.084, "update_time_ms": 33.427, "learner": {"policy_0": {"cur_kl_coeff": 6.034970567725395e-08, "cur_lr": 9.999999747378752e-05, "total_loss": -0.010389266535639763, "policy_loss": -0.010396751575171947, "vf_loss": 7.485673427581787, "vf_explained_var": 0.11188715696334839, "kl": 0.00398249551653862, "entropy": 0.44536787271499634, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 464000, "episodes_total": 12133, "training_iteration": 116, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-41-56", "timestamp": 1581504116, "time_this_iter_s": 31.64926767349243, "time_total_s": 3621.496802330017, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264e18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3621.496802330017, "timesteps_since_restore": 464000, "iterations_since_restore": 116, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.45714285714284, "episode_len_mean": 32.81512605042017, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.56363636363636}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6030222174741215, "mean_processing_ms": 6.092652239338774, "mean_inference_ms": 1.0021923468281269}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1226880, "num_steps_sampled": 468000, "sample_time_ms": 7240.659, "load_time_ms": 14.087, "grad_time_ms": 23043.741, "update_time_ms": 33.561, "learner": {"policy_0": {"cur_kl_coeff": 3.0174852838626975e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 0.029603809118270874, "policy_loss": 0.029596250504255295, "vf_loss": 7.560809135437012, "vf_explained_var": 0.06758902966976166, "kl": 0.004117398988455534, "entropy": 0.4317483901977539, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 468000, "episodes_total": 12252, "training_iteration": 117, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-42-26", "timestamp": 1581504146, "time_this_iter_s": 29.934024810791016, "time_total_s": 3651.430827140808, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7dab70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3651.430827140808, "timesteps_since_restore": 468000, "iterations_since_restore": 117, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.965957446808506, "episode_len_mean": 28.51063829787234, "episodes_this_iter": 141, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.062210796915164}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5885389680115924, "mean_processing_ms": 6.096385510770517, "mean_inference_ms": 1.0027795051657526}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1237120, "num_steps_sampled": 472000, "sample_time_ms": 7309.329, "load_time_ms": 13.862, "grad_time_ms": 23026.898, "update_time_ms": 33.397, "learner": {"policy_0": {"cur_kl_coeff": 1.5087426419313488e-08, "cur_lr": 9.999999747378752e-05, "total_loss": -0.027690857648849487, "policy_loss": -0.02769831195473671, "vf_loss": 7.458253383636475, "vf_explained_var": 0.09868906438350677, "kl": 0.006612221244722605, "entropy": 0.40392008423805237, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 472000, "episodes_total": 12393, "training_iteration": 118, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-42-57", "timestamp": 1581504177, "time_this_iter_s": 30.3858585357666, "time_total_s": 3681.8166856765747, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3681.8166856765747, "timesteps_since_restore": 472000, "iterations_since_restore": 118, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.74634146341463, "episode_len_mean": 31.853658536585368, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.567027027027023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.610723106387435, "mean_processing_ms": 6.1158891914374935, "mean_inference_ms": 1.002177519897038}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1247872, "num_steps_sampled": 476000, "sample_time_ms": 7341.005, "load_time_ms": 13.814, "grad_time_ms": 23049.69, "update_time_ms": 33.141, "learner": {"policy_0": {"cur_kl_coeff": 1.5087426419313488e-08, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004610080271959305, "policy_loss": -0.004617612808942795, "vf_loss": 7.533725738525391, "vf_explained_var": 0.0608026422560215, "kl": 0.004348913673311472, "entropy": 0.40075692534446716, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 476000, "episodes_total": 12516, "training_iteration": 119, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-43-28", "timestamp": 1581504208, "time_this_iter_s": 30.855727910995483, "time_total_s": 3712.67241358757, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bdae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3712.67241358757, "timesteps_since_restore": 476000, "iterations_since_restore": 119, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.871304347826072, "episode_len_mean": 35.45217391304348, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.011634349030468}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.599282210465036, "mean_processing_ms": 6.114844941788974, "mean_inference_ms": 1.0023226230614515}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1258752, "num_steps_sampled": 480000, "sample_time_ms": 7334.56, "load_time_ms": 14.538, "grad_time_ms": 23215.605, "update_time_ms": 33.136, "learner": {"policy_0": {"cur_kl_coeff": 7.543713209656744e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 0.005897474475204945, "policy_loss": 0.005889490712434053, "vf_loss": 7.983713150024414, "vf_explained_var": 0.046345945447683334, "kl": 0.003967088181525469, "entropy": 0.43364909291267395, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 480000, "episodes_total": 12631, "training_iteration": 120, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-43-59", "timestamp": 1581504239, "time_this_iter_s": 31.26752495765686, "time_total_s": 3743.939938545227, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fcabf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3743.939938545227, "timesteps_since_restore": 480000, "iterations_since_restore": 120, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.606666666666655, "episode_len_mean": 32.94166666666667, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.661363636363633}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.600851281318183, "mean_processing_ms": 6.111834899285743, "mean_inference_ms": 1.0026535100854297}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1269120, "num_steps_sampled": 484000, "sample_time_ms": 7339.015, "load_time_ms": 14.261, "grad_time_ms": 23254.882, "update_time_ms": 32.808, "learner": {"policy_0": {"cur_kl_coeff": 3.771856604828372e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 0.020452693104743958, "policy_loss": 0.020444786176085472, "vf_loss": 7.905843257904053, "vf_explained_var": 0.1191854327917099, "kl": 0.0037677979562431574, "entropy": 0.402561753988266, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 484000, "episodes_total": 12751, "training_iteration": 121, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-44-30", "timestamp": 1581504270, "time_this_iter_s": 30.603283882141113, "time_total_s": 3774.543222427368, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fcaf28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3774.543222427368, "timesteps_since_restore": 484000, "iterations_since_restore": 121, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -43.00000000000007, "episode_reward_mean": -17.270689655172397, "episode_len_mean": 34.8448275862069, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.892352941176467}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.599824571025808, "mean_processing_ms": 6.111208359112307, "mean_inference_ms": 1.002299261015534}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1279232, "num_steps_sampled": 488000, "sample_time_ms": 7256.199, "load_time_ms": 14.178, "grad_time_ms": 23218.681, "update_time_ms": 32.968, "learner": {"policy_0": {"cur_kl_coeff": 1.885928302414186e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013248051516711712, "policy_loss": 0.01324054878205061, "vf_loss": 7.5094804763793945, "vf_explained_var": 0.12045097351074219, "kl": 0.00408066064119339, "entropy": 0.3678245544433594, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 488000, "episodes_total": 12867, "training_iteration": 122, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-44-59", "timestamp": 1581504299, "time_this_iter_s": 28.92313003540039, "time_total_s": 3803.4663524627686, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b809d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3803.4663524627686, "timesteps_since_restore": 488000, "iterations_since_restore": 122, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.74239999999999, "episode_len_mean": 32.056, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.565957446808508}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.592533084157691, "mean_processing_ms": 6.132388542198178, "mean_inference_ms": 1.0016580805512378}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1289984, "num_steps_sampled": 492000, "sample_time_ms": 7247.157, "load_time_ms": 14.185, "grad_time_ms": 23201.359, "update_time_ms": 32.734, "learner": {"policy_0": {"cur_kl_coeff": 9.42964151207093e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 0.023208221420645714, "policy_loss": 0.023200809955596924, "vf_loss": 7.409310340881348, "vf_explained_var": 0.11359971761703491, "kl": 0.003541390411555767, "entropy": 0.38481372594833374, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 492000, "episodes_total": 12992, "training_iteration": 123, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-45-30", "timestamp": 1581504330, "time_this_iter_s": 30.73442792892456, "time_total_s": 3834.200780391693, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80f28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3834.200780391693, "timesteps_since_restore": 492000, "iterations_since_restore": 123, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.117857142857133, "episode_len_mean": 35.732142857142854, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.170605187319881}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.598794711835739, "mean_processing_ms": 6.139887520833336, "mean_inference_ms": 1.000547245292936}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1300864, "num_steps_sampled": 496000, "sample_time_ms": 7226.95, "load_time_ms": 14.251, "grad_time_ms": 23247.405, "update_time_ms": 33.023, "learner": {"policy_0": {"cur_kl_coeff": 4.714820756035465e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 0.018893597647547722, "policy_loss": 0.018886007368564606, "vf_loss": 7.591866493225098, "vf_explained_var": 0.090400829911232, "kl": 0.004526339005678892, "entropy": 0.330456018447876, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 496000, "episodes_total": 13104, "training_iteration": 124, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-46-01", "timestamp": 1581504361, "time_this_iter_s": 30.879432439804077, "time_total_s": 3865.080212831497, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fcab70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3865.080212831497, "timesteps_since_restore": 496000, "iterations_since_restore": 124, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.607017543859634, "episode_len_mean": 34.526315789473685, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.718518518518515}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.59792444616528, "mean_processing_ms": 6.110833809494273, "mean_inference_ms": 1.0021945232792249}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1311360, "num_steps_sampled": 500000, "sample_time_ms": 7215.141, "load_time_ms": 14.292, "grad_time_ms": 23266.77, "update_time_ms": 32.826, "learner": {"policy_0": {"cur_kl_coeff": 2.3574103780177325e-10, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01589055545628071, "policy_loss": -0.015897972509264946, "vf_loss": 7.419342041015625, "vf_explained_var": 0.12339051067829132, "kl": 0.005751599092036486, "entropy": 0.2749595046043396, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 500000, "episodes_total": 13218, "training_iteration": 125, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-46-32", "timestamp": 1581504392, "time_this_iter_s": 30.230857849121094, "time_total_s": 3895.3110706806183, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fcaa60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3895.3110706806183, "timesteps_since_restore": 500000, "iterations_since_restore": 125, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -38.60000000000001, "episode_reward_mean": -18.014545454545438, "episode_len_mean": 36.64545454545455, "episodes_this_iter": 110, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.777259475218656}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.595314521626756, "mean_processing_ms": 6.125914794024923, "mean_inference_ms": 1.0010811104547972}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1321344, "num_steps_sampled": 504000, "sample_time_ms": 7111.782, "load_time_ms": 14.215, "grad_time_ms": 23097.055, "update_time_ms": 32.925, "learner": {"policy_0": {"cur_kl_coeff": 2.3574103780177325e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0006881321896798909, "policy_loss": 0.0006805899902246892, "vf_loss": 7.546524524688721, "vf_explained_var": 0.05036243423819542, "kl": 0.0029761958867311478, "entropy": 0.2560945451259613, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 504000, "episodes_total": 13328, "training_iteration": 126, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-47-01", "timestamp": 1581504421, "time_this_iter_s": 28.918041229248047, "time_total_s": 3924.2291119098663, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3924.2291119098663, "timesteps_since_restore": 504000, "iterations_since_restore": 126, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -38.400000000000006, "episode_reward_mean": -17.26554621848738, "episode_len_mean": 33.94117647058823, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.64450549450549}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.577586640428816, "mean_processing_ms": 6.116177997499709, "mean_inference_ms": 1.0013723635347975}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1331840, "num_steps_sampled": 508000, "sample_time_ms": 7132.566, "load_time_ms": 13.706, "grad_time_ms": 23145.641, "update_time_ms": 32.632, "learner": {"policy_0": {"cur_kl_coeff": 1.1787051890088662e-10, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01578763872385025, "policy_loss": -0.015795232728123665, "vf_loss": 7.59009313583374, "vf_explained_var": 0.07917476445436478, "kl": 0.0027752835303545, "entropy": 0.264119029045105, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 508000, "episodes_total": 13447, "training_iteration": 127, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-47-32", "timestamp": 1581504452, "time_this_iter_s": 30.620324850082397, "time_total_s": 3954.8494367599487, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292ad08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3954.8494367599487, "timesteps_since_restore": 508000, "iterations_since_restore": 127, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.790654205607456, "episode_len_mean": 37.12149532710281, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.983928571428568}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.585487049150944, "mean_processing_ms": 6.1259787573322, "mean_inference_ms": 0.9997545293680042}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1342208, "num_steps_sampled": 512000, "sample_time_ms": 7031.206, "load_time_ms": 13.951, "grad_time_ms": 23175.518, "update_time_ms": 32.525, "learner": {"policy_0": {"cur_kl_coeff": 5.893525945044331e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 0.005386688280850649, "policy_loss": 0.005379009991884232, "vf_loss": 7.675482749938965, "vf_explained_var": 0.05497901141643524, "kl": 0.0025862399488687515, "entropy": 0.23351380228996277, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 512000, "episodes_total": 13554, "training_iteration": 128, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-48-01", "timestamp": 1581504481, "time_this_iter_s": 29.673607349395752, "time_total_s": 3984.5230441093445, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292aa60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3984.5230441093445, "timesteps_since_restore": 512000, "iterations_since_restore": 128, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.085714285714268, "episode_len_mean": 35.767857142857146, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.837463976945241}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.583334097855093, "mean_processing_ms": 6.1293587592785475, "mean_inference_ms": 1.0004722529225076}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1352704, "num_steps_sampled": 516000, "sample_time_ms": 7099.497, "load_time_ms": 13.843, "grad_time_ms": 23117.612, "update_time_ms": 32.906, "learner": {"policy_0": {"cur_kl_coeff": 2.9467629725221656e-11, "cur_lr": 9.999999747378752e-05, "total_loss": -0.022204093635082245, "policy_loss": -0.0222118329256773, "vf_loss": 7.739120960235596, "vf_explained_var": 0.04880335181951523, "kl": 0.0025245328433811665, "entropy": 0.2638016641139984, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 516000, "episodes_total": 13666, "training_iteration": 129, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-48-33", "timestamp": 1581504513, "time_this_iter_s": 30.959820985794067, "time_total_s": 4015.4828650951385, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4015.4828650951385, "timesteps_since_restore": 516000, "iterations_since_restore": 129, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.705882352941163, "episode_len_mean": 39.36274509803921, "episodes_this_iter": 102, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.611842105263153}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.584556245797657, "mean_processing_ms": 6.142868487975382, "mean_inference_ms": 1.0005824789356617}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1362816, "num_steps_sampled": 520000, "sample_time_ms": 7058.428, "load_time_ms": 13.124, "grad_time_ms": 22944.885, "update_time_ms": 32.705, "learner": {"policy_0": {"cur_kl_coeff": 1.4733814862610828e-11, "cur_lr": 9.999999747378752e-05, "total_loss": -8.305002120323479e-05, "policy_loss": -9.041986777447164e-05, "vf_loss": 7.372055530548096, "vf_explained_var": 0.03717581182718277, "kl": 0.001317324466072023, "entropy": 0.25962406396865845, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 520000, "episodes_total": 13768, "training_iteration": 130, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-49-02", "timestamp": 1581504542, "time_this_iter_s": 29.11955761909485, "time_total_s": 4044.6024227142334, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca6a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4044.6024227142334, "timesteps_since_restore": 520000, "iterations_since_restore": 130, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.65225225225224, "episode_len_mean": 35.32432432432432, "episodes_this_iter": 111, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.831547619047615}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.582456853163572, "mean_processing_ms": 6.1372798102381765, "mean_inference_ms": 1.0010607221329426}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1373056, "num_steps_sampled": 524000, "sample_time_ms": 7054.563, "load_time_ms": 12.779, "grad_time_ms": 22849.378, "update_time_ms": 32.698, "learner": {"policy_0": {"cur_kl_coeff": 7.366907431305414e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04200303554534912, "policy_loss": 0.04199529439210892, "vf_loss": 7.7434868812561035, "vf_explained_var": 0.057997871190309525, "kl": 0.0029031983576714993, "entropy": 0.23005008697509766, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 524000, "episodes_total": 13879, "training_iteration": 131, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-49-32", "timestamp": 1581504572, "time_this_iter_s": 29.60467839241028, "time_total_s": 4074.2071011066437, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4074.2071011066437, "timesteps_since_restore": 524000, "iterations_since_restore": 131, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.581132075471697, "episode_len_mean": 38.028301886792455, "episodes_this_iter": 106, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.71261538461538}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.59109947277855, "mean_processing_ms": 6.127170849937217, "mean_inference_ms": 1.0006843582887381}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1384064, "num_steps_sampled": 528000, "sample_time_ms": 7054.643, "load_time_ms": 13.527, "grad_time_ms": 23028.289, "update_time_ms": 32.692, "learner": {"policy_0": {"cur_kl_coeff": 3.683453715652707e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014352517202496529, "policy_loss": 0.014344916678965092, "vf_loss": 7.600454807281494, "vf_explained_var": 0.05437355861067772, "kl": 0.0022407674696296453, "entropy": 0.21990808844566345, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 528000, "episodes_total": 13985, "training_iteration": 132, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-50-03", "timestamp": 1581504603, "time_this_iter_s": 30.720192432403564, "time_total_s": 4104.927293539047, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4104.927293539047, "timesteps_since_restore": 528000, "iterations_since_restore": 132, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.90169491525423, "episode_len_mean": 34.0, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.678494623655911}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.585770247962, "mean_processing_ms": 6.140700696478153, "mean_inference_ms": 1.0005893399012493}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1394944, "num_steps_sampled": 532000, "sample_time_ms": 7118.965, "load_time_ms": 13.949, "grad_time_ms": 23048.851, "update_time_ms": 32.542, "learner": {"policy_0": {"cur_kl_coeff": 1.8417268578263535e-12, "cur_lr": 9.999999747378752e-05, "total_loss": -0.009313319809734821, "policy_loss": -0.009321313351392746, "vf_loss": 7.9968390464782715, "vf_explained_var": 0.079889215528965, "kl": 0.0030758832581341267, "entropy": 0.2867048382759094, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 532000, "episodes_total": 14103, "training_iteration": 133, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-50-34", "timestamp": 1581504634, "time_this_iter_s": 31.583706378936768, "time_total_s": 4136.510999917984, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4136.510999917984, "timesteps_since_restore": 532000, "iterations_since_restore": 133, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.264347826086954, "episode_len_mean": 34.86086956521739, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.141520467836253}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.584415376979693, "mean_processing_ms": 6.139692221693377, "mean_inference_ms": 1.0007922130962683}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1405568, "num_steps_sampled": 536000, "sample_time_ms": 7150.066, "load_time_ms": 13.155, "grad_time_ms": 22976.857, "update_time_ms": 32.21, "learner": {"policy_0": {"cur_kl_coeff": 9.208634289131767e-13, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0011286851949989796, "policy_loss": -0.0011357658077031374, "vf_loss": 7.084601879119873, "vf_explained_var": 0.08098016679286957, "kl": 0.0026378280017524958, "entropy": 0.23330938816070557, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 536000, "episodes_total": 14218, "training_iteration": 134, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-51-05", "timestamp": 1581504665, "time_this_iter_s": 30.458616733551025, "time_total_s": 4166.969616651535, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264b70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4166.969616651535, "timesteps_since_restore": 536000, "iterations_since_restore": 134, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.36146788990824, "episode_len_mean": 37.12844036697248, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.493538461538457}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5927067173337335, "mean_processing_ms": 6.149137911420126, "mean_inference_ms": 1.0004601191752371}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1416192, "num_steps_sampled": 540000, "sample_time_ms": 7120.99, "load_time_ms": 13.914, "grad_time_ms": 22990.613, "update_time_ms": 32.284, "learner": {"policy_0": {"cur_kl_coeff": 4.604317144565884e-13, "cur_lr": 9.999999747378752e-05, "total_loss": -0.028007272630929947, "policy_loss": -0.02801470272243023, "vf_loss": 7.427319049835205, "vf_explained_var": 0.048624396324157715, "kl": 0.0028147685807198286, "entropy": 0.2505410313606262, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 540000, "episodes_total": 14327, "training_iteration": 135, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-51-35", "timestamp": 1581504695, "time_this_iter_s": 30.085925102233887, "time_total_s": 4197.055541753769, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292af28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4197.055541753769, "timesteps_since_restore": 540000, "iterations_since_restore": 135, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.0155172413793, "episode_len_mean": 34.86206896551724, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.9033898305084715}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.587893015138528, "mean_processing_ms": 6.160239276557561, "mean_inference_ms": 1.0002775293535378}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1426816, "num_steps_sampled": 544000, "sample_time_ms": 7177.079, "load_time_ms": 13.988, "grad_time_ms": 23136.234, "update_time_ms": 32.106, "learner": {"policy_0": {"cur_kl_coeff": 2.302158572282942e-13, "cur_lr": 9.999999747378752e-05, "total_loss": -0.029517317190766335, "policy_loss": -0.029524341225624084, "vf_loss": 7.0226359367370605, "vf_explained_var": 0.11412137001752853, "kl": 0.002786422148346901, "entropy": 0.21013200283050537, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 544000, "episodes_total": 14443, "training_iteration": 136, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-52-06", "timestamp": 1581504726, "time_this_iter_s": 30.937127590179443, "time_total_s": 4227.992669343948, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292ae18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4227.992669343948, "timesteps_since_restore": 544000, "iterations_since_restore": 136, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.815999999999985, "episode_len_mean": 40.05, "episodes_this_iter": 96, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.650479233226832}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.580938902280477, "mean_processing_ms": 6.136607544169688, "mean_inference_ms": 0.9992812574683115}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1437184, "num_steps_sampled": 548000, "sample_time_ms": 7075.047, "load_time_ms": 13.984, "grad_time_ms": 23072.795, "update_time_ms": 32.279, "learner": {"policy_0": {"cur_kl_coeff": 1.151079286141471e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 0.007556028664112091, "policy_loss": 0.007547836285084486, "vf_loss": 8.192323684692383, "vf_explained_var": 0.07204865664243698, "kl": 0.0030031492933630943, "entropy": 0.20715206861495972, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 548000, "episodes_total": 14539, "training_iteration": 137, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-52-36", "timestamp": 1581504756, "time_this_iter_s": 28.969828128814697, "time_total_s": 4256.962497472763, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b806a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4256.962497472763, "timesteps_since_restore": 548000, "iterations_since_restore": 137, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.507407407407396, "episode_len_mean": 37.574074074074076, "episodes_this_iter": 108, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.326726726726722}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.583974797735238, "mean_processing_ms": 6.144591911125872, "mean_inference_ms": 0.9996119359915748}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1447808, "num_steps_sampled": 552000, "sample_time_ms": 7107.016, "load_time_ms": 14.016, "grad_time_ms": 23108.913, "update_time_ms": 32.582, "learner": {"policy_0": {"cur_kl_coeff": 5.755396430707355e-14, "cur_lr": 9.999999747378752e-05, "total_loss": -0.002797103952616453, "policy_loss": -0.0028048227541148663, "vf_loss": 7.71674108505249, "vf_explained_var": 0.10887819528579712, "kl": 0.004308243747800589, "entropy": 0.22668927907943726, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 552000, "episodes_total": 14647, "training_iteration": 138, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-53-06", "timestamp": 1581504786, "time_this_iter_s": 30.356794118881226, "time_total_s": 4287.319291591644, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4287.319291591644, "timesteps_since_restore": 552000, "iterations_since_restore": 138, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.830357142857142, "episode_len_mean": 34.955357142857146, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.113043478260866}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5922533044541725, "mean_processing_ms": 6.153496247542021, "mean_inference_ms": 0.9998809721900518}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1458816, "num_steps_sampled": 556000, "sample_time_ms": 7118.884, "load_time_ms": 14.497, "grad_time_ms": 23232.806, "update_time_ms": 32.358, "learner": {"policy_0": {"cur_kl_coeff": 2.877698215353677e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014100256375968456, "policy_loss": 0.014092703349888325, "vf_loss": 7.552449703216553, "vf_explained_var": 0.1379246860742569, "kl": 0.002916771685704589, "entropy": 0.2361132651567459, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 556000, "episodes_total": 14759, "training_iteration": 139, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-53-39", "timestamp": 1581504819, "time_this_iter_s": 32.32152318954468, "time_total_s": 4319.640814781189, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fcaae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4319.640814781189, "timesteps_since_restore": 556000, "iterations_since_restore": 139, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -22.007999999999996, "episode_len_mean": 40.21, "episodes_this_iter": 100, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -7.0765273311897054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.594541158751963, "mean_processing_ms": 6.155641473503891, "mean_inference_ms": 1.000498092352248}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1470080, "num_steps_sampled": 560000, "sample_time_ms": 7125.589, "load_time_ms": 14.672, "grad_time_ms": 23492.699, "update_time_ms": 32.887, "learner": {"policy_0": {"cur_kl_coeff": 1.4388491076768387e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03144531324505806, "policy_loss": 0.03143773600459099, "vf_loss": 7.57661771774292, "vf_explained_var": 0.0489409938454628, "kl": 0.003162114415317774, "entropy": 0.21828261017799377, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 560000, "episodes_total": 14859, "training_iteration": 140, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-54-11", "timestamp": 1581504851, "time_this_iter_s": 31.791500329971313, "time_total_s": 4351.43231511116, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4351.43231511116, "timesteps_since_restore": 560000, "iterations_since_restore": 140, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -22.651428571428582, "episode_len_mean": 38.819047619047616, "episodes_this_iter": 105, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.893913043478256}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.580688240495541, "mean_processing_ms": 6.138090960529379, "mean_inference_ms": 1.0006499783201006}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1481856, "num_steps_sampled": 564000, "sample_time_ms": 7077.536, "load_time_ms": 15.554, "grad_time_ms": 23833.931, "update_time_ms": 32.63, "learner": {"policy_0": {"cur_kl_coeff": 7.194245538384193e-15, "cur_lr": 9.999999747378752e-05, "total_loss": -0.028493409976363182, "policy_loss": -0.02850058116018772, "vf_loss": 7.170001029968262, "vf_explained_var": 0.08655761182308197, "kl": 0.0032250385265797377, "entropy": 0.24991632997989655, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 564000, "episodes_total": 14964, "training_iteration": 141, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-54-43", "timestamp": 1581504883, "time_this_iter_s": 32.54166769981384, "time_total_s": 4383.973982810974, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c9d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4383.973982810974, "timesteps_since_restore": 564000, "iterations_since_restore": 141, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.972881355932195, "episode_len_mean": 34.17796610169491, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.8911111111111065}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.596893791318566, "mean_processing_ms": 6.148668000432849, "mean_inference_ms": 1.0003158594451007}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1492608, "num_steps_sampled": 568000, "sample_time_ms": 7166.262, "load_time_ms": 15.289, "grad_time_ms": 23778.163, "update_time_ms": 32.715, "learner": {"policy_0": {"cur_kl_coeff": 3.597122769192097e-15, "cur_lr": 9.999999747378752e-05, "total_loss": -0.028159376233816147, "policy_loss": -0.02816656418144703, "vf_loss": 7.182799339294434, "vf_explained_var": 0.11511088907718658, "kl": 0.0039930506609380245, "entropy": 0.20564612746238708, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 568000, "episodes_total": 15082, "training_iteration": 142, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-55-15", "timestamp": 1581504915, "time_this_iter_s": 31.046884775161743, "time_total_s": 4415.020867586136, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac31e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4415.020867586136, "timesteps_since_restore": 568000, "iterations_since_restore": 142, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.601599999999994, "episode_len_mean": 31.536, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.563538873994635}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.587111308541578, "mean_processing_ms": 6.1606356741217345, "mean_inference_ms": 0.999419598687782}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1503488, "num_steps_sampled": 572000, "sample_time_ms": 7098.0, "load_time_ms": 15.053, "grad_time_ms": 23781.033, "update_time_ms": 32.888, "learner": {"policy_0": {"cur_kl_coeff": 1.7985613845960483e-15, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0019643132109194994, "policy_loss": -0.0019716296810656786, "vf_loss": 7.314664840698242, "vf_explained_var": 0.17690087854862213, "kl": 0.0024421566631644964, "entropy": 0.1988147795200348, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 572000, "episodes_total": 15207, "training_iteration": 143, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-55-46", "timestamp": 1581504946, "time_this_iter_s": 30.93148112297058, "time_total_s": 4445.952348709106, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4445.952348709106, "timesteps_since_restore": 572000, "iterations_since_restore": 143, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.638983050847454, "episode_len_mean": 34.440677966101696, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.976630434782606}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.587553848375529, "mean_processing_ms": 6.1684177484203015, "mean_inference_ms": 0.9988723754747908}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1514496, "num_steps_sampled": 576000, "sample_time_ms": 7094.142, "load_time_ms": 15.858, "grad_time_ms": 23897.066, "update_time_ms": 33.182, "learner": {"policy_0": {"cur_kl_coeff": 8.992806922980242e-16, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03075607679784298, "policy_loss": -0.030762875452637672, "vf_loss": 6.801430702209473, "vf_explained_var": 0.15714310109615326, "kl": 0.0030225415248423815, "entropy": 0.22312051057815552, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 576000, "episodes_total": 15325, "training_iteration": 144, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-56-17", "timestamp": 1581504977, "time_this_iter_s": 31.591456651687622, "time_total_s": 4477.543805360794, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57dbf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4477.543805360794, "timesteps_since_restore": 576000, "iterations_since_restore": 144, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.25999999999999, "episode_len_mean": 32.825, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.508510638297869}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.581071329791873, "mean_processing_ms": 6.16572527921512, "mean_inference_ms": 0.9986258478081994}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1525376, "num_steps_sampled": 580000, "sample_time_ms": 7200.372, "load_time_ms": 15.262, "grad_time_ms": 23959.143, "update_time_ms": 32.881, "learner": {"policy_0": {"cur_kl_coeff": 4.496403461490121e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 0.009487495757639408, "policy_loss": 0.009481008164584637, "vf_loss": 6.488831520080566, "vf_explained_var": 0.1751539558172226, "kl": 0.0033638905733823776, "entropy": 0.21595102548599243, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 580000, "episodes_total": 15445, "training_iteration": 145, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-56-49", "timestamp": 1581505009, "time_this_iter_s": 31.76016879081726, "time_total_s": 4509.303974151611, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57dd90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4509.303974151611, "timesteps_since_restore": 580000, "iterations_since_restore": 145, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.57981651376147, "episode_len_mean": 36.440366972477065, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.656379821958451}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.582594113065807, "mean_processing_ms": 6.158482194913256, "mean_inference_ms": 0.9992095231825792}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1536896, "num_steps_sampled": 584000, "sample_time_ms": 7183.567, "load_time_ms": 15.376, "grad_time_ms": 24156.965, "update_time_ms": 33.277, "learner": {"policy_0": {"cur_kl_coeff": 2.2482017307450604e-16, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02531776763498783, "policy_loss": -0.02532527782022953, "vf_loss": 7.502133369445801, "vf_explained_var": 0.10438572615385056, "kl": 0.0026407232508063316, "entropy": 0.22252413630485535, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 584000, "episodes_total": 15554, "training_iteration": 146, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-57-23", "timestamp": 1581505043, "time_this_iter_s": 32.752068758010864, "time_total_s": 4542.056042909622, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4542.056042909622, "timesteps_since_restore": 584000, "iterations_since_restore": 146, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.429565217391296, "episode_len_mean": 35.321739130434786, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.223955431754871}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.594431347193006, "mean_processing_ms": 6.155091629448129, "mean_inference_ms": 0.99913118549713}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1548160, "num_steps_sampled": 588000, "sample_time_ms": 7278.927, "load_time_ms": 16.116, "grad_time_ms": 24363.472, "update_time_ms": 33.333, "learner": {"policy_0": {"cur_kl_coeff": 1.1241008653725302e-16, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04013480991125107, "policy_loss": -0.04014232009649277, "vf_loss": 7.509382724761963, "vf_explained_var": 0.16462962329387665, "kl": 0.0034593192394822836, "entropy": 0.23981918394565582, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 588000, "episodes_total": 15669, "training_iteration": 147, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-57-55", "timestamp": 1581505075, "time_this_iter_s": 31.99321746826172, "time_total_s": 4574.049260377884, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4574.049260377884, "timesteps_since_restore": 588000, "iterations_since_restore": 147, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.18275862068965, "episode_len_mean": 34.53448275862069, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.2505617977528045}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.588926737927343, "mean_processing_ms": 6.171997642629861, "mean_inference_ms": 0.9982141893226945}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1559552, "num_steps_sampled": 592000, "sample_time_ms": 7290.109, "load_time_ms": 15.705, "grad_time_ms": 24533.695, "update_time_ms": 32.961, "learner": {"policy_0": {"cur_kl_coeff": 5.620504326862651e-17, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0290604867041111, "policy_loss": -0.029067333787679672, "vf_loss": 6.849573135375977, "vf_explained_var": 0.171652689576149, "kl": 0.0035837783943861723, "entropy": 0.27101001143455505, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 592000, "episodes_total": 15785, "training_iteration": 148, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-58-27", "timestamp": 1581505107, "time_this_iter_s": 32.162750482559204, "time_total_s": 4606.212010860443, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80b70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4606.212010860443, "timesteps_since_restore": 592000, "iterations_since_restore": 148, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.650847457627115, "episode_len_mean": 33.6271186440678, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.0461538461538415}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.586686001252634, "mean_processing_ms": 6.157678747413117, "mean_inference_ms": 0.9989414379359866}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1570944, "num_steps_sampled": 596000, "sample_time_ms": 7215.314, "load_time_ms": 15.427, "grad_time_ms": 24620.167, "update_time_ms": 33.071, "learner": {"policy_0": {"cur_kl_coeff": 2.8102521634313255e-17, "cur_lr": 9.999999747378752e-05, "total_loss": -0.028148634359240532, "policy_loss": -0.028155095875263214, "vf_loss": 6.457319736480713, "vf_explained_var": 0.20477665960788727, "kl": 0.003437766106799245, "entropy": 0.25033360719680786, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 596000, "episodes_total": 15903, "training_iteration": 149, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-59-00", "timestamp": 1581505140, "time_this_iter_s": 32.4364173412323, "time_total_s": 4638.648428201675, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4638.648428201675, "timesteps_since_restore": 596000, "iterations_since_restore": 149, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.206611570247933, "episode_len_mean": 33.49586776859504, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.8903743315508}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.581032303796221, "mean_processing_ms": 6.176446884297161, "mean_inference_ms": 0.9979837724845655}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1581952, "num_steps_sampled": 600000, "sample_time_ms": 7244.517, "load_time_ms": 16.481, "grad_time_ms": 24566.452, "update_time_ms": 32.237, "learner": {"policy_0": {"cur_kl_coeff": 1.4051260817156628e-17, "cur_lr": 9.999999747378752e-05, "total_loss": 0.020626250654459, "policy_loss": 0.02061949484050274, "vf_loss": 6.759500026702881, "vf_explained_var": 0.20650222897529602, "kl": 0.00362289953045547, "entropy": 0.21661654114723206, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 600000, "episodes_total": 16024, "training_iteration": 150, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_10-59-32", "timestamp": 1581505172, "time_this_iter_s": 31.548673629760742, "time_total_s": 4670.197101831436, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4670.197101831436, "timesteps_since_restore": 600000, "iterations_since_restore": 150, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.885483870967732, "episode_len_mean": 32.233870967741936, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.613404825737263}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.584827377104046, "mean_processing_ms": 6.177826029174274, "mean_inference_ms": 0.998584708875352}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1592704, "num_steps_sampled": 604000, "sample_time_ms": 7354.432, "load_time_ms": 15.969, "grad_time_ms": 24345.58, "update_time_ms": 32.598, "learner": {"policy_0": {"cur_kl_coeff": 7.025630408578314e-18, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00631920900195837, "policy_loss": 0.0063125318847596645, "vf_loss": 6.679357051849365, "vf_explained_var": 0.1983807235956192, "kl": 0.0025216247886419296, "entropy": 0.1775789111852646, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 604000, "episodes_total": 16148, "training_iteration": 151, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-00-03", "timestamp": 1581505203, "time_this_iter_s": 31.430768489837646, "time_total_s": 4701.627870321274, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4701.627870321274, "timesteps_since_restore": 604000, "iterations_since_restore": 151, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.72142857142856, "episode_len_mean": 35.607142857142854, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.203550295857983}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.591860686249594, "mean_processing_ms": 6.18361692565873, "mean_inference_ms": 0.9984239529471564}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1603456, "num_steps_sampled": 608000, "sample_time_ms": 7310.783, "load_time_ms": 15.644, "grad_time_ms": 24344.512, "update_time_ms": 32.637, "learner": {"policy_0": {"cur_kl_coeff": 3.512815204289157e-18, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03203701600432396, "policy_loss": -0.03204451501369476, "vf_loss": 7.501521587371826, "vf_explained_var": 0.13320209085941315, "kl": 0.003217048477381468, "entropy": 0.2224351316690445, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 608000, "episodes_total": 16260, "training_iteration": 152, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-00-34", "timestamp": 1581505234, "time_this_iter_s": 30.597203016281128, "time_total_s": 4732.225073337555, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292aea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4732.225073337555, "timesteps_since_restore": 608000, "iterations_since_restore": 152, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.119626168224286, "episode_len_mean": 36.64485981308411, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.199393939393936}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.583621181470834, "mean_processing_ms": 6.170710752879533, "mean_inference_ms": 0.9979130776946867}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1614208, "num_steps_sampled": 612000, "sample_time_ms": 7270.686, "load_time_ms": 16.321, "grad_time_ms": 24290.287, "update_time_ms": 32.645, "learner": {"policy_0": {"cur_kl_coeff": 1.7564076021445784e-18, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0018870902713388205, "policy_loss": 0.0018798025557771325, "vf_loss": 7.292238712310791, "vf_explained_var": 0.15585371851921082, "kl": 0.0019897969905287027, "entropy": 0.20121917128562927, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 612000, "episodes_total": 16367, "training_iteration": 153, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-01-04", "timestamp": 1581505264, "time_this_iter_s": 29.992254495620728, "time_total_s": 4762.217327833176, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244fea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4762.217327833176, "timesteps_since_restore": 612000, "iterations_since_restore": 153, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.496666666666663, "episode_len_mean": 33.74166666666667, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.841052631578943}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.581930435377759, "mean_processing_ms": 6.185999758680987, "mean_inference_ms": 0.9981534047003875}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1625344, "num_steps_sampled": 616000, "sample_time_ms": 7252.025, "load_time_ms": 15.715, "grad_time_ms": 24314.224, "update_time_ms": 32.479, "learner": {"policy_0": {"cur_kl_coeff": 8.782038010722892e-19, "cur_lr": 9.999999747378752e-05, "total_loss": -0.044707316905260086, "policy_loss": -0.04471400007605553, "vf_loss": 6.676176071166992, "vf_explained_var": 0.16237829625606537, "kl": 0.0027737393975257874, "entropy": 0.2026950567960739, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 616000, "episodes_total": 16487, "training_iteration": 154, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-01-36", "timestamp": 1581505296, "time_this_iter_s": 31.634734869003296, "time_total_s": 4793.852062702179, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fcad90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4793.852062702179, "timesteps_since_restore": 616000, "iterations_since_restore": 154, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.515789473684197, "episode_len_mean": 35.578947368421055, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.171929824561399}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5797785722091895, "mean_processing_ms": 6.1939460841196805, "mean_inference_ms": 0.9980432262254979}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1636096, "num_steps_sampled": 620000, "sample_time_ms": 7192.618, "load_time_ms": 15.445, "grad_time_ms": 24265.21, "update_time_ms": 32.606, "learner": {"policy_0": {"cur_kl_coeff": 4.391019005361446e-19, "cur_lr": 9.999999747378752e-05, "total_loss": 0.05012622848153114, "policy_loss": 0.05011859908699989, "vf_loss": 7.635777950286865, "vf_explained_var": 0.1346244066953659, "kl": 0.002942518563941121, "entropy": 0.2064487338066101, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 620000, "episodes_total": 16601, "training_iteration": 155, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-02-07", "timestamp": 1581505327, "time_this_iter_s": 30.673874139785767, "time_total_s": 4824.525936841965, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fcaea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4824.525936841965, "timesteps_since_restore": 620000, "iterations_since_restore": 155, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.728571428571417, "episode_len_mean": 35.0, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.010315186246414}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.587307271356189, "mean_processing_ms": 6.173516061624912, "mean_inference_ms": 0.9982202353358441}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1646976, "num_steps_sampled": 624000, "sample_time_ms": 7267.039, "load_time_ms": 15.99, "grad_time_ms": 24126.052, "update_time_ms": 32.461, "learner": {"policy_0": {"cur_kl_coeff": 2.195509502680723e-19, "cur_lr": 9.999999747378752e-05, "total_loss": -0.007919220253825188, "policy_loss": -0.007925538346171379, "vf_loss": 6.315264701843262, "vf_explained_var": 0.18278798460960388, "kl": 0.0023595935199409723, "entropy": 0.22071386873722076, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 624000, "episodes_total": 16713, "training_iteration": 156, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-02-39", "timestamp": 1581505359, "time_this_iter_s": 32.10629630088806, "time_total_s": 4856.632233142853, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3b70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4856.632233142853, "timesteps_since_restore": 624000, "iterations_since_restore": 156, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.974358974358964, "episode_len_mean": 34.52136752136752, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.95750708215297}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.58856460668467, "mean_processing_ms": 6.185166511823672, "mean_inference_ms": 0.9973983426982027}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1657728, "num_steps_sampled": 628000, "sample_time_ms": 7236.952, "load_time_ms": 15.278, "grad_time_ms": 24029.217, "update_time_ms": 32.667, "learner": {"policy_0": {"cur_kl_coeff": 1.0977547513403615e-19, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0018022703006863594, "policy_loss": 0.0017955852672457695, "vf_loss": 6.683589458465576, "vf_explained_var": 0.1654452085494995, "kl": 0.002985063474625349, "entropy": 0.22008422017097473, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 628000, "episodes_total": 16830, "training_iteration": 157, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-03-10", "timestamp": 1581505390, "time_this_iter_s": 30.720048666000366, "time_total_s": 4887.352281808853, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57dae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4887.352281808853, "timesteps_since_restore": 628000, "iterations_since_restore": 157, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.2793388429752, "episode_len_mean": 32.70247933884298, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.728219178082188}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.572887416200507, "mean_processing_ms": 6.194314178991896, "mean_inference_ms": 0.9976320962332632}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1668480, "num_steps_sampled": 632000, "sample_time_ms": 7365.331, "load_time_ms": 14.984, "grad_time_ms": 23895.471, "update_time_ms": 32.819, "learner": {"policy_0": {"cur_kl_coeff": 5.488773756701808e-20, "cur_lr": 9.999999747378752e-05, "total_loss": -0.040977947413921356, "policy_loss": -0.040984757244586945, "vf_loss": 6.8162384033203125, "vf_explained_var": 0.1691952645778656, "kl": 0.0028311219066381454, "entropy": 0.1925244778394699, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 632000, "episodes_total": 16951, "training_iteration": 158, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-03-42", "timestamp": 1581505422, "time_this_iter_s": 32.10729718208313, "time_total_s": 4919.459578990936, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4919.459578990936, "timesteps_since_restore": 632000, "iterations_since_restore": 158, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.799999999999983, "episode_len_mean": 36.84403669724771, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.172289156626501}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.587631115844878, "mean_processing_ms": 6.184379848115225, "mean_inference_ms": 0.9986096211674153}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1678976, "num_steps_sampled": 636000, "sample_time_ms": 7340.695, "load_time_ms": 15.511, "grad_time_ms": 23701.76, "update_time_ms": 32.944, "learner": {"policy_0": {"cur_kl_coeff": 2.744386878350904e-20, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03565457835793495, "policy_loss": 0.035647518932819366, "vf_loss": 7.056727886199951, "vf_explained_var": 0.1750347912311554, "kl": 0.004669944755733013, "entropy": 0.21795547008514404, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 636000, "episodes_total": 17060, "training_iteration": 159, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-04-13", "timestamp": 1581505453, "time_this_iter_s": 30.258114337921143, "time_total_s": 4949.717693328857, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f6a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4949.717693328857, "timesteps_since_restore": 636000, "iterations_since_restore": 159, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.186206896551713, "episode_len_mean": 34.922413793103445, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.92584269662921}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.581760686872683, "mean_processing_ms": 6.189506326193152, "mean_inference_ms": 0.9978208757445731}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1689600, "num_steps_sampled": 640000, "sample_time_ms": 7333.896, "load_time_ms": 14.476, "grad_time_ms": 23591.461, "update_time_ms": 33.051, "learner": {"policy_0": {"cur_kl_coeff": 1.372193439175452e-20, "cur_lr": 9.999999747378752e-05, "total_loss": -0.003451929660513997, "policy_loss": -0.003458939492702484, "vf_loss": 7.011070251464844, "vf_explained_var": 0.15110057592391968, "kl": 0.003256219672039151, "entropy": 0.20155444741249084, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 640000, "episodes_total": 17176, "training_iteration": 160, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-04-44", "timestamp": 1581505484, "time_this_iter_s": 30.36691117286682, "time_total_s": 4980.084604501724, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4980.084604501724, "timesteps_since_restore": 640000, "iterations_since_restore": 160, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.507692307692295, "episode_len_mean": 33.914529914529915, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.770140845070419}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5848917187024645, "mean_processing_ms": 6.190471908388072, "mean_inference_ms": 0.9978544290147939}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1700224, "num_steps_sampled": 644000, "sample_time_ms": 7264.018, "load_time_ms": 14.504, "grad_time_ms": 23568.325, "update_time_ms": 32.837, "learner": {"policy_0": {"cur_kl_coeff": 6.86096719587726e-21, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0035931135062128305, "policy_loss": -0.00360029935836792, "vf_loss": 7.18670654296875, "vf_explained_var": 0.15935613214969635, "kl": 0.002438528696075082, "entropy": 0.20108075439929962, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 644000, "episodes_total": 17293, "training_iteration": 161, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-05-14", "timestamp": 1581505514, "time_this_iter_s": 30.49846601486206, "time_total_s": 5010.583070516586, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5010.583070516586, "timesteps_since_restore": 644000, "iterations_since_restore": 161, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.74260869565216, "episode_len_mean": 34.68695652173913, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.846418338108879}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.586541528248809, "mean_processing_ms": 6.206348805735771, "mean_inference_ms": 0.9971222228792032}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1710592, "num_steps_sampled": 648000, "sample_time_ms": 7276.378, "load_time_ms": 15.24, "grad_time_ms": 23483.508, "update_time_ms": 32.569, "learner": {"policy_0": {"cur_kl_coeff": 3.43048359793863e-21, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04902055487036705, "policy_loss": -0.04902692139148712, "vf_loss": 6.366359233856201, "vf_explained_var": 0.1938503235578537, "kl": 0.0025432079564779997, "entropy": 0.1628122627735138, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 648000, "episodes_total": 17408, "training_iteration": 162, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-05-45", "timestamp": 1581505545, "time_this_iter_s": 29.879021167755127, "time_total_s": 5040.462091684341, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5040.462091684341, "timesteps_since_restore": 648000, "iterations_since_restore": 162, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.35471698113206, "episode_len_mean": 37.9811320754717, "episodes_this_iter": 106, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.596784565916394}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.589069576676288, "mean_processing_ms": 6.18706178838904, "mean_inference_ms": 0.9977964965156597}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1721088, "num_steps_sampled": 652000, "sample_time_ms": 7309.188, "load_time_ms": 14.56, "grad_time_ms": 23451.26, "update_time_ms": 32.724, "learner": {"policy_0": {"cur_kl_coeff": 1.715241798969315e-21, "cur_lr": 9.999999747378752e-05, "total_loss": -0.032519370317459106, "policy_loss": -0.03252645209431648, "vf_loss": 7.076786518096924, "vf_explained_var": 0.11255324631929398, "kl": 0.0035428102128207684, "entropy": 0.1836250126361847, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 652000, "episodes_total": 17514, "training_iteration": 163, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-06-15", "timestamp": 1581505575, "time_this_iter_s": 29.992996215820312, "time_total_s": 5070.455087900162, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a8c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5070.455087900162, "timesteps_since_restore": 652000, "iterations_since_restore": 163, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -38.60000000000001, "episode_reward_mean": -18.187499999999982, "episode_len_mean": 36.25, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.921511627906972}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.584155493924909, "mean_processing_ms": 6.216646499196151, "mean_inference_ms": 0.9969975081146923}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1731328, "num_steps_sampled": 656000, "sample_time_ms": 7306.195, "load_time_ms": 14.459, "grad_time_ms": 23256.123, "update_time_ms": 32.327, "learner": {"policy_0": {"cur_kl_coeff": 8.576208994846574e-22, "cur_lr": 9.999999747378752e-05, "total_loss": 0.005423882510513067, "policy_loss": 0.005416390486061573, "vf_loss": 7.487386226654053, "vf_explained_var": 0.111732617020607, "kl": 0.0030908905901014805, "entropy": 0.16580620408058167, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 656000, "episodes_total": 17626, "training_iteration": 164, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-06-45", "timestamp": 1581505605, "time_this_iter_s": 29.651653289794922, "time_total_s": 5100.106741189957, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ceea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5100.106741189957, "timesteps_since_restore": 656000, "iterations_since_restore": 164, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.676785714285703, "episode_len_mean": 34.848214285714285, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.788888888888886}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.570820553553377, "mean_processing_ms": 6.198942897668961, "mean_inference_ms": 0.9973302283759596}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1741696, "num_steps_sampled": 660000, "sample_time_ms": 7317.074, "load_time_ms": 15.179, "grad_time_ms": 23180.664, "update_time_ms": 32.45, "learner": {"policy_0": {"cur_kl_coeff": 4.288104497423287e-22, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0168452225625515, "policy_loss": -0.01685287617146969, "vf_loss": 7.657751083374023, "vf_explained_var": 0.11641879379749298, "kl": 0.0019541869405657053, "entropy": 0.15073683857917786, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 660000, "episodes_total": 17738, "training_iteration": 165, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-07-15", "timestamp": 1581505635, "time_this_iter_s": 30.036267280578613, "time_total_s": 5130.143008470535, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80d08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5130.143008470535, "timesteps_since_restore": 660000, "iterations_since_restore": 165, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.57192982456139, "episode_len_mean": 35.05263157894737, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.944213649851628}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5857901641770695, "mean_processing_ms": 6.202961625563539, "mean_inference_ms": 0.9965517715562705}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1751936, "num_steps_sampled": 664000, "sample_time_ms": 7305.305, "load_time_ms": 14.833, "grad_time_ms": 23035.88, "update_time_ms": 32.118, "learner": {"policy_0": {"cur_kl_coeff": 2.1440522487116436e-22, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02447681874036789, "policy_loss": -0.02448362670838833, "vf_loss": 6.808374881744385, "vf_explained_var": 0.13137073814868927, "kl": 0.0016174155753105879, "entropy": 0.15621209144592285, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 664000, "episodes_total": 17852, "training_iteration": 166, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-07-46", "timestamp": 1581505666, "time_this_iter_s": 30.534366607666016, "time_total_s": 5160.677375078201, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57dc80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5160.677375078201, "timesteps_since_restore": 664000, "iterations_since_restore": 166, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.74434782608694, "episode_len_mean": 35.63478260869565, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.931976744186043}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.578896470998034, "mean_processing_ms": 6.215179709756943, "mean_inference_ms": 0.995929458140419}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1762176, "num_steps_sampled": 668000, "sample_time_ms": 7341.192, "load_time_ms": 14.718, "grad_time_ms": 22900.834, "update_time_ms": 31.958, "learner": {"policy_0": {"cur_kl_coeff": 1.0720261243558218e-22, "cur_lr": 9.999999747378752e-05, "total_loss": -0.029341310262680054, "policy_loss": -0.029347628355026245, "vf_loss": 6.325545310974121, "vf_explained_var": 0.13692606985569, "kl": 0.002060538623481989, "entropy": 0.15904590487480164, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 668000, "episodes_total": 17967, "training_iteration": 167, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-08-15", "timestamp": 1581505695, "time_this_iter_s": 29.725017547607422, "time_total_s": 5190.402392625809, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201cc80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5190.402392625809, "timesteps_since_restore": 668000, "iterations_since_restore": 167, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.05849056603772, "episode_len_mean": 37.283018867924525, "episodes_this_iter": 106, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.273913043478257}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.57850360587515, "mean_processing_ms": 6.2128685003719895, "mean_inference_ms": 0.9970674181592873}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1772544, "num_steps_sampled": 672000, "sample_time_ms": 7262.192, "load_time_ms": 15.892, "grad_time_ms": 22795.37, "update_time_ms": 31.664, "learner": {"policy_0": {"cur_kl_coeff": 5.360130621779109e-23, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04466486722230911, "policy_loss": -0.04467150196433067, "vf_loss": 6.6397576332092285, "vf_explained_var": 0.16727136075496674, "kl": 0.002815845189616084, "entropy": 0.14716829359531403, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 672000, "episodes_total": 18073, "training_iteration": 168, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-08-46", "timestamp": 1581505726, "time_this_iter_s": 30.27311897277832, "time_total_s": 5220.675511598587, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5220.675511598587, "timesteps_since_restore": 672000, "iterations_since_restore": 168, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.212389380530954, "episode_len_mean": 35.04424778761062, "episodes_this_iter": 113, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.788690476190472}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.571484343322474, "mean_processing_ms": 6.212861968365489, "mean_inference_ms": 0.9967599688802471}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1782528, "num_steps_sampled": 676000, "sample_time_ms": 7249.183, "load_time_ms": 15.387, "grad_time_ms": 22702.945, "update_time_ms": 31.399, "learner": {"policy_0": {"cur_kl_coeff": 2.6800653108895545e-23, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03827691823244095, "policy_loss": -0.0382835753262043, "vf_loss": 6.660146236419678, "vf_explained_var": 0.1522650271654129, "kl": 0.0028200058732181787, "entropy": 0.1364416927099228, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 676000, "episodes_total": 18186, "training_iteration": 169, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-09-15", "timestamp": 1581505755, "time_this_iter_s": 29.195172548294067, "time_total_s": 5249.870684146881, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac36a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5249.870684146881, "timesteps_since_restore": 676000, "iterations_since_restore": 169, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.646031746031731, "episode_len_mean": 32.45238095238095, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.243085106382975}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.571040057750824, "mean_processing_ms": 6.2015884224125655, "mean_inference_ms": 0.9969453044161664}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1792512, "num_steps_sampled": 680000, "sample_time_ms": 7293.589, "load_time_ms": 15.148, "grad_time_ms": 22582.807, "update_time_ms": 31.289, "learner": {"policy_0": {"cur_kl_coeff": 1.3400326554447773e-23, "cur_lr": 9.999999747378752e-05, "total_loss": 0.010161416605114937, "policy_loss": 0.010154841467738152, "vf_loss": 6.575225830078125, "vf_explained_var": 0.18573004007339478, "kl": 0.0023911965545266867, "entropy": 0.1423574835062027, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 680000, "episodes_total": 18312, "training_iteration": 170, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-09-45", "timestamp": 1581505785, "time_this_iter_s": 29.60576367378235, "time_total_s": 5279.476447820663, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3e18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5279.476447820663, "timesteps_since_restore": 680000, "iterations_since_restore": 170, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.065454545454532, "episode_len_mean": 35.40909090909091, "episodes_this_iter": 110, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.095705521472388}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.570120843046317, "mean_processing_ms": 6.207283210126721, "mean_inference_ms": 0.9966857772764321}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1803008, "num_steps_sampled": 684000, "sample_time_ms": 7247.854, "load_time_ms": 14.943, "grad_time_ms": 22558.964, "update_time_ms": 31.482, "learner": {"policy_0": {"cur_kl_coeff": 6.700163277223886e-24, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0029434834141284227, "policy_loss": -0.0029504422564059496, "vf_loss": 6.9551777839660645, "vf_explained_var": 0.16732537746429443, "kl": 0.001935539417900145, "entropy": 0.1371331512928009, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 684000, "episodes_total": 18422, "training_iteration": 171, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-10-15", "timestamp": 1581505815, "time_this_iter_s": 29.80225110054016, "time_total_s": 5309.278698921204, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387ea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5309.278698921204, "timesteps_since_restore": 684000, "iterations_since_restore": 171, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.86999999999999, "episode_len_mean": 33.016666666666666, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.718644067796607}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5713018891522035, "mean_processing_ms": 6.220092671584814, "mean_inference_ms": 0.9961127402924883}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1813376, "num_steps_sampled": 688000, "sample_time_ms": 7306.516, "load_time_ms": 14.898, "grad_time_ms": 22561.563, "update_time_ms": 31.402, "learner": {"policy_0": {"cur_kl_coeff": 3.350081638611943e-24, "cur_lr": 9.999999747378752e-05, "total_loss": -0.026452267542481422, "policy_loss": -0.02645854279398918, "vf_loss": 6.279605388641357, "vf_explained_var": 0.21940037608146667, "kl": 0.00335549283772707, "entropy": 0.15928266942501068, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 688000, "episodes_total": 18542, "training_iteration": 172, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-10-46", "timestamp": 1581505846, "time_this_iter_s": 30.49031400680542, "time_total_s": 5339.769012928009, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201cd90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5339.769012928009, "timesteps_since_restore": 688000, "iterations_since_restore": 172, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.749122807017528, "episode_len_mean": 35.24561403508772, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.881976744186042}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.570617472172007, "mean_processing_ms": 6.224626171732469, "mean_inference_ms": 0.9957406755108855}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1823616, "num_steps_sampled": 692000, "sample_time_ms": 7363.322, "load_time_ms": 14.736, "grad_time_ms": 22502.653, "update_time_ms": 31.147, "learner": {"policy_0": {"cur_kl_coeff": 1.6750408193059716e-24, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01747017167508602, "policy_loss": -0.017477039247751236, "vf_loss": 6.860052585601807, "vf_explained_var": 0.1953173726797104, "kl": 0.002546441275626421, "entropy": 0.13263574242591858, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 692000, "episodes_total": 18656, "training_iteration": 173, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-11-16", "timestamp": 1581505876, "time_this_iter_s": 29.967970609664917, "time_total_s": 5369.736983537674, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5369.736983537674, "timesteps_since_restore": 692000, "iterations_since_restore": 173, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.87199999999999, "episode_len_mean": 32.96, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.609042553191486}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.57525944520683, "mean_processing_ms": 6.213014685491997, "mean_inference_ms": 0.997139278765096}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1834112, "num_steps_sampled": 696000, "sample_time_ms": 7411.182, "load_time_ms": 14.654, "grad_time_ms": 22572.348, "update_time_ms": 31.6, "learner": {"policy_0": {"cur_kl_coeff": 8.375204096529858e-25, "cur_lr": 9.999999747378752e-05, "total_loss": -0.019457271322607994, "policy_loss": -0.019463926553726196, "vf_loss": 6.657564640045166, "vf_explained_var": 0.1562216877937317, "kl": 0.002832271158695221, "entropy": 0.18265332281589508, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 696000, "episodes_total": 18781, "training_iteration": 174, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-11-47", "timestamp": 1581505907, "time_this_iter_s": 30.82978582382202, "time_total_s": 5400.566769361496, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80bf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5400.566769361496, "timesteps_since_restore": 696000, "iterations_since_restore": 174, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.917117117117108, "episode_len_mean": 35.44144144144144, "episodes_this_iter": 111, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.026666666666662}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.568815734960259, "mean_processing_ms": 6.206164743616328, "mean_inference_ms": 0.9972143949636342}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1844352, "num_steps_sampled": 700000, "sample_time_ms": 7473.707, "load_time_ms": 14.816, "grad_time_ms": 22525.989, "update_time_ms": 31.442, "learner": {"policy_0": {"cur_kl_coeff": 4.187602048264929e-25, "cur_lr": 9.999999747378752e-05, "total_loss": 0.012207115069031715, "policy_loss": 0.01220021490007639, "vf_loss": 6.904238700866699, "vf_explained_var": 0.17920562624931335, "kl": 0.004049686249345541, "entropy": 0.12542888522148132, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 700000, "episodes_total": 18892, "training_iteration": 175, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-12-18", "timestamp": 1581505938, "time_this_iter_s": 30.1981360912323, "time_total_s": 5430.764905452728, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264ea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5430.764905452728, "timesteps_since_restore": 700000, "iterations_since_restore": 175, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.216528925619826, "episode_len_mean": 33.396694214876035, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.7866666666666635}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.584203947169877, "mean_processing_ms": 6.217707594093201, "mean_inference_ms": 0.9964623410530058}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1855104, "num_steps_sampled": 704000, "sample_time_ms": 7430.068, "load_time_ms": 14.601, "grad_time_ms": 22668.914, "update_time_ms": 32.036, "learner": {"policy_0": {"cur_kl_coeff": 2.0938010241324645e-25, "cur_lr": 9.999999747378752e-05, "total_loss": -0.039865441620349884, "policy_loss": -0.03987225145101547, "vf_loss": 6.811797142028809, "vf_explained_var": 0.17241165041923523, "kl": 0.0021742170210927725, "entropy": 0.14061623811721802, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 704000, "episodes_total": 19013, "training_iteration": 176, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-12-50", "timestamp": 1581505970, "time_this_iter_s": 31.53335952758789, "time_total_s": 5462.298264980316, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff2b5b51a60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5462.298264980316, "timesteps_since_restore": 704000, "iterations_since_restore": 176, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.96315789473683, "episode_len_mean": 34.10526315789474, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.704424778761058}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.566899963266662, "mean_processing_ms": 6.221704491354945, "mean_inference_ms": 0.9960656475525681}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1865216, "num_steps_sampled": 708000, "sample_time_ms": 7399.891, "load_time_ms": 14.586, "grad_time_ms": 22654.153, "update_time_ms": 32.17, "learner": {"policy_0": {"cur_kl_coeff": 1.0469005120662322e-25, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013734085485339165, "policy_loss": 0.013727626763284206, "vf_loss": 6.457553863525391, "vf_explained_var": 0.2082604318857193, "kl": 0.0026385230012238026, "entropy": 0.1126895472407341, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 708000, "episodes_total": 19127, "training_iteration": 177, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-13-19", "timestamp": 1581505999, "time_this_iter_s": 29.27799081802368, "time_total_s": 5491.57625579834, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292ab70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5491.57625579834, "timesteps_since_restore": 708000, "iterations_since_restore": 177, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.506870229007621, "episode_len_mean": 31.16030534351145, "episodes_this_iter": 131, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.129797979797977}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.57844571704611, "mean_processing_ms": 6.220545357196483, "mean_inference_ms": 0.9966546648624187}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1875456, "num_steps_sampled": 712000, "sample_time_ms": 7394.344, "load_time_ms": 14.138, "grad_time_ms": 22636.388, "update_time_ms": 32.737, "learner": {"policy_0": {"cur_kl_coeff": 5.234502560331161e-26, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03606685623526573, "policy_loss": -0.03607308119535446, "vf_loss": 6.225777626037598, "vf_explained_var": 0.20503120124340057, "kl": 0.002023087115958333, "entropy": 0.10207168757915497, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 712000, "episodes_total": 19258, "training_iteration": 178, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-13-49", "timestamp": 1581506029, "time_this_iter_s": 30.040233612060547, "time_total_s": 5521.6164894104, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244fae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5521.6164894104, "timesteps_since_restore": 712000, "iterations_since_restore": 178, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.974242424242416, "episode_len_mean": 30.28787878787879, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.160835509138378}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.572479983489742, "mean_processing_ms": 6.229717498358308, "mean_inference_ms": 0.9969531600379109}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1885696, "num_steps_sampled": 716000, "sample_time_ms": 7459.315, "load_time_ms": 14.256, "grad_time_ms": 22685.027, "update_time_ms": 32.865, "learner": {"policy_0": {"cur_kl_coeff": 2.6172512801655806e-26, "cur_lr": 9.999999747378752e-05, "total_loss": -0.042711228132247925, "policy_loss": -0.042717572301626205, "vf_loss": 6.34451961517334, "vf_explained_var": 0.18175005912780762, "kl": 0.0022535836324095726, "entropy": 0.10765597969293594, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 716000, "episodes_total": 19390, "training_iteration": 179, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-14-20", "timestamp": 1581506060, "time_this_iter_s": 30.334367990493774, "time_total_s": 5551.950857400894, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5551.950857400894, "timesteps_since_restore": 716000, "iterations_since_restore": 179, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.96724137931033, "episode_len_mean": 34.8448275862069, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.887570621468924}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.583108973490038, "mean_processing_ms": 6.2346160118620055, "mean_inference_ms": 0.9965082978900033}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1896320, "num_steps_sampled": 720000, "sample_time_ms": 7412.604, "load_time_ms": 14.551, "grad_time_ms": 22814.916, "update_time_ms": 32.757, "learner": {"policy_0": {"cur_kl_coeff": 1.3086256400827903e-26, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02283320017158985, "policy_loss": -0.022839756682515144, "vf_loss": 6.5579423904418945, "vf_explained_var": 0.18530836701393127, "kl": 0.0020752400159835815, "entropy": 0.11849750578403473, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 720000, "episodes_total": 19506, "training_iteration": 180, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-14-51", "timestamp": 1581506091, "time_this_iter_s": 30.440533876419067, "time_total_s": 5582.391391277313, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d0d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5582.391391277313, "timesteps_since_restore": 720000, "iterations_since_restore": 180, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.38888888888888, "episode_len_mean": 32.07142857142857, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.521390374331548}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.572400107486755, "mean_processing_ms": 6.239215105272331, "mean_inference_ms": 0.9962093832822978}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1906688, "num_steps_sampled": 724000, "sample_time_ms": 7437.151, "load_time_ms": 14.991, "grad_time_ms": 22797.214, "update_time_ms": 32.587, "learner": {"policy_0": {"cur_kl_coeff": 6.543128200413951e-27, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00904275942593813, "policy_loss": -0.009049701504409313, "vf_loss": 6.94276237487793, "vf_explained_var": 0.18173997104167938, "kl": 0.002550352131947875, "entropy": 0.09967588633298874, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 724000, "episodes_total": 19632, "training_iteration": 181, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-15-21", "timestamp": 1581506121, "time_this_iter_s": 29.8737530708313, "time_total_s": 5612.2651443481445, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5612.2651443481445, "timesteps_since_restore": 724000, "iterations_since_restore": 181, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.812068965517227, "episode_len_mean": 33.672413793103445, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.587965616045842}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.575274159221341, "mean_processing_ms": 6.2433051943376965, "mean_inference_ms": 0.9954663872131234}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1917056, "num_steps_sampled": 728000, "sample_time_ms": 7443.668, "load_time_ms": 14.369, "grad_time_ms": 22797.475, "update_time_ms": 32.913, "learner": {"policy_0": {"cur_kl_coeff": 3.271564100206976e-27, "cur_lr": 9.999999747378752e-05, "total_loss": -0.003174802288413048, "policy_loss": -0.003181811422109604, "vf_loss": 7.007569313049316, "vf_explained_var": 0.17771027982234955, "kl": 0.00540827214717865, "entropy": 0.12208311259746552, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 728000, "episodes_total": 19748, "training_iteration": 182, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-15-52", "timestamp": 1581506152, "time_this_iter_s": 30.554261207580566, "time_total_s": 5642.819405555725, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5642.819405555725, "timesteps_since_restore": 728000, "iterations_since_restore": 182, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.44727272727272, "episode_len_mean": 35.43636363636364, "episodes_this_iter": 110, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.075449101796403}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5779020929455125, "mean_processing_ms": 6.240887893537094, "mean_inference_ms": 0.9962537151143941}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1927680, "num_steps_sampled": 732000, "sample_time_ms": 7464.506, "load_time_ms": 14.532, "grad_time_ms": 22877.087, "update_time_ms": 33.478, "learner": {"policy_0": {"cur_kl_coeff": 3.271564100206976e-27, "cur_lr": 9.999999747378752e-05, "total_loss": -0.012239246629178524, "policy_loss": -0.012246308848261833, "vf_loss": 7.0714287757873535, "vf_explained_var": 0.1741255521774292, "kl": 0.0018621977651491761, "entropy": 0.1318538635969162, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 732000, "episodes_total": 19858, "training_iteration": 183, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-16-23", "timestamp": 1581506183, "time_this_iter_s": 30.981479167938232, "time_total_s": 5673.800884723663, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b3872f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5673.800884723663, "timesteps_since_restore": 732000, "iterations_since_restore": 183, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.758260869565206, "episode_len_mean": 34.88695652173913, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.818233618233615}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5754084911119675, "mean_processing_ms": 6.248755208248538, "mean_inference_ms": 0.9953923614072953}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1938176, "num_steps_sampled": 736000, "sample_time_ms": 7471.102, "load_time_ms": 15.397, "grad_time_ms": 22867.411, "update_time_ms": 33.518, "learner": {"policy_0": {"cur_kl_coeff": 1.635782050103488e-27, "cur_lr": 9.999999747378752e-05, "total_loss": 0.028126588091254234, "policy_loss": 0.028119593858718872, "vf_loss": 6.994522571563721, "vf_explained_var": 0.21689718961715698, "kl": 0.006422986276447773, "entropy": 0.1457473486661911, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 736000, "episodes_total": 19973, "training_iteration": 184, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-16-54", "timestamp": 1581506214, "time_this_iter_s": 30.80750823020935, "time_total_s": 5704.608392953873, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5704.608392953873, "timesteps_since_restore": 736000, "iterations_since_restore": 184, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.241025641025633, "episode_len_mean": 35.427350427350426, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.028813559322031}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5820863624699, "mean_processing_ms": 6.230692181718859, "mean_inference_ms": 0.9966209626764203}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1948672, "num_steps_sampled": 740000, "sample_time_ms": 7393.656, "load_time_ms": 14.613, "grad_time_ms": 22935.348, "update_time_ms": 33.433, "learner": {"policy_0": {"cur_kl_coeff": 1.635782050103488e-27, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0239756740629673, "policy_loss": 0.023968752473592758, "vf_loss": 6.924982070922852, "vf_explained_var": 0.14870890974998474, "kl": 0.0021831088233739138, "entropy": 0.09505052119493484, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 740000, "episodes_total": 20090, "training_iteration": 185, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-17-24", "timestamp": 1581506244, "time_this_iter_s": 30.097063302993774, "time_total_s": 5734.7054562568665, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57db70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5734.7054562568665, "timesteps_since_restore": 740000, "iterations_since_restore": 185, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.11272727272726, "episode_len_mean": 35.80909090909091, "episodes_this_iter": 110, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.96526946107784}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.577530090519707, "mean_processing_ms": 6.24351932191839, "mean_inference_ms": 0.9958338387276636}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1958912, "num_steps_sampled": 744000, "sample_time_ms": 7362.294, "load_time_ms": 14.407, "grad_time_ms": 22829.013, "update_time_ms": 33.3, "learner": {"policy_0": {"cur_kl_coeff": 8.17891025051744e-28, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01961272582411766, "policy_loss": 0.019605791196227074, "vf_loss": 6.933901786804199, "vf_explained_var": 0.14004382491111755, "kl": 0.0014748654793947935, "entropy": 0.09594102948904037, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 744000, "episodes_total": 20200, "training_iteration": 186, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-17-54", "timestamp": 1581506274, "time_this_iter_s": 30.150766849517822, "time_total_s": 5764.856223106384, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5764.856223106384, "timesteps_since_restore": 744000, "iterations_since_restore": 186, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.454700854700842, "episode_len_mean": 34.2991452991453, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.641436464088393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.564066486143013, "mean_processing_ms": 6.243240092244254, "mean_inference_ms": 0.9954589264903897}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1969408, "num_steps_sampled": 748000, "sample_time_ms": 7390.157, "load_time_ms": 15.094, "grad_time_ms": 22934.818, "update_time_ms": 33.066, "learner": {"policy_0": {"cur_kl_coeff": 4.08945512525872e-28, "cur_lr": 9.999999747378752e-05, "total_loss": 0.08213144540786743, "policy_loss": 0.08212428539991379, "vf_loss": 7.159419536590576, "vf_explained_var": 0.16997049748897552, "kl": 0.0029903100803494453, "entropy": 0.1474582403898239, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 748000, "episodes_total": 20317, "training_iteration": 187, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-18-25", "timestamp": 1581506305, "time_this_iter_s": 30.618074893951416, "time_total_s": 5795.474298000336, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5795.474298000336, "timesteps_since_restore": 748000, "iterations_since_restore": 187, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.077777777777758, "episode_len_mean": 37.833333333333336, "episodes_this_iter": 108, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.168862275449096}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.575686680809498, "mean_processing_ms": 6.242571570655124, "mean_inference_ms": 0.9954750629929379}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1979776, "num_steps_sampled": 752000, "sample_time_ms": 7317.252, "load_time_ms": 14.39, "grad_time_ms": 22970.257, "update_time_ms": 32.731, "learner": {"policy_0": {"cur_kl_coeff": 2.04472756262936e-28, "cur_lr": 9.999999747378752e-05, "total_loss": -0.010713287629187107, "policy_loss": -0.010720382444560528, "vf_loss": 7.088972568511963, "vf_explained_var": 0.10908865183591843, "kl": 0.02722940407693386, "entropy": 0.20598489046096802, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 752000, "episodes_total": 20425, "training_iteration": 188, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-18-55", "timestamp": 1581506335, "time_this_iter_s": 29.655408143997192, "time_total_s": 5825.129706144333, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292aae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5825.129706144333, "timesteps_since_restore": 752000, "iterations_since_restore": 188, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.5663551401869, "episode_len_mean": 36.12149532710281, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.983734939759032}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.561853868482643, "mean_processing_ms": 6.232875118626405, "mean_inference_ms": 0.9956737925162604}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1990272, "num_steps_sampled": 756000, "sample_time_ms": 7238.166, "load_time_ms": 14.135, "grad_time_ms": 23036.502, "update_time_ms": 32.665, "learner": {"policy_0": {"cur_kl_coeff": 3.0670911032027967e-28, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014205961488187313, "policy_loss": 0.014199156314134598, "vf_loss": 6.8134989738464355, "vf_explained_var": 0.10355166345834732, "kl": 0.003769249189645052, "entropy": 0.14964145421981812, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 756000, "episodes_total": 20532, "training_iteration": 189, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-19-26", "timestamp": 1581506366, "time_this_iter_s": 30.20260500907898, "time_total_s": 5855.332311153412, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5855.332311153412, "timesteps_since_restore": 756000, "iterations_since_restore": 189, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.403669724770623, "episode_len_mean": 36.89908256880734, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.02402402402402}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.561617618089538, "mean_processing_ms": 6.242601310769016, "mean_inference_ms": 0.9948697375096536}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2000512, "num_steps_sampled": 760000, "sample_time_ms": 7173.105, "load_time_ms": 13.965, "grad_time_ms": 22960.714, "update_time_ms": 32.918, "learner": {"policy_0": {"cur_kl_coeff": 1.5335455516013983e-28, "cur_lr": 9.999999747378752e-05, "total_loss": -0.037882979959249496, "policy_loss": -0.037889860570430756, "vf_loss": 6.879052639007568, "vf_explained_var": 0.13566914200782776, "kl": 0.0025651135947555304, "entropy": 0.11528301239013672, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 760000, "episodes_total": 20641, "training_iteration": 190, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-19-55", "timestamp": 1581506395, "time_this_iter_s": 29.031983852386475, "time_total_s": 5884.364295005798, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3452642f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5884.364295005798, "timesteps_since_restore": 760000, "iterations_since_restore": 190, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.330841121495304, "episode_len_mean": 37.4392523364486, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.035076923076918}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.560951809913285, "mean_processing_ms": 6.2382586401861735, "mean_inference_ms": 0.9947620712001668}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2010496, "num_steps_sampled": 764000, "sample_time_ms": 7145.744, "load_time_ms": 13.923, "grad_time_ms": 22871.801, "update_time_ms": 33.02, "learner": {"policy_0": {"cur_kl_coeff": 7.667727758006992e-29, "cur_lr": 9.999999747378752e-05, "total_loss": -0.015086626634001732, "policy_loss": -0.015093435533344746, "vf_loss": 6.808204650878906, "vf_explained_var": 0.13669268786907196, "kl": 0.0031153440941125154, "entropy": 0.13244612514972687, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 764000, "episodes_total": 20748, "training_iteration": 191, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-20-24", "timestamp": 1581506424, "time_this_iter_s": 28.71165633201599, "time_total_s": 5913.075951337814, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd6a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5913.075951337814, "timesteps_since_restore": 764000, "iterations_since_restore": 191, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.862135922330083, "episode_len_mean": 38.89320388349515, "episodes_this_iter": 103, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.275460122699381}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.564956826485392, "mean_processing_ms": 6.245885256974863, "mean_inference_ms": 0.9943662192198163}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2020992, "num_steps_sampled": 768000, "sample_time_ms": 7020.336, "load_time_ms": 13.798, "grad_time_ms": 22903.412, "update_time_ms": 32.929, "learner": {"policy_0": {"cur_kl_coeff": 3.833863879003496e-29, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004484593402594328, "policy_loss": -0.004491861443966627, "vf_loss": 7.271439075469971, "vf_explained_var": 0.13539046049118042, "kl": 0.0017276019789278507, "entropy": 0.11327488720417023, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 768000, "episodes_total": 20851, "training_iteration": 192, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-20-54", "timestamp": 1581506454, "time_this_iter_s": 29.614050149917603, "time_total_s": 5942.690001487732, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80ea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5942.690001487732, "timesteps_since_restore": 768000, "iterations_since_restore": 192, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.39099099099097, "episode_len_mean": 36.072072072072075, "episodes_this_iter": 111, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.866091954022985}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.555799010496051, "mean_processing_ms": 6.222759654920108, "mean_inference_ms": 0.995363183494531}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2031360, "num_steps_sampled": 772000, "sample_time_ms": 6929.626, "load_time_ms": 13.569, "grad_time_ms": 22841.221, "update_time_ms": 32.256, "learner": {"policy_0": {"cur_kl_coeff": 1.916931939501748e-29, "cur_lr": 9.999999747378752e-05, "total_loss": -0.052399929612874985, "policy_loss": -0.052406612783670425, "vf_loss": 6.684625148773193, "vf_explained_var": 0.14015619456768036, "kl": 0.0025115886237472296, "entropy": 0.11796282231807709, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 772000, "episodes_total": 20962, "training_iteration": 193, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-21-23", "timestamp": 1581506483, "time_this_iter_s": 29.445624113082886, "time_total_s": 5972.135625600815, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201ce18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5972.135625600815, "timesteps_since_restore": 772000, "iterations_since_restore": 193, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.15087719298244, "episode_len_mean": 35.64912280701754, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.085882352941173}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.562295041950424, "mean_processing_ms": 6.23352178017687, "mean_inference_ms": 0.9946626452515125}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2041728, "num_steps_sampled": 776000, "sample_time_ms": 6899.307, "load_time_ms": 13.82, "grad_time_ms": 22777.243, "update_time_ms": 32.289, "learner": {"policy_0": {"cur_kl_coeff": 9.58465969750874e-30, "cur_lr": 9.999999747378752e-05, "total_loss": -0.021134085953235626, "policy_loss": -0.02114073373377323, "vf_loss": 6.646134853363037, "vf_explained_var": 0.15492093563079834, "kl": 0.0038390906993299723, "entropy": 0.12259181588888168, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 776000, "episodes_total": 21076, "training_iteration": 194, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-21-53", "timestamp": 1581506513, "time_this_iter_s": 29.86815619468689, "time_total_s": 6002.003781795502, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6002.003781795502, "timesteps_since_restore": 776000, "iterations_since_restore": 194, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.599999999999994, "episode_len_mean": 34.79824561403509, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.97295774647887}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.559329387998553, "mean_processing_ms": 6.240206098010649, "mean_inference_ms": 0.9941624182863658}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2052736, "num_steps_sampled": 780000, "sample_time_ms": 6909.326, "load_time_ms": 13.872, "grad_time_ms": 22905.955, "update_time_ms": 32.423, "learner": {"policy_0": {"cur_kl_coeff": 4.79232984875437e-30, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013945141807198524, "policy_loss": 0.013937924057245255, "vf_loss": 7.221687316894531, "vf_explained_var": 0.1350301057100296, "kl": 0.0034274940844625235, "entropy": 0.15073427557945251, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 780000, "episodes_total": 21190, "training_iteration": 195, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-22-25", "timestamp": 1581506545, "time_this_iter_s": 31.48464798927307, "time_total_s": 6033.488429784775, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b3870d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6033.488429784775, "timesteps_since_restore": 780000, "iterations_since_restore": 195, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.219130434782596, "episode_len_mean": 34.00869565217391, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.500555555555552}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.56222200432459, "mean_processing_ms": 6.233428893644642, "mean_inference_ms": 0.994827074320009}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2063104, "num_steps_sampled": 784000, "sample_time_ms": 6904.204, "load_time_ms": 13.895, "grad_time_ms": 22886.153, "update_time_ms": 32.335, "learner": {"policy_0": {"cur_kl_coeff": 2.396164924377185e-30, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0011909964960068464, "policy_loss": -0.0011978473048657179, "vf_loss": 6.847139358520508, "vf_explained_var": 0.19471395015716553, "kl": 0.011301839724183083, "entropy": 0.16239617764949799, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 784000, "episodes_total": 21305, "training_iteration": 196, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-22-56", "timestamp": 1581506576, "time_this_iter_s": 29.90145778656006, "time_total_s": 6063.389887571335, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff2b5b5e1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6063.389887571335, "timesteps_since_restore": 784000, "iterations_since_restore": 196, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.825862068965506, "episode_len_mean": 34.491379310344826, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.66520547945205}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.565268738892606, "mean_processing_ms": 6.257925754984537, "mean_inference_ms": 0.9945474634102875}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2073856, "num_steps_sampled": 788000, "sample_time_ms": 6953.34, "load_time_ms": 13.958, "grad_time_ms": 22938.251, "update_time_ms": 32.887, "learner": {"policy_0": {"cur_kl_coeff": 2.396164924377185e-30, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03988977521657944, "policy_loss": -0.03989702835679054, "vf_loss": 7.256032466888428, "vf_explained_var": 0.15971925854682922, "kl": 0.003582024946808815, "entropy": 0.15056036412715912, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 788000, "episodes_total": 21421, "training_iteration": 197, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-23-27", "timestamp": 1581506607, "time_this_iter_s": 31.637135982513428, "time_total_s": 6095.027023553848, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c7b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6095.027023553848, "timesteps_since_restore": 788000, "iterations_since_restore": 197, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.77096774193547, "episode_len_mean": 33.13709677419355, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.545599999999998}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.565990452012252, "mean_processing_ms": 6.256375094605229, "mean_inference_ms": 0.9944164168432016}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2084224, "num_steps_sampled": 792000, "sample_time_ms": 6991.798, "load_time_ms": 13.983, "grad_time_ms": 22927.938, "update_time_ms": 32.548, "learner": {"policy_0": {"cur_kl_coeff": 1.1980824621885925e-30, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014045768417418003, "policy_loss": 0.014038792811334133, "vf_loss": 6.973302841186523, "vf_explained_var": 0.1894543170928955, "kl": 0.001876001013442874, "entropy": 0.12342546135187149, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 792000, "episodes_total": 21545, "training_iteration": 198, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-23-58", "timestamp": 1581506638, "time_this_iter_s": 29.93367648124695, "time_total_s": 6124.960700035095, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6124.960700035095, "timesteps_since_restore": 792000, "iterations_since_restore": 198, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.971666666666653, "episode_len_mean": 33.325, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.373614775725591}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.561301116273394, "mean_processing_ms": 6.237479483060393, "mean_inference_ms": 0.9949558823552356}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2094720, "num_steps_sampled": 796000, "sample_time_ms": 7066.05, "load_time_ms": 13.94, "grad_time_ms": 22918.346, "update_time_ms": 32.435, "learner": {"policy_0": {"cur_kl_coeff": 5.990412310942962e-31, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02366013452410698, "policy_loss": 0.023653319105505943, "vf_loss": 6.8131279945373535, "vf_explained_var": 0.19208842515945435, "kl": 0.002051540883257985, "entropy": 0.11037901043891907, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 796000, "episodes_total": 21665, "training_iteration": 199, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-24-29", "timestamp": 1581506669, "time_this_iter_s": 30.84938883781433, "time_total_s": 6155.81008887291, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6155.81008887291, "timesteps_since_restore": 796000, "iterations_since_restore": 199, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -39.000000000000014, "episode_reward_mean": -15.43519999999998, "episode_len_mean": 31.84, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -4.921938775510202}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.565112144531406, "mean_processing_ms": 6.244272724356665, "mean_inference_ms": 0.9947029663925182}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2104832, "num_steps_sampled": 800000, "sample_time_ms": 7185.013, "load_time_ms": 14.501, "grad_time_ms": 22880.316, "update_time_ms": 32.034, "learner": {"policy_0": {"cur_kl_coeff": 2.995206155471481e-31, "cur_lr": 9.999999747378752e-05, "total_loss": -0.014653442427515984, "policy_loss": -0.014660115353763103, "vf_loss": 6.678003787994385, "vf_explained_var": 0.17250917851924896, "kl": 0.002576942555606365, "entropy": 0.11455900222063065, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 800000, "episodes_total": 21790, "training_iteration": 200, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-24-59", "timestamp": 1581506699, "time_this_iter_s": 29.845901489257812, "time_total_s": 6185.655990362167, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8956a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6185.655990362167, "timesteps_since_restore": 800000, "iterations_since_restore": 200, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.115596330275217, "episode_len_mean": 36.39449541284404, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.039420289855069}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.56650225812422, "mean_processing_ms": 6.249427932521974, "mean_inference_ms": 0.9938867289488348}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2115584, "num_steps_sampled": 804000, "sample_time_ms": 7179.442, "load_time_ms": 14.082, "grad_time_ms": 23059.381, "update_time_ms": 31.557, "learner": {"policy_0": {"cur_kl_coeff": 1.4976030777357406e-31, "cur_lr": 9.999999747378752e-05, "total_loss": -0.020314883440732956, "policy_loss": -0.02032182365655899, "vf_loss": 6.941290855407715, "vf_explained_var": 0.162738636136055, "kl": 0.0025644947309046984, "entropy": 0.13563930988311768, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 804000, "episodes_total": 21899, "training_iteration": 201, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-25-29", "timestamp": 1581506729, "time_this_iter_s": 30.43801736831665, "time_total_s": 6216.094007730484, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f7b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6216.094007730484, "timesteps_since_restore": 804000, "iterations_since_restore": 201, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.362393162393158, "episode_len_mean": 33.717948717948715, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.967777777777773}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.559928075139599, "mean_processing_ms": 6.263637444627962, "mean_inference_ms": 0.9935900770576588}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2126720, "num_steps_sampled": 808000, "sample_time_ms": 7226.63, "load_time_ms": 14.084, "grad_time_ms": 23182.86, "update_time_ms": 31.569, "learner": {"policy_0": {"cur_kl_coeff": 7.488015388678703e-32, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0058378856629133224, "policy_loss": -0.005844853352755308, "vf_loss": 6.969302654266357, "vf_explained_var": 0.18559712171554565, "kl": 0.006971822585910559, "entropy": 0.15097923576831818, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 808000, "episodes_total": 22016, "training_iteration": 202, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-26-01", "timestamp": 1581506761, "time_this_iter_s": 31.320441484451294, "time_total_s": 6247.414449214935, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6247.414449214935, "timesteps_since_restore": 808000, "iterations_since_restore": 202, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.370434782608683, "episode_len_mean": 34.89565217391304, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.984702549575067}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5608838512462935, "mean_processing_ms": 6.258613207237498, "mean_inference_ms": 0.9938049704441964}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2137472, "num_steps_sampled": 812000, "sample_time_ms": 7272.221, "load_time_ms": 15.339, "grad_time_ms": 23285.583, "update_time_ms": 32.251, "learner": {"policy_0": {"cur_kl_coeff": 7.488015388678703e-32, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011953296139836311, "policy_loss": -0.011960259638726711, "vf_loss": 6.958887100219727, "vf_explained_var": 0.12414180487394333, "kl": 0.003755528712645173, "entropy": 0.1424640417098999, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 812000, "episodes_total": 22131, "training_iteration": 203, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-26-32", "timestamp": 1581506792, "time_this_iter_s": 30.943257331848145, "time_total_s": 6278.357706546783, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6278.357706546783, "timesteps_since_restore": 812000, "iterations_since_restore": 203, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.168067226890738, "episode_len_mean": 33.99159663865546, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.566757493188007}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.558044951345474, "mean_processing_ms": 6.2517054182915235, "mean_inference_ms": 0.9941634092846746}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2147840, "num_steps_sampled": 816000, "sample_time_ms": 7270.698, "load_time_ms": 14.287, "grad_time_ms": 23321.832, "update_time_ms": 32.111, "learner": {"policy_0": {"cur_kl_coeff": 3.7440076943393514e-32, "cur_lr": 9.999999747378752e-05, "total_loss": -0.016775136813521385, "policy_loss": -0.016781585291028023, "vf_loss": 6.442020893096924, "vf_explained_var": 0.1744518131017685, "kl": 0.0012477301061153412, "entropy": 0.11778226494789124, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 816000, "episodes_total": 22250, "training_iteration": 204, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-27-03", "timestamp": 1581506823, "time_this_iter_s": 30.201582193374634, "time_total_s": 6308.559288740158, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6308.559288740158, "timesteps_since_restore": 816000, "iterations_since_restore": 204, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.59999999999999, "episode_len_mean": 32.314516129032256, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.402624671916008}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5663632426816925, "mean_processing_ms": 6.260075310110927, "mean_inference_ms": 0.9931819519484554}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2158464, "num_steps_sampled": 820000, "sample_time_ms": 7271.197, "load_time_ms": 14.261, "grad_time_ms": 23254.71, "update_time_ms": 32.147, "learner": {"policy_0": {"cur_kl_coeff": 1.8720038471696757e-32, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0022401041351258755, "policy_loss": 0.0022337487898766994, "vf_loss": 6.351803779602051, "vf_explained_var": 0.2032412588596344, "kl": 0.002126021310687065, "entropy": 0.1462070345878601, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 820000, "episodes_total": 22374, "training_iteration": 205, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-27-34", "timestamp": 1581506854, "time_this_iter_s": 30.817646503448486, "time_total_s": 6339.376935243607, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3ae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6339.376935243607, "timesteps_since_restore": 820000, "iterations_since_restore": 205, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.738211382113807, "episode_len_mean": 32.60162601626016, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.609809264305173}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.560152483514533, "mean_processing_ms": 6.260735262679779, "mean_inference_ms": 0.9934465937231912}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2168960, "num_steps_sampled": 824000, "sample_time_ms": 7301.78, "load_time_ms": 14.822, "grad_time_ms": 23271.07, "update_time_ms": 31.871, "learner": {"policy_0": {"cur_kl_coeff": 9.360019235848379e-33, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02850475162267685, "policy_loss": 0.02849830873310566, "vf_loss": 6.452536106109619, "vf_explained_var": 0.17070171236991882, "kl": 0.0036007023882120848, "entropy": 0.13821014761924744, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 824000, "episodes_total": 22497, "training_iteration": 206, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-28-05", "timestamp": 1581506885, "time_this_iter_s": 30.37555241584778, "time_total_s": 6369.752487659454, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6369.752487659454, "timesteps_since_restore": 824000, "iterations_since_restore": 206, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.035593220338964, "episode_len_mean": 33.99152542372882, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.447696476964767}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5661432648707985, "mean_processing_ms": 6.252465556188126, "mean_inference_ms": 0.9943734164798089}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2179328, "num_steps_sampled": 828000, "sample_time_ms": 7292.287, "load_time_ms": 14.212, "grad_time_ms": 23172.434, "update_time_ms": 31.878, "learner": {"policy_0": {"cur_kl_coeff": 4.680009617924189e-33, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0025641911197453737, "policy_loss": 0.0025579368229955435, "vf_loss": 6.246014595031738, "vf_explained_var": 0.1727820634841919, "kl": 0.0041146473959088326, "entropy": 0.1784227341413498, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 828000, "episodes_total": 22615, "training_iteration": 207, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-28-35", "timestamp": 1581506915, "time_this_iter_s": 30.547008514404297, "time_total_s": 6400.299496173859, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f8c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6400.299496173859, "timesteps_since_restore": 828000, "iterations_since_restore": 207, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.63606557377048, "episode_len_mean": 32.41803278688525, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.341052631578943}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.558233261846806, "mean_processing_ms": 6.270161932713045, "mean_inference_ms": 0.9935937339489274}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2189952, "num_steps_sampled": 832000, "sample_time_ms": 7282.535, "load_time_ms": 14.126, "grad_time_ms": 23238.21, "update_time_ms": 32.292, "learner": {"policy_0": {"cur_kl_coeff": 2.3400048089620946e-33, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03899763152003288, "policy_loss": -0.03900432586669922, "vf_loss": 6.697153091430664, "vf_explained_var": 0.16059774160385132, "kl": 0.0035863984376192093, "entropy": 0.17272160947322845, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 832000, "episodes_total": 22737, "training_iteration": 208, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-29-06", "timestamp": 1581506946, "time_this_iter_s": 30.497447967529297, "time_total_s": 6430.796944141388, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7dad90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6430.796944141388, "timesteps_since_restore": 832000, "iterations_since_restore": 208, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.799999999999997, "episode_len_mean": 29.543478260869566, "episodes_this_iter": 138, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.16682464454976}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.562054990340614, "mean_processing_ms": 6.258907024570888, "mean_inference_ms": 0.993852509754908}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2200960, "num_steps_sampled": 836000, "sample_time_ms": 7305.644, "load_time_ms": 14.822, "grad_time_ms": 23335.606, "update_time_ms": 32.525, "learner": {"policy_0": {"cur_kl_coeff": 1.1700024044810473e-33, "cur_lr": 9.999999747378752e-05, "total_loss": -0.026982693001627922, "policy_loss": -0.026989364996552467, "vf_loss": 6.676754474639893, "vf_explained_var": 0.19387495517730713, "kl": 0.005225961562246084, "entropy": 0.16539567708969116, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 836000, "episodes_total": 22875, "training_iteration": 209, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-29-39", "timestamp": 1581506979, "time_this_iter_s": 32.06136202812195, "time_total_s": 6462.85830616951, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6462.85830616951, "timesteps_since_restore": 836000, "iterations_since_restore": 209, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.501369863013691, "episode_len_mean": 26.82191780821918, "episodes_this_iter": 146, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -4.52110091743119}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.561777095622024, "mean_processing_ms": 6.26838229316473, "mean_inference_ms": 0.9942044241244921}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2211328, "num_steps_sampled": 840000, "sample_time_ms": 7376.102, "load_time_ms": 14.395, "grad_time_ms": 23395.435, "update_time_ms": 32.713, "learner": {"policy_0": {"cur_kl_coeff": 1.1700024044810473e-33, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03010363131761551, "policy_loss": 0.030096763744950294, "vf_loss": 6.864996910095215, "vf_explained_var": 0.20325607061386108, "kl": 0.001150112017057836, "entropy": 0.11312001198530197, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 840000, "episodes_total": 23021, "training_iteration": 210, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-30-10", "timestamp": 1581507010, "time_this_iter_s": 31.14545702934265, "time_total_s": 6494.0037631988525, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6494.0037631988525, "timesteps_since_restore": 840000, "iterations_since_restore": 210, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.862992125984237, "episode_len_mean": 31.41732283464567, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.23272727272727}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.565462114481008, "mean_processing_ms": 6.279902826108378, "mean_inference_ms": 0.9936987158801929}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2221952, "num_steps_sampled": 844000, "sample_time_ms": 7454.378, "load_time_ms": 14.233, "grad_time_ms": 23365.744, "update_time_ms": 33.575, "learner": {"policy_0": {"cur_kl_coeff": 5.850012022405237e-34, "cur_lr": 9.999999747378752e-05, "total_loss": -0.033495236188173294, "policy_loss": -0.03350214660167694, "vf_loss": 6.905324935913086, "vf_explained_var": 0.17802460491657257, "kl": 0.005288984160870314, "entropy": 0.1668449342250824, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 844000, "episodes_total": 23148, "training_iteration": 211, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-30-41", "timestamp": 1581507041, "time_this_iter_s": 30.930221557617188, "time_total_s": 6524.93398475647, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6524.93398475647, "timesteps_since_restore": 844000, "iterations_since_restore": 211, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.55284552845528, "episode_len_mean": 32.91056910569106, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.521739130434779}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.562124044663355, "mean_processing_ms": 6.28818228622477, "mean_inference_ms": 0.9936823771323816}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2232960, "num_steps_sampled": 848000, "sample_time_ms": 7507.254, "load_time_ms": 14.85, "grad_time_ms": 23348.417, "update_time_ms": 33.49, "learner": {"policy_0": {"cur_kl_coeff": 5.850012022405237e-34, "cur_lr": 9.999999747378752e-05, "total_loss": 0.008336175233125687, "policy_loss": 0.008329612202942371, "vf_loss": 6.568695545196533, "vf_explained_var": 0.17029917240142822, "kl": 0.006283010356128216, "entropy": 0.1751055121421814, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 848000, "episodes_total": 23271, "training_iteration": 212, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-31-13", "timestamp": 1581507073, "time_this_iter_s": 31.680473566055298, "time_total_s": 6556.614458322525, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6556.614458322525, "timesteps_since_restore": 848000, "iterations_since_restore": 212, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.39354838709677, "episode_len_mean": 32.12096774193548, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.573126614987076}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.560535622339824, "mean_processing_ms": 6.270482076712731, "mean_inference_ms": 0.9940393181683765}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2244096, "num_steps_sampled": 852000, "sample_time_ms": 7568.782, "load_time_ms": 13.848, "grad_time_ms": 23432.405, "update_time_ms": 33.351, "learner": {"policy_0": {"cur_kl_coeff": 5.850012022405237e-34, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03781833499670029, "policy_loss": 0.037811268121004105, "vf_loss": 7.072054386138916, "vf_explained_var": 0.20173941552639008, "kl": 0.0035608659964054823, "entropy": 0.1980089396238327, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 852000, "episodes_total": 23395, "training_iteration": 213, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-31-46", "timestamp": 1581507106, "time_this_iter_s": 32.38668513298035, "time_total_s": 6589.001143455505, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6589.001143455505, "timesteps_since_restore": 852000, "iterations_since_restore": 213, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.78230088495575, "episode_len_mean": 35.54867256637168, "episodes_this_iter": 113, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.029545454545451}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.563295008266858, "mean_processing_ms": 6.274063896653434, "mean_inference_ms": 0.994102295167975}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2254848, "num_steps_sampled": 856000, "sample_time_ms": 7569.976, "load_time_ms": 13.818, "grad_time_ms": 23513.733, "update_time_ms": 33.065, "learner": {"policy_0": {"cur_kl_coeff": 2.9250060112026183e-34, "cur_lr": 9.999999747378752e-05, "total_loss": 0.017273901030421257, "policy_loss": 0.017266716808080673, "vf_loss": 7.181787490844727, "vf_explained_var": 0.16679029166698456, "kl": 0.002929582027718425, "entropy": 0.16436563432216644, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 856000, "episodes_total": 23508, "training_iteration": 214, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-32-17", "timestamp": 1581507137, "time_this_iter_s": 31.025742053985596, "time_total_s": 6620.026885509491, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6620.026885509491, "timesteps_since_restore": 856000, "iterations_since_restore": 214, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.96974789915965, "episode_len_mean": 33.33613445378151, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.472628726287259}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5715222671842755, "mean_processing_ms": 6.280251511404585, "mean_inference_ms": 0.9932588823933963}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2265344, "num_steps_sampled": 860000, "sample_time_ms": 7565.586, "load_time_ms": 14.492, "grad_time_ms": 23444.205, "update_time_ms": 33.061, "learner": {"policy_0": {"cur_kl_coeff": 1.4625030056013091e-34, "cur_lr": 9.999999747378752e-05, "total_loss": 0.010992614552378654, "policy_loss": 0.010986411944031715, "vf_loss": 6.205907821655273, "vf_explained_var": 0.18339787423610687, "kl": 0.0033284963574260473, "entropy": 0.19025292992591858, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 860000, "episodes_total": 23627, "training_iteration": 215, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-32-47", "timestamp": 1581507167, "time_this_iter_s": 30.084848403930664, "time_total_s": 6650.111733913422, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6650.111733913422, "timesteps_since_restore": 860000, "iterations_since_restore": 215, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.725984251968498, "episode_len_mean": 31.22047244094488, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.4747422680412345}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.568187904767031, "mean_processing_ms": 6.287622784648379, "mean_inference_ms": 0.992914450606851}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2276352, "num_steps_sampled": 864000, "sample_time_ms": 7518.389, "load_time_ms": 14.012, "grad_time_ms": 23578.225, "update_time_ms": 33.36, "learner": {"policy_0": {"cur_kl_coeff": 7.312515028006546e-35, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04473035782575607, "policy_loss": -0.04473675787448883, "vf_loss": 6.395055770874023, "vf_explained_var": 0.169577494263649, "kl": 0.0024262359365820885, "entropy": 0.15711846947669983, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 864000, "episodes_total": 23754, "training_iteration": 216, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-33-19", "timestamp": 1581507199, "time_this_iter_s": 31.24020266532898, "time_total_s": 6681.351936578751, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6681.351936578751, "timesteps_since_restore": 864000, "iterations_since_restore": 216, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.307692307692303, "episode_len_mean": 34.162393162393165, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.900826446280988}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.562373442730898, "mean_processing_ms": 6.281456483107956, "mean_inference_ms": 0.9933690536198363}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2287360, "num_steps_sampled": 868000, "sample_time_ms": 7484.774, "load_time_ms": 13.982, "grad_time_ms": 23714.398, "update_time_ms": 33.646, "learner": {"policy_0": {"cur_kl_coeff": 3.656257514003273e-35, "cur_lr": 9.999999747378752e-05, "total_loss": -0.024894868955016136, "policy_loss": -0.02490142546594143, "vf_loss": 6.548192024230957, "vf_explained_var": 0.18957532942295074, "kl": 0.00811369065195322, "entropy": 0.15365563333034515, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 868000, "episodes_total": 23871, "training_iteration": 217, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-33-51", "timestamp": 1581507231, "time_this_iter_s": 31.579625129699707, "time_total_s": 6712.93156170845, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b3876a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6712.93156170845, "timesteps_since_restore": 868000, "iterations_since_restore": 217, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.579199999999997, "episode_len_mean": 32.72, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.479800498753114}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.563544496677206, "mean_processing_ms": 6.2849343673325695, "mean_inference_ms": 0.9937488538151646}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2298496, "num_steps_sampled": 872000, "sample_time_ms": 7526.765, "load_time_ms": 14.67, "grad_time_ms": 23835.682, "update_time_ms": 33.741, "learner": {"policy_0": {"cur_kl_coeff": 3.656257514003273e-35, "cur_lr": 9.999999747378752e-05, "total_loss": 0.007295215968042612, "policy_loss": 0.00728892395272851, "vf_loss": 6.290332317352295, "vf_explained_var": 0.18831393122673035, "kl": 0.007653426844626665, "entropy": 0.18990805745124817, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 872000, "episodes_total": 23996, "training_iteration": 218, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-34-23", "timestamp": 1581507263, "time_this_iter_s": 32.139338970184326, "time_total_s": 6745.070900678635, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6745.070900678635, "timesteps_since_restore": 872000, "iterations_since_restore": 218, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.396774193548378, "episode_len_mean": 31.637096774193548, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.378835978835976}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.559539873326056, "mean_processing_ms": 6.295885747761909, "mean_inference_ms": 0.9932645812570114}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2308992, "num_steps_sampled": 876000, "sample_time_ms": 7492.547, "load_time_ms": 14.089, "grad_time_ms": 23731.323, "update_time_ms": 34.688, "learner": {"policy_0": {"cur_kl_coeff": 3.656257514003273e-35, "cur_lr": 9.999999747378752e-05, "total_loss": 0.005173014476895332, "policy_loss": 0.0051666623912751675, "vf_loss": 6.346695899963379, "vf_explained_var": 0.21207590401172638, "kl": 0.002999745775014162, "entropy": 0.14706572890281677, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 876000, "episodes_total": 24120, "training_iteration": 219, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-34-54", "timestamp": 1581507294, "time_this_iter_s": 30.678383827209473, "time_total_s": 6775.749284505844, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b800d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6775.749284505844, "timesteps_since_restore": 876000, "iterations_since_restore": 219, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.003305785123953, "episode_len_mean": 33.396694214876035, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.371801566579631}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.56671281536998, "mean_processing_ms": 6.299620062409562, "mean_inference_ms": 0.9934583979578233}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2319488, "num_steps_sampled": 880000, "sample_time_ms": 7454.181, "load_time_ms": 13.922, "grad_time_ms": 23736.588, "update_time_ms": 34.8, "learner": {"policy_0": {"cur_kl_coeff": 1.8281287570016364e-35, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01915206015110016, "policy_loss": 0.019145319238305092, "vf_loss": 6.744734764099121, "vf_explained_var": 0.21493446826934814, "kl": 0.00198162067681551, "entropy": 0.1455862820148468, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 880000, "episodes_total": 24241, "training_iteration": 220, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-35-25", "timestamp": 1581507325, "time_this_iter_s": 30.812265157699585, "time_total_s": 6806.561549663544, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6806.561549663544, "timesteps_since_restore": 880000, "iterations_since_restore": 220, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.847619047619034, "episode_len_mean": 31.523809523809526, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.213577023498692}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.564379330011957, "mean_processing_ms": 6.308798968288306, "mean_inference_ms": 0.9932236328437639}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2329856, "num_steps_sampled": 884000, "sample_time_ms": 7415.344, "load_time_ms": 14.725, "grad_time_ms": 23668.675, "update_time_ms": 34.379, "learner": {"policy_0": {"cur_kl_coeff": 9.140643785008182e-36, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0011768039548769593, "policy_loss": -0.0011836857302114367, "vf_loss": 6.883941173553467, "vf_explained_var": 0.1801241785287857, "kl": 0.002283874899148941, "entropy": 0.13074125349521637, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 884000, "episodes_total": 24367, "training_iteration": 221, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-35-55", "timestamp": 1581507355, "time_this_iter_s": 29.870083570480347, "time_total_s": 6836.431633234024, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6836.431633234024, "timesteps_since_restore": 884000, "iterations_since_restore": 221, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.90551181102362, "episode_len_mean": 31.73228346456693, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.519280205655524}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.577317491059215, "mean_processing_ms": 6.31150921339382, "mean_inference_ms": 0.9927425540539356}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2340736, "num_steps_sampled": 888000, "sample_time_ms": 7481.839, "load_time_ms": 14.115, "grad_time_ms": 23653.349, "update_time_ms": 34.462, "learner": {"policy_0": {"cur_kl_coeff": 4.570321892504091e-36, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04617764428257942, "policy_loss": 0.04617094621062279, "vf_loss": 6.709803581237793, "vf_explained_var": 0.20445480942726135, "kl": 0.00506294472143054, "entropy": 0.1567550152540207, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 888000, "episodes_total": 24494, "training_iteration": 222, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-36-28", "timestamp": 1581507388, "time_this_iter_s": 32.18813395500183, "time_total_s": 6868.619767189026, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f9d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6868.619767189026, "timesteps_since_restore": 888000, "iterations_since_restore": 222, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.013740458015267, "episode_len_mean": 30.374045801526716, "episodes_this_iter": 131, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.256603773584903}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5620806552671915, "mean_processing_ms": 6.308159212723536, "mean_inference_ms": 0.9930983140510018}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2352256, "num_steps_sampled": 892000, "sample_time_ms": 7496.494, "load_time_ms": 14.075, "grad_time_ms": 23721.022, "update_time_ms": 34.437, "learner": {"policy_0": {"cur_kl_coeff": 4.570321892504091e-36, "cur_lr": 9.999999747378752e-05, "total_loss": 0.030686039477586746, "policy_loss": 0.030679358169436455, "vf_loss": 6.678264617919922, "vf_explained_var": 0.19084994494915009, "kl": 0.0031976306345313787, "entropy": 0.11193859577178955, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 892000, "episodes_total": 24625, "training_iteration": 223, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-37-01", "timestamp": 1581507421, "time_this_iter_s": 33.21115016937256, "time_total_s": 6901.830917358398, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6901.830917358398, "timesteps_since_restore": 892000, "iterations_since_restore": 223, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.882926829268293, "episode_len_mean": 32.32520325203252, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.625575447570329}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.580140101048163, "mean_processing_ms": 6.323070460289532, "mean_inference_ms": 0.9930048990077126}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2363392, "num_steps_sampled": 896000, "sample_time_ms": 7503.88, "load_time_ms": 14.856, "grad_time_ms": 23800.928, "update_time_ms": 34.323, "learner": {"policy_0": {"cur_kl_coeff": 2.2851609462520455e-36, "cur_lr": 9.999999747378752e-05, "total_loss": -0.006262830458581448, "policy_loss": -0.006269804202020168, "vf_loss": 6.970457077026367, "vf_explained_var": 0.1686662882566452, "kl": 0.002778029767796397, "entropy": 0.15097174048423767, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 896000, "episodes_total": 24748, "training_iteration": 224, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-37-33", "timestamp": 1581507453, "time_this_iter_s": 31.906327724456787, "time_total_s": 6933.737245082855, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca0d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6933.737245082855, "timesteps_since_restore": 896000, "iterations_since_restore": 224, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.36, "episode_len_mean": 32.4, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.6806282722513055}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.582175247632907, "mean_processing_ms": 6.297923582410827, "mean_inference_ms": 0.9943058372324666}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2374528, "num_steps_sampled": 900000, "sample_time_ms": 7586.154, "load_time_ms": 14.376, "grad_time_ms": 23964.104, "update_time_ms": 34.43, "learner": {"policy_0": {"cur_kl_coeff": 1.1425804731260228e-36, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03589892014861107, "policy_loss": -0.035905759781599045, "vf_loss": 6.8370361328125, "vf_explained_var": 0.1814858466386795, "kl": 0.002991914749145508, "entropy": 0.13462889194488525, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 900000, "episodes_total": 24873, "training_iteration": 225, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-38-06", "timestamp": 1581507486, "time_this_iter_s": 32.53703784942627, "time_total_s": 6966.2742829322815, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca7b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6966.2742829322815, "timesteps_since_restore": 900000, "iterations_since_restore": 225, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.218897637795266, "episode_len_mean": 31.299212598425196, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.241221374045797}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.572720211093259, "mean_processing_ms": 6.3285715305100965, "mean_inference_ms": 0.9926018061065693}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2385152, "num_steps_sampled": 904000, "sample_time_ms": 7684.31, "load_time_ms": 14.187, "grad_time_ms": 23911.227, "update_time_ms": 34.557, "learner": {"policy_0": {"cur_kl_coeff": 5.712902365630114e-37, "cur_lr": 9.999999747378752e-05, "total_loss": -0.012511161155998707, "policy_loss": -0.012518027797341347, "vf_loss": 6.8729143142700195, "vf_explained_var": 0.208304300904274, "kl": 0.002861134009435773, "entropy": 0.15915977954864502, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 904000, "episodes_total": 25000, "training_iteration": 226, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-38-38", "timestamp": 1581507518, "time_this_iter_s": 31.690295457839966, "time_total_s": 6997.9645783901215, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d6a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6997.9645783901215, "timesteps_since_restore": 904000, "iterations_since_restore": 226, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.33181818181818, "episode_len_mean": 30.651515151515152, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.283823529411761}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.564208290038694, "mean_processing_ms": 6.310671333026005, "mean_inference_ms": 0.9938366848229534}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2396032, "num_steps_sampled": 908000, "sample_time_ms": 7717.148, "load_time_ms": 15.197, "grad_time_ms": 23872.944, "update_time_ms": 33.547, "learner": {"policy_0": {"cur_kl_coeff": 2.856451182815057e-37, "cur_lr": 9.999999747378752e-05, "total_loss": -0.06515461206436157, "policy_loss": -0.06516137719154358, "vf_loss": 6.775897026062012, "vf_explained_var": 0.1749933958053589, "kl": 0.002457867143675685, "entropy": 0.1331966668367386, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 908000, "episodes_total": 25132, "training_iteration": 227, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-39-10", "timestamp": 1581507550, "time_this_iter_s": 31.522536277770996, "time_total_s": 7029.4871146678925, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7029.4871146678925, "timesteps_since_restore": 908000, "iterations_since_restore": 227, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.460937499999993, "episode_len_mean": 30.453125, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.113695090439274}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.571528147983123, "mean_processing_ms": 6.314980471126033, "mean_inference_ms": 0.9938327606414898}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2406528, "num_steps_sampled": 912000, "sample_time_ms": 7698.929, "load_time_ms": 14.574, "grad_time_ms": 23770.697, "update_time_ms": 33.138, "learner": {"policy_0": {"cur_kl_coeff": 1.4282255914075285e-37, "cur_lr": 9.999999747378752e-05, "total_loss": -0.021502703428268433, "policy_loss": -0.02150936983525753, "vf_loss": 6.663517475128174, "vf_explained_var": 0.20195619761943817, "kl": 0.0030840300023555756, "entropy": 0.11706742644309998, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 912000, "episodes_total": 25260, "training_iteration": 228, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-39-41", "timestamp": 1581507581, "time_this_iter_s": 30.92292881011963, "time_total_s": 7060.410043478012, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264bf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7060.410043478012, "timesteps_since_restore": 912000, "iterations_since_restore": 228, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.141791044776113, "episode_len_mean": 30.776119402985074, "episodes_this_iter": 134, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.2885085574572095}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.569399895966231, "mean_processing_ms": 6.316282438893203, "mean_inference_ms": 0.9937285312223509}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2417408, "num_steps_sampled": 916000, "sample_time_ms": 7776.674, "load_time_ms": 14.389, "grad_time_ms": 23833.274, "update_time_ms": 32.27, "learner": {"policy_0": {"cur_kl_coeff": 7.141127957037642e-38, "cur_lr": 9.999999747378752e-05, "total_loss": 0.012364046648144722, "policy_loss": 0.012357504107058048, "vf_loss": 6.5429277420043945, "vf_explained_var": 0.19103321433067322, "kl": 0.004203504882752895, "entropy": 0.15018241107463837, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 916000, "episodes_total": 25394, "training_iteration": 229, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-40-14", "timestamp": 1581507614, "time_this_iter_s": 32.07274770736694, "time_total_s": 7092.482791185379, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7092.482791185379, "timesteps_since_restore": 916000, "iterations_since_restore": 229, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.213114754098356, "episode_len_mean": 32.532786885245905, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.660377358490562}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.572069203870504, "mean_processing_ms": 6.329855782657578, "mean_inference_ms": 0.9929055381284828}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2428160, "num_steps_sampled": 920000, "sample_time_ms": 7701.861, "load_time_ms": 15.283, "grad_time_ms": 23914.012, "update_time_ms": 32.147, "learner": {"policy_0": {"cur_kl_coeff": 3.570563978518821e-38, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013054011389613152, "policy_loss": 0.013047624379396439, "vf_loss": 6.387545585632324, "vf_explained_var": 0.1963643580675125, "kl": 0.003599677700549364, "entropy": 0.1392248421907425, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 920000, "episodes_total": 25516, "training_iteration": 230, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-40-45", "timestamp": 1581507645, "time_this_iter_s": 30.880777835845947, "time_total_s": 7123.363569021225, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7123.363569021225, "timesteps_since_restore": 920000, "iterations_since_restore": 230, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.643697478991587, "episode_len_mean": 32.95798319327731, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.691379310344824}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.561039997138907, "mean_processing_ms": 6.341938563948331, "mean_inference_ms": 0.9931726357900842}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2438656, "num_steps_sampled": 924000, "sample_time_ms": 7725.506, "load_time_ms": 14.545, "grad_time_ms": 23958.572, "update_time_ms": 32.115, "learner": {"policy_0": {"cur_kl_coeff": 1.7852819892594106e-38, "cur_lr": 9.999999747378752e-05, "total_loss": -0.003571628825739026, "policy_loss": -0.00357841607183218, "vf_loss": 6.7808756828308105, "vf_explained_var": 0.1666465848684311, "kl": 0.002056561876088381, "entropy": 0.15962374210357666, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 924000, "episodes_total": 25635, "training_iteration": 231, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-41-15", "timestamp": 1581507675, "time_this_iter_s": 30.541939735412598, "time_total_s": 7153.905508756638, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7153.905508756638, "timesteps_since_restore": 924000, "iterations_since_restore": 231, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.463636363636358, "episode_len_mean": 30.916666666666668, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.236626506024093}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.576890169119449, "mean_processing_ms": 6.336486979555598, "mean_inference_ms": 0.9927562073084081}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2449536, "num_steps_sampled": 928000, "sample_time_ms": 7687.49, "load_time_ms": 14.622, "grad_time_ms": 23937.592, "update_time_ms": 31.883, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.007508761715143919, "policy_loss": 0.007502446416765451, "vf_loss": 6.315442085266113, "vf_explained_var": 0.20035091042518616, "kl": 0.001989040058106184, "entropy": 0.14174850285053253, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 928000, "episodes_total": 25767, "training_iteration": 232, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-41-47", "timestamp": 1581507707, "time_this_iter_s": 31.597832918167114, "time_total_s": 7185.503341674805, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac38c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7185.503341674805, "timesteps_since_restore": 928000, "iterations_since_restore": 232, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.021768707482982, "episode_len_mean": 27.08843537414966, "episodes_this_iter": 147, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.410599078341011}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.56785567994029, "mean_processing_ms": 6.3333613263272905, "mean_inference_ms": 0.9934502242174915}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2459648, "num_steps_sampled": 932000, "sample_time_ms": 7718.699, "load_time_ms": 14.987, "grad_time_ms": 23643.292, "update_time_ms": 31.711, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0026712894905358553, "policy_loss": -0.002676734933629632, "vf_loss": 5.444532871246338, "vf_explained_var": 0.2181650549173355, "kl": 0.003051098668947816, "entropy": 0.17930971086025238, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 932000, "episodes_total": 25914, "training_iteration": 233, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-42-18", "timestamp": 1581507738, "time_this_iter_s": 30.58172035217285, "time_total_s": 7216.0850620269775, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7216.0850620269775, "timesteps_since_restore": 932000, "iterations_since_restore": 233, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.890909090909076, "episode_len_mean": 30.742424242424242, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.913999999999998}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.578438936305385, "mean_processing_ms": 6.34655819677631, "mean_inference_ms": 0.9934155976178971}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2469632, "num_steps_sampled": 936000, "sample_time_ms": 7766.645, "load_time_ms": 14.284, "grad_time_ms": 23378.079, "update_time_ms": 32.077, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0306281428784132, "policy_loss": 0.030621634796261787, "vf_loss": 6.505904197692871, "vf_explained_var": 0.1748860627412796, "kl": 0.001576861715875566, "entropy": 0.09991272538900375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 936000, "episodes_total": 26046, "training_iteration": 234, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-42-48", "timestamp": 1581507768, "time_this_iter_s": 29.7282395362854, "time_total_s": 7245.813301563263, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387d90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7245.813301563263, "timesteps_since_restore": 936000, "iterations_since_restore": 234, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.646478873239428, "episode_len_mean": 28.35211267605634, "episodes_this_iter": 142, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.642410714285712}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.579683716384588, "mean_processing_ms": 6.340007857199546, "mean_inference_ms": 0.9934436831254111}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2480384, "num_steps_sampled": 940000, "sample_time_ms": 7743.171, "load_time_ms": 14.032, "grad_time_ms": 23288.107, "update_time_ms": 31.95, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0133674843236804, "policy_loss": 0.013361215591430664, "vf_loss": 6.266969203948975, "vf_explained_var": 0.19732947647571564, "kl": 0.005562966223806143, "entropy": 0.13878996670246124, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 940000, "episodes_total": 26188, "training_iteration": 235, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-43-20", "timestamp": 1581507800, "time_this_iter_s": 31.395984411239624, "time_total_s": 7277.209285974503, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac882f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7277.209285974503, "timesteps_since_restore": 940000, "iterations_since_restore": 235, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.47704918032786, "episode_len_mean": 32.295081967213115, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.568421052631576}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.578686761888324, "mean_processing_ms": 6.342780275906473, "mean_inference_ms": 0.9932653603181923}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2490880, "num_steps_sampled": 944000, "sample_time_ms": 7724.251, "load_time_ms": 14.837, "grad_time_ms": 23247.007, "update_time_ms": 31.845, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.020842578262090683, "policy_loss": -0.020849065855145454, "vf_loss": 6.488832950592041, "vf_explained_var": 0.17739970982074738, "kl": 0.0026795342564582825, "entropy": 0.1708732545375824, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 944000, "episodes_total": 26310, "training_iteration": 236, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-43-51", "timestamp": 1581507831, "time_this_iter_s": 31.099459409713745, "time_total_s": 7308.308745384216, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7308.308745384216, "timesteps_since_restore": 944000, "iterations_since_restore": 236, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.484799999999993, "episode_len_mean": 31.992, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.436939313984165}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5728033789016695, "mean_processing_ms": 6.340406091837062, "mean_inference_ms": 0.9936620646730345}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2501376, "num_steps_sampled": 948000, "sample_time_ms": 7688.658, "load_time_ms": 13.795, "grad_time_ms": 23175.983, "update_time_ms": 32.267, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.025824178010225296, "policy_loss": -0.025830943137407303, "vf_loss": 6.764688014984131, "vf_explained_var": 0.20975854992866516, "kl": 0.004116889555007219, "entropy": 0.13869766891002655, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 948000, "episodes_total": 26435, "training_iteration": 237, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-44-22", "timestamp": 1581507862, "time_this_iter_s": 30.44972324371338, "time_total_s": 7338.75846862793, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c6a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7338.75846862793, "timesteps_since_restore": 948000, "iterations_since_restore": 237, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.102362204724404, "episode_len_mean": 31.228346456692915, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.151133501259443}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.583734867835746, "mean_processing_ms": 6.3594176420707145, "mean_inference_ms": 0.9932329853010661}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2512128, "num_steps_sampled": 952000, "sample_time_ms": 7722.737, "load_time_ms": 13.743, "grad_time_ms": 23221.397, "update_time_ms": 32.797, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03135792911052704, "policy_loss": 0.031351055949926376, "vf_loss": 6.879137992858887, "vf_explained_var": 0.18359920382499695, "kl": 0.0020796991884708405, "entropy": 0.13230325281620026, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 952000, "episodes_total": 26562, "training_iteration": 238, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-44-54", "timestamp": 1581507894, "time_this_iter_s": 31.722221612930298, "time_total_s": 7370.48069024086, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7370.48069024086, "timesteps_since_restore": 952000, "iterations_since_restore": 238, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.525547445255468, "episode_len_mean": 29.817518248175183, "episodes_this_iter": 137, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.1501210653753}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.570132785991533, "mean_processing_ms": 6.352727806248359, "mean_inference_ms": 0.9934640583958888}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2522752, "num_steps_sampled": 956000, "sample_time_ms": 7718.2, "load_time_ms": 14.716, "grad_time_ms": 23188.46, "update_time_ms": 33.068, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03709263354539871, "policy_loss": 0.037086568772792816, "vf_loss": 6.067773818969727, "vf_explained_var": 0.20956815779209137, "kl": 0.0024524577893316746, "entropy": 0.1454440802335739, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 956000, "episodes_total": 26699, "training_iteration": 239, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-45-26", "timestamp": 1581507926, "time_this_iter_s": 31.709614992141724, "time_total_s": 7402.190305233002, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3bf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7402.190305233002, "timesteps_since_restore": 956000, "iterations_since_restore": 239, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.870588235294107, "episode_len_mean": 29.169117647058822, "episodes_this_iter": 136, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.649195402298849}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.574544975873941, "mean_processing_ms": 6.347810391983484, "mean_inference_ms": 0.9939512017706034}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2533248, "num_steps_sampled": 960000, "sample_time_ms": 7793.667, "load_time_ms": 14.089, "grad_time_ms": 23118.939, "update_time_ms": 33.075, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.005932295694947243, "policy_loss": -0.005938337650150061, "vf_loss": 6.047287940979004, "vf_explained_var": 0.20562392473220825, "kl": 0.002273148624226451, "entropy": 0.15434494614601135, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 960000, "episodes_total": 26835, "training_iteration": 240, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-45-57", "timestamp": 1581507957, "time_this_iter_s": 30.932698488235474, "time_total_s": 7433.123003721237, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3f28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7433.123003721237, "timesteps_since_restore": 960000, "iterations_since_restore": 240, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.834965034965023, "episode_len_mean": 27.958041958041957, "episodes_this_iter": 143, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.590255220417631}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.565116368299248, "mean_processing_ms": 6.3734670577345325, "mean_inference_ms": 0.9930587678063905}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2543616, "num_steps_sampled": 964000, "sample_time_ms": 7835.445, "load_time_ms": 13.999, "grad_time_ms": 23082.212, "update_time_ms": 33.634, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.028154322877526283, "policy_loss": -0.028160329908132553, "vf_loss": 6.012604713439941, "vf_explained_var": 0.21487775444984436, "kl": 0.0051794047467410564, "entropy": 0.1604526937007904, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 964000, "episodes_total": 26978, "training_iteration": 241, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-46-28", "timestamp": 1581507988, "time_this_iter_s": 30.59766960144043, "time_total_s": 7463.720673322678, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d8c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7463.720673322678, "timesteps_since_restore": 964000, "iterations_since_restore": 241, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.995588235294106, "episode_len_mean": 29.830882352941178, "episodes_this_iter": 136, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.9024038461538435}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5786100225386015, "mean_processing_ms": 6.385435499473634, "mean_inference_ms": 0.9927093228772828}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2553984, "num_steps_sampled": 968000, "sample_time_ms": 7791.796, "load_time_ms": 14.436, "grad_time_ms": 22967.22, "update_time_ms": 33.642, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00740794837474823, "policy_loss": -0.007413843646645546, "vf_loss": 5.900070667266846, "vf_explained_var": 0.16692431271076202, "kl": 0.003918440546840429, "entropy": 0.14137618243694305, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 968000, "episodes_total": 27114, "training_iteration": 242, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-46-59", "timestamp": 1581508019, "time_this_iter_s": 30.018869638442993, "time_total_s": 7493.739542961121, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244fd90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7493.739542961121, "timesteps_since_restore": 968000, "iterations_since_restore": 242, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.737226277372255, "episode_len_mean": 28.99270072992701, "episodes_this_iter": 137, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.853365384615382}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.577156327737811, "mean_processing_ms": 6.380217928656514, "mean_inference_ms": 0.9925578276398166}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2564480, "num_steps_sampled": 972000, "sample_time_ms": 7709.74, "load_time_ms": 14.063, "grad_time_ms": 23056.525, "update_time_ms": 33.632, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0007980124210007489, "policy_loss": 0.0007917393813841045, "vf_loss": 6.273075580596924, "vf_explained_var": 0.2180863320827484, "kl": 0.0025903370697051287, "entropy": 0.15779459476470947, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 972000, "episodes_total": 27251, "training_iteration": 243, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-47-30", "timestamp": 1581508050, "time_this_iter_s": 30.6520357131958, "time_total_s": 7524.391578674316, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca9d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7524.391578674316, "timesteps_since_restore": 972000, "iterations_since_restore": 243, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.901612903225793, "episode_len_mean": 31.693548387096776, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.24414893617021}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.578124679249329, "mean_processing_ms": 6.38061223434272, "mean_inference_ms": 0.9929581988860715}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2574976, "num_steps_sampled": 976000, "sample_time_ms": 7625.02, "load_time_ms": 13.893, "grad_time_ms": 23175.857, "update_time_ms": 33.514, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.006571558304131031, "policy_loss": 0.0065649994648993015, "vf_loss": 6.555522441864014, "vf_explained_var": 0.22474747896194458, "kl": 0.0020252892281860113, "entropy": 0.1317671537399292, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 976000, "episodes_total": 27375, "training_iteration": 244, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-48-00", "timestamp": 1581508080, "time_this_iter_s": 30.07220149040222, "time_total_s": 7554.463780164719, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244fe18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7554.463780164719, "timesteps_since_restore": 976000, "iterations_since_restore": 244, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.333333333333318, "episode_len_mean": 31.88095238095238, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.359374999999997}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.562975738549638, "mean_processing_ms": 6.3696961639231215, "mean_inference_ms": 0.9925482547515336}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2585472, "num_steps_sampled": 980000, "sample_time_ms": 7611.012, "load_time_ms": 14.439, "grad_time_ms": 23125.094, "update_time_ms": 33.626, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.023480253294110298, "policy_loss": 0.023473581299185753, "vf_loss": 6.66882848739624, "vf_explained_var": 0.2177843302488327, "kl": 0.004394638817757368, "entropy": 0.11311810463666916, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 980000, "episodes_total": 27501, "training_iteration": 245, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-48-31", "timestamp": 1581508111, "time_this_iter_s": 30.75887966156006, "time_total_s": 7585.222659826279, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244fb70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7585.222659826279, "timesteps_since_restore": 980000, "iterations_since_restore": 245, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.17462686567163, "episode_len_mean": 29.992537313432837, "episodes_this_iter": 134, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.9838235294117625}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.568940063052594, "mean_processing_ms": 6.384643185223965, "mean_inference_ms": 0.9926159015586723}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2595840, "num_steps_sampled": 984000, "sample_time_ms": 7648.682, "load_time_ms": 13.729, "grad_time_ms": 23090.282, "update_time_ms": 33.656, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04767785593867302, "policy_loss": 0.04767098277807236, "vf_loss": 6.87664794921875, "vf_explained_var": 0.20297542214393616, "kl": 0.0030925979372113943, "entropy": 0.1432340294122696, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 984000, "episodes_total": 27635, "training_iteration": 246, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-49-03", "timestamp": 1581508143, "time_this_iter_s": 31.12080407142639, "time_total_s": 7616.343463897705, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7616.343463897705, "timesteps_since_restore": 984000, "iterations_since_restore": 246, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.216793893129756, "episode_len_mean": 30.977099236641223, "episodes_this_iter": 131, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.098209718670073}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5797521665268395, "mean_processing_ms": 6.376589825352843, "mean_inference_ms": 0.9924969602359922}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2606080, "num_steps_sampled": 988000, "sample_time_ms": 7650.04, "load_time_ms": 13.946, "grad_time_ms": 23011.834, "update_time_ms": 33.385, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02330171689391136, "policy_loss": 0.023295745253562927, "vf_loss": 5.969022750854492, "vf_explained_var": 0.23883762955665588, "kl": 0.008558804169297218, "entropy": 0.1253516972064972, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 988000, "episodes_total": 27766, "training_iteration": 247, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-49-33", "timestamp": 1581508173, "time_this_iter_s": 29.678588390350342, "time_total_s": 7646.022052288055, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57df28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7646.022052288055, "timesteps_since_restore": 988000, "iterations_since_restore": 247, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.880952380952374, "episode_len_mean": 31.3015873015873, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.364611260053616}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.574199758027566, "mean_processing_ms": 6.39490272113926, "mean_inference_ms": 0.9924063129149081}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2616576, "num_steps_sampled": 992000, "sample_time_ms": 7586.6, "load_time_ms": 14.783, "grad_time_ms": 22926.594, "update_time_ms": 32.839, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.013718735426664352, "policy_loss": -0.013725236989557743, "vf_loss": 6.504298686981201, "vf_explained_var": 0.20380447804927826, "kl": 0.0022958938498049974, "entropy": 0.1021558865904808, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 992000, "episodes_total": 27892, "training_iteration": 248, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-50-03", "timestamp": 1581508203, "time_this_iter_s": 30.23730969429016, "time_total_s": 7676.259361982346, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7676.259361982346, "timesteps_since_restore": 992000, "iterations_since_restore": 248, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.008403361344534, "episode_len_mean": 33.588235294117645, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.823369565217388}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.570468226996782, "mean_processing_ms": 6.391041417142848, "mean_inference_ms": 0.9923750532866722}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2627456, "num_steps_sampled": 996000, "sample_time_ms": 7514.533, "load_time_ms": 13.956, "grad_time_ms": 22962.917, "update_time_ms": 32.503, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04423638805747032, "policy_loss": 0.044229838997125626, "vf_loss": 6.544754505157471, "vf_explained_var": 0.22224201261997223, "kl": 0.003493456169962883, "entropy": 0.1389865279197693, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 996000, "episodes_total": 28011, "training_iteration": 249, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-50-35", "timestamp": 1581508235, "time_this_iter_s": 31.341211080551147, "time_total_s": 7707.600573062897, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201cbf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7707.600573062897, "timesteps_since_restore": 996000, "iterations_since_restore": 249, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.691935483870957, "episode_len_mean": 32.70967741935484, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.563978494623652}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.575894590625938, "mean_processing_ms": 6.388436065876265, "mean_inference_ms": 0.992428592938981}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2637952, "num_steps_sampled": 1000000, "sample_time_ms": 7440.896, "load_time_ms": 13.698, "grad_time_ms": 22985.778, "update_time_ms": 32.739, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0002490987244527787, "policy_loss": 0.00024251549621112645, "vf_loss": 6.580790996551514, "vf_explained_var": 0.18823683261871338, "kl": 0.0014254585839807987, "entropy": 0.0957081988453865, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1000000, "episodes_total": 28135, "training_iteration": 250, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-51-05", "timestamp": 1581508265, "time_this_iter_s": 30.42871928215027, "time_total_s": 7738.029292345047, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201cae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7738.029292345047, "timesteps_since_restore": 1000000, "iterations_since_restore": 250, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.74471544715446, "episode_len_mean": 31.869918699186993, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.50695187165775}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.572620167448765, "mean_processing_ms": 6.39278183544311, "mean_inference_ms": 0.9919540732404037}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2648832, "num_steps_sampled": 1004000, "sample_time_ms": 7400.726, "load_time_ms": 14.457, "grad_time_ms": 23107.312, "update_time_ms": 32.497, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00798486266285181, "policy_loss": 0.007978379726409912, "vf_loss": 6.483075141906738, "vf_explained_var": 0.20732448995113373, "kl": 0.0017553111538290977, "entropy": 0.10558860003948212, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1004000, "episodes_total": 28258, "training_iteration": 251, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-51-37", "timestamp": 1581508297, "time_this_iter_s": 31.415769577026367, "time_total_s": 7769.445061922073, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387b70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7769.445061922073, "timesteps_since_restore": 1004000, "iterations_since_restore": 251, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.16833333333332, "episode_len_mean": 33.78333333333333, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.819774011299432}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.580943136809743, "mean_processing_ms": 6.401516989545948, "mean_inference_ms": 0.991729293178753}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2659072, "num_steps_sampled": 1008000, "sample_time_ms": 7380.919, "load_time_ms": 13.909, "grad_time_ms": 23075.311, "update_time_ms": 32.789, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01773075759410858, "policy_loss": 0.017724232748150826, "vf_loss": 6.523573875427246, "vf_explained_var": 0.18880876898765564, "kl": 0.0025271200574934483, "entropy": 0.08140832930803299, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1008000, "episodes_total": 28378, "training_iteration": 252, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-52-07", "timestamp": 1581508327, "time_this_iter_s": 29.494341611862183, "time_total_s": 7798.939403533936, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387e18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7798.939403533936, "timesteps_since_restore": 1008000, "iterations_since_restore": 252, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.92307692307691, "episode_len_mean": 36.89423076923077, "episodes_this_iter": 104, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.2082018927444755}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.569814824857529, "mean_processing_ms": 6.388678909648211, "mean_inference_ms": 0.9924811680182403}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2669568, "num_steps_sampled": 1012000, "sample_time_ms": 7304.591, "load_time_ms": 13.783, "grad_time_ms": 23083.883, "update_time_ms": 32.563, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01242680661380291, "policy_loss": 0.012419192120432854, "vf_loss": 7.606873512268066, "vf_explained_var": 0.18908870220184326, "kl": 0.0025639450177550316, "entropy": 0.13323092460632324, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1012000, "episodes_total": 28482, "training_iteration": 253, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-52-37", "timestamp": 1581508357, "time_this_iter_s": 29.97066569328308, "time_total_s": 7828.910069227219, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3c80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7828.910069227219, "timesteps_since_restore": 1012000, "iterations_since_restore": 253, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.87244094488188, "episode_len_mean": 32.58267716535433, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.638947368421049}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.574559910562156, "mean_processing_ms": 6.394747920393801, "mean_inference_ms": 0.9921499265527732}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2680192, "num_steps_sampled": 1016000, "sample_time_ms": 7340.916, "load_time_ms": 14.432, "grad_time_ms": 23118.308, "update_time_ms": 32.698, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.022288186475634575, "policy_loss": -0.02229498326778412, "vf_loss": 6.795519828796387, "vf_explained_var": 0.20525206625461578, "kl": 0.002023526234552264, "entropy": 0.10809770971536636, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1016000, "episodes_total": 28609, "training_iteration": 254, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-53-08", "timestamp": 1581508388, "time_this_iter_s": 30.786603450775146, "time_total_s": 7859.696672677994, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7859.696672677994, "timesteps_since_restore": 1016000, "iterations_since_restore": 254, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.921311475409826, "episode_len_mean": 32.81967213114754, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.594579945799454}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.567528768099969, "mean_processing_ms": 6.3896059936668275, "mean_inference_ms": 0.9926216604322419}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2690816, "num_steps_sampled": 1020000, "sample_time_ms": 7319.758, "load_time_ms": 14.005, "grad_time_ms": 23160.455, "update_time_ms": 32.666, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.018872050568461418, "policy_loss": -0.018878178671002388, "vf_loss": 6.129944801330566, "vf_explained_var": 0.19990400969982147, "kl": 0.002374194096773863, "entropy": 0.12093755602836609, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1020000, "episodes_total": 28731, "training_iteration": 255, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-53-39", "timestamp": 1581508419, "time_this_iter_s": 30.96201181411743, "time_total_s": 7890.658684492111, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3452640d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7890.658684492111, "timesteps_since_restore": 1020000, "iterations_since_restore": 255, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.408333333333324, "episode_len_mean": 32.916666666666664, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.707650273224041}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5739103825987675, "mean_processing_ms": 6.4138014522037565, "mean_inference_ms": 0.9920451855331739}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2701568, "num_steps_sampled": 1024000, "sample_time_ms": 7269.91, "load_time_ms": 14.302, "grad_time_ms": 23229.924, "update_time_ms": 32.422, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.021174700930714607, "policy_loss": -0.02118111029267311, "vf_loss": 6.4086761474609375, "vf_explained_var": 0.20954205095767975, "kl": 0.0035449666902422905, "entropy": 0.1372765749692917, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1024000, "episodes_total": 28851, "training_iteration": 256, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-54-11", "timestamp": 1581508451, "time_this_iter_s": 31.319236040115356, "time_total_s": 7921.977920532227, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7921.977920532227, "timesteps_since_restore": 1024000, "iterations_since_restore": 256, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.686206896551713, "episode_len_mean": 34.275862068965516, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.811898016997164}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.582909202599659, "mean_processing_ms": 6.40456942431374, "mean_inference_ms": 0.9910785678942629}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2712192, "num_steps_sampled": 1028000, "sample_time_ms": 7264.767, "load_time_ms": 14.731, "grad_time_ms": 23330.819, "update_time_ms": 32.553, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.019124792888760567, "policy_loss": 0.01911747083067894, "vf_loss": 7.324548721313477, "vf_explained_var": 0.17303399741649628, "kl": 0.0023792425636202097, "entropy": 0.09920234233140945, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1028000, "episodes_total": 28967, "training_iteration": 257, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-54-42", "timestamp": 1581508482, "time_this_iter_s": 30.641234397888184, "time_total_s": 7952.619154930115, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d7b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7952.619154930115, "timesteps_since_restore": 1028000, "iterations_since_restore": 257, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.746099290780133, "episode_len_mean": 28.70921985815603, "episodes_this_iter": 141, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.950476190476188}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.567674027802892, "mean_processing_ms": 6.3812428651549435, "mean_inference_ms": 0.9931366736804769}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2722816, "num_steps_sampled": 1032000, "sample_time_ms": 7352.141, "load_time_ms": 14.045, "grad_time_ms": 23353.042, "update_time_ms": 33.525, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.007486090529710054, "policy_loss": -0.007493395358324051, "vf_loss": 7.300585746765137, "vf_explained_var": 0.18583165109157562, "kl": 0.002631167182698846, "entropy": 0.10349100083112717, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1032000, "episodes_total": 29108, "training_iteration": 258, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-55-14", "timestamp": 1581508514, "time_this_iter_s": 31.336638689041138, "time_total_s": 7983.955793619156, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244fbf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7983.955793619156, "timesteps_since_restore": 1032000, "iterations_since_restore": 258, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.229230769230764, "episode_len_mean": 30.4, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.209382716049379}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.570257723896751, "mean_processing_ms": 6.39932187155768, "mean_inference_ms": 0.991731059030174}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2733824, "num_steps_sampled": 1036000, "sample_time_ms": 7395.501, "load_time_ms": 13.897, "grad_time_ms": 23390.002, "update_time_ms": 33.294, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03169366344809532, "policy_loss": 0.03168649971485138, "vf_loss": 7.165770053863525, "vf_explained_var": 0.20019958913326263, "kl": 0.003021801356226206, "entropy": 0.13232675194740295, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1036000, "episodes_total": 29238, "training_iteration": 259, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-55-46", "timestamp": 1581508546, "time_this_iter_s": 32.14256262779236, "time_total_s": 8016.098356246948, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8016.098356246948, "timesteps_since_restore": 1036000, "iterations_since_restore": 259, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.735087719298242, "episode_len_mean": 35.228070175438596, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.1197707736389635}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.565849065688012, "mean_processing_ms": 6.402861702293707, "mean_inference_ms": 0.9918069562200236}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2744704, "num_steps_sampled": 1040000, "sample_time_ms": 7428.857, "load_time_ms": 14.602, "grad_time_ms": 23487.901, "update_time_ms": 33.145, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.019085370004177094, "policy_loss": -0.019091984257102013, "vf_loss": 6.61128568649292, "vf_explained_var": 0.18470993638038635, "kl": 0.006533455103635788, "entropy": 0.15310503542423248, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1040000, "episodes_total": 29352, "training_iteration": 260, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-56-18", "timestamp": 1581508578, "time_this_iter_s": 31.74099063873291, "time_total_s": 8047.839346885681, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57dd08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8047.839346885681, "timesteps_since_restore": 1040000, "iterations_since_restore": 260, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.12605042016806, "episode_len_mean": 33.596638655462186, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.740845070422531}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.577127620984837, "mean_processing_ms": 6.406815443600203, "mean_inference_ms": 0.9914897505499148}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2755200, "num_steps_sampled": 1044000, "sample_time_ms": 7442.497, "load_time_ms": 13.915, "grad_time_ms": 23387.091, "update_time_ms": 32.652, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02274584397673607, "policy_loss": -0.0227527879178524, "vf_loss": 6.943172454833984, "vf_explained_var": 0.1627817451953888, "kl": 0.003078422276303172, "entropy": 0.13150660693645477, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1044000, "episodes_total": 29471, "training_iteration": 261, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-56-49", "timestamp": 1581508609, "time_this_iter_s": 30.53166913986206, "time_total_s": 8078.371016025543, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8078.371016025543, "timesteps_since_restore": 1044000, "iterations_since_restore": 261, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.448739495798314, "episode_len_mean": 34.142857142857146, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.031318681318678}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.564778494522687, "mean_processing_ms": 6.414204269209262, "mean_inference_ms": 0.9919245378882077}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2766208, "num_steps_sampled": 1048000, "sample_time_ms": 7483.446, "load_time_ms": 14.081, "grad_time_ms": 23547.617, "update_time_ms": 32.605, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.053757790476083755, "policy_loss": 0.05375080928206444, "vf_loss": 6.989236354827881, "vf_explained_var": 0.15119372308254242, "kl": 0.004441078286617994, "entropy": 0.15503215789794922, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1048000, "episodes_total": 29590, "training_iteration": 262, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-57-21", "timestamp": 1581508641, "time_this_iter_s": 31.510224103927612, "time_total_s": 8109.881240129471, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244fd08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8109.881240129471, "timesteps_since_restore": 1048000, "iterations_since_restore": 262, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.844999999999988, "episode_len_mean": 33.84166666666667, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.899173553719005}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5670618754489904, "mean_processing_ms": 6.413636956848223, "mean_inference_ms": 0.9921422375304156}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2776960, "num_steps_sampled": 1052000, "sample_time_ms": 7555.28, "load_time_ms": 14.687, "grad_time_ms": 23595.831, "update_time_ms": 32.712, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.004280917812138796, "policy_loss": 0.004274722654372454, "vf_loss": 6.196217060089111, "vf_explained_var": 0.21624962985515594, "kl": 0.003608869621530175, "entropy": 0.12475085258483887, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1052000, "episodes_total": 29710, "training_iteration": 263, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-57-53", "timestamp": 1581508673, "time_this_iter_s": 31.17763113975525, "time_total_s": 8141.058871269226, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8141.058871269226, "timesteps_since_restore": 1052000, "iterations_since_restore": 263, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.724590163934423, "episode_len_mean": 31.65573770491803, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.620936639118454}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.577444899374943, "mean_processing_ms": 6.416072604979176, "mean_inference_ms": 0.9914438907355406}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2787840, "num_steps_sampled": 1056000, "sample_time_ms": 7568.349, "load_time_ms": 14.246, "grad_time_ms": 23647.111, "update_time_ms": 32.62, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014424399472773075, "policy_loss": 0.014417088590562344, "vf_loss": 7.315706729888916, "vf_explained_var": 0.18871670961380005, "kl": 0.0026841487269848585, "entropy": 0.11571085453033447, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1056000, "episodes_total": 29832, "training_iteration": 264, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-58-24", "timestamp": 1581508704, "time_this_iter_s": 31.42551827430725, "time_total_s": 8172.484389543533, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c8c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8172.484389543533, "timesteps_since_restore": 1056000, "iterations_since_restore": 264, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.979365079365074, "episode_len_mean": 32.523809523809526, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.528165374676999}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.585537784327635, "mean_processing_ms": 6.41574334223927, "mean_inference_ms": 0.9915928874582493}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2798720, "num_steps_sampled": 1060000, "sample_time_ms": 7593.103, "load_time_ms": 14.216, "grad_time_ms": 23682.164, "update_time_ms": 32.45, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.014609445817768574, "policy_loss": -0.014615923166275024, "vf_loss": 6.477997779846191, "vf_explained_var": 0.2000165581703186, "kl": 0.0024179762694984674, "entropy": 0.11107460409402847, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1060000, "episodes_total": 29958, "training_iteration": 265, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-58-56", "timestamp": 1581508736, "time_this_iter_s": 31.559612274169922, "time_total_s": 8204.044001817703, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8204.044001817703, "timesteps_since_restore": 1060000, "iterations_since_restore": 265, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.775409836065563, "episode_len_mean": 32.68852459016394, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.6380165289256166}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.567819199076763, "mean_processing_ms": 6.409167514869507, "mean_inference_ms": 0.9915101741506206}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2809216, "num_steps_sampled": 1064000, "sample_time_ms": 7611.414, "load_time_ms": 14.74, "grad_time_ms": 23686.378, "update_time_ms": 32.537, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.002312973141670227, "policy_loss": -0.0023203950840979815, "vf_loss": 7.426119804382324, "vf_explained_var": 0.18255983293056488, "kl": 0.0028107906691730022, "entropy": 0.13298314809799194, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1064000, "episodes_total": 30080, "training_iteration": 266, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_11-59-28", "timestamp": 1581508768, "time_this_iter_s": 31.549018144607544, "time_total_s": 8235.59301996231, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201cb70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8235.59301996231, "timesteps_since_restore": 1064000, "iterations_since_restore": 266, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.236363636363627, "episode_len_mean": 30.643939393939394, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.240097799511}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.574201274459276, "mean_processing_ms": 6.406805160646592, "mean_inference_ms": 0.9917694164101931}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2820096, "num_steps_sampled": 1068000, "sample_time_ms": 7737.15, "load_time_ms": 14.231, "grad_time_ms": 23754.88, "update_time_ms": 32.848, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02275259420275688, "policy_loss": -0.02275935746729374, "vf_loss": 6.75449800491333, "vf_explained_var": 0.1984594464302063, "kl": 0.002835484454408288, "entropy": 0.13765986263751984, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1068000, "episodes_total": 30212, "training_iteration": 267, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-00-01", "timestamp": 1581508801, "time_this_iter_s": 32.58232259750366, "time_total_s": 8268.175342559814, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8268.175342559814, "timesteps_since_restore": 1068000, "iterations_since_restore": 267, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.571698113207542, "episode_len_mean": 36.37735849056604, "episodes_this_iter": 106, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.26767371601208}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.565332548607781, "mean_processing_ms": 6.419952368293548, "mean_inference_ms": 0.9917369140581331}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2830976, "num_steps_sampled": 1072000, "sample_time_ms": 7598.583, "load_time_ms": 14.339, "grad_time_ms": 23813.847, "update_time_ms": 32.33, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.030824953690171242, "policy_loss": -0.030831603333353996, "vf_loss": 6.6564178466796875, "vf_explained_var": 0.12703506648540497, "kl": 0.0026294253766536713, "entropy": 0.11396213620901108, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1072000, "episodes_total": 30318, "training_iteration": 268, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-00-32", "timestamp": 1581508832, "time_this_iter_s": 30.53593683242798, "time_total_s": 8298.711279392242, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387a60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8298.711279392242, "timesteps_since_restore": 1072000, "iterations_since_restore": 268, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.809345794392527, "episode_len_mean": 36.6822429906542, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.562229102167178}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.574846742588429, "mean_processing_ms": 6.431387499462937, "mean_inference_ms": 0.9915444594433838}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2841984, "num_steps_sampled": 1076000, "sample_time_ms": 7523.154, "load_time_ms": 15.095, "grad_time_ms": 23780.64, "update_time_ms": 32.393, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.006230002269148827, "policy_loss": 0.006223360542207956, "vf_loss": 6.650821208953857, "vf_explained_var": 0.14681172370910645, "kl": 0.005053128115832806, "entropy": 0.11877195537090302, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1076000, "episodes_total": 30425, "training_iteration": 269, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-01-03", "timestamp": 1581508863, "time_this_iter_s": 31.062166452407837, "time_total_s": 8329.77344584465, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8329.77344584465, "timesteps_since_restore": 1076000, "iterations_since_restore": 269, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.464661654135327, "episode_len_mean": 31.157894736842106, "episodes_this_iter": 133, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.28740359897172}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.573044631825555, "mean_processing_ms": 6.421870090516088, "mean_inference_ms": 0.9921799550558702}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2852224, "num_steps_sampled": 1080000, "sample_time_ms": 7508.183, "load_time_ms": 14.625, "grad_time_ms": 23618.211, "update_time_ms": 32.464, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.006353060714900494, "policy_loss": -0.006359197199344635, "vf_loss": 6.13992166519165, "vf_explained_var": 0.24220386147499084, "kl": 0.003128182142972946, "entropy": 0.10910160839557648, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1080000, "episodes_total": 30558, "training_iteration": 270, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-01-34", "timestamp": 1581508894, "time_this_iter_s": 29.964994430541992, "time_total_s": 8359.738440275192, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8359.738440275192, "timesteps_since_restore": 1080000, "iterations_since_restore": 270, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.109352517985604, "episode_len_mean": 29.424460431654676, "episodes_this_iter": 139, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.90700934579439}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.563464021220586, "mean_processing_ms": 6.408623027726517, "mean_inference_ms": 0.9924423651673419}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2862848, "num_steps_sampled": 1084000, "sample_time_ms": 7531.183, "load_time_ms": 14.708, "grad_time_ms": 23639.092, "update_time_ms": 32.437, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.007013657595962286, "policy_loss": -0.0070195505395531654, "vf_loss": 5.8921942710876465, "vf_explained_var": 0.2103826403617859, "kl": 0.004651726223528385, "entropy": 0.13128173351287842, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1084000, "episodes_total": 30697, "training_iteration": 271, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-02-05", "timestamp": 1581508925, "time_this_iter_s": 30.971455574035645, "time_total_s": 8390.709895849228, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57dea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8390.709895849228, "timesteps_since_restore": 1084000, "iterations_since_restore": 271, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.653968253968243, "episode_len_mean": 30.817460317460316, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.10984455958549}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.567772877643073, "mean_processing_ms": 6.4374795889623435, "mean_inference_ms": 0.9918820718441397}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2873344, "num_steps_sampled": 1088000, "sample_time_ms": 7568.319, "load_time_ms": 15.183, "grad_time_ms": 23560.764, "update_time_ms": 32.403, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.006786911748349667, "policy_loss": -0.006793119478970766, "vf_loss": 6.204864978790283, "vf_explained_var": 0.2252955138683319, "kl": 0.0014057359658181667, "entropy": 0.09812657535076141, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1088000, "episodes_total": 30823, "training_iteration": 272, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-02-36", "timestamp": 1581508956, "time_this_iter_s": 31.103413343429565, "time_total_s": 8421.813309192657, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8421.813309192657, "timesteps_since_restore": 1088000, "iterations_since_restore": 272, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.31937984496123, "episode_len_mean": 31.6046511627907, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.2894472361809015}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.581740671713699, "mean_processing_ms": 6.435656706627865, "mean_inference_ms": 0.9920512621046792}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2883968, "num_steps_sampled": 1092000, "sample_time_ms": 7606.535, "load_time_ms": 14.744, "grad_time_ms": 23512.447, "update_time_ms": 32.661, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00857865996658802, "policy_loss": 0.008572242222726345, "vf_loss": 6.4172892570495605, "vf_explained_var": 0.19706739485263824, "kl": 0.0019104958046227694, "entropy": 0.0875057503581047, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1092000, "episodes_total": 30952, "training_iteration": 273, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-03-08", "timestamp": 1581508988, "time_this_iter_s": 31.07718062400818, "time_total_s": 8452.890489816666, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201ca60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8452.890489816666, "timesteps_since_restore": 1092000, "iterations_since_restore": 273, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.731249999999989, "episode_len_mean": 31.1015625, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.1763496143958845}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5619375162021605, "mean_processing_ms": 6.4198870668204915, "mean_inference_ms": 0.9922807116657317}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2894464, "num_steps_sampled": 1096000, "sample_time_ms": 7634.654, "load_time_ms": 14.598, "grad_time_ms": 23415.198, "update_time_ms": 32.558, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.000211851074709557, "policy_loss": 0.0002059571270365268, "vf_loss": 5.896477222442627, "vf_explained_var": 0.24426360428333282, "kl": 0.0020070946775376797, "entropy": 0.09659132361412048, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1096000, "episodes_total": 31080, "training_iteration": 274, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-03-39", "timestamp": 1581509019, "time_this_iter_s": 30.73000931739807, "time_total_s": 8483.620499134064, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8483.620499134064, "timesteps_since_restore": 1096000, "iterations_since_restore": 274, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.582608695652166, "episode_len_mean": 33.3304347826087, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.632311977715874}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.567148315440844, "mean_processing_ms": 6.432925176318631, "mean_inference_ms": 0.9921213289181482}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2905344, "num_steps_sampled": 1100000, "sample_time_ms": 7597.583, "load_time_ms": 15.254, "grad_time_ms": 23413.453, "update_time_ms": 32.545, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.014821313321590424, "policy_loss": -0.014827899634838104, "vf_loss": 6.583527088165283, "vf_explained_var": 0.19568470120429993, "kl": 0.004370027221739292, "entropy": 0.11613273620605469, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1100000, "episodes_total": 31195, "training_iteration": 275, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-04-10", "timestamp": 1581509050, "time_this_iter_s": 31.17698621749878, "time_total_s": 8514.797485351562, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201cf28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8514.797485351562, "timesteps_since_restore": 1100000, "iterations_since_restore": 275, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.631304347826074, "episode_len_mean": 35.45217391304348, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.035492957746475}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.568521767334126, "mean_processing_ms": 6.435437720826799, "mean_inference_ms": 0.9920863693520613}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2916096, "num_steps_sampled": 1104000, "sample_time_ms": 7560.066, "load_time_ms": 14.573, "grad_time_ms": 23409.973, "update_time_ms": 32.731, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.002916772151365876, "policy_loss": 0.0029095804784446955, "vf_loss": 7.19482946395874, "vf_explained_var": 0.15010949969291687, "kl": 0.0025411401875317097, "entropy": 0.10667894780635834, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1104000, "episodes_total": 31310, "training_iteration": 276, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-04-42", "timestamp": 1581509082, "time_this_iter_s": 31.132539749145508, "time_total_s": 8545.930025100708, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8545.930025100708, "timesteps_since_restore": 1104000, "iterations_since_restore": 276, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.613333333333323, "episode_len_mean": 34.44166666666667, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.636266666666663}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.571683253989063, "mean_processing_ms": 6.419848113865263, "mean_inference_ms": 0.9924297125386513}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2926464, "num_steps_sampled": 1108000, "sample_time_ms": 7458.911, "load_time_ms": 14.462, "grad_time_ms": 23282.804, "update_time_ms": 32.532, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.005794692784547806, "policy_loss": -0.005801256280392408, "vf_loss": 6.557837963104248, "vf_explained_var": 0.16504107415676117, "kl": 0.00644158199429512, "entropy": 0.12139192968606949, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1108000, "episodes_total": 31430, "training_iteration": 277, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-05-12", "timestamp": 1581509112, "time_this_iter_s": 30.2959566116333, "time_total_s": 8576.225981712341, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac881e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8576.225981712341, "timesteps_since_restore": 1108000, "iterations_since_restore": 277, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.4030303030303, "episode_len_mean": 29.901515151515152, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.160406091370555}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.569017005844447, "mean_processing_ms": 6.443411983058339, "mean_inference_ms": 0.9923086080320079}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2937216, "num_steps_sampled": 1112000, "sample_time_ms": 7561.344, "load_time_ms": 14.821, "grad_time_ms": 23255.067, "update_time_ms": 32.486, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004533781670033932, "policy_loss": -0.004540122579783201, "vf_loss": 6.339075088500977, "vf_explained_var": 0.24035276472568512, "kl": 0.0038648913614451885, "entropy": 0.1198529601097107, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1112000, "episodes_total": 31562, "training_iteration": 278, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-05-44", "timestamp": 1581509144, "time_this_iter_s": 31.28692603111267, "time_total_s": 8607.512907743454, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da6a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8607.512907743454, "timesteps_since_restore": 1112000, "iterations_since_restore": 278, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.462903225806446, "episode_len_mean": 31.879032258064516, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.3580052493438295}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.572396992521596, "mean_processing_ms": 6.43792116722904, "mean_inference_ms": 0.9921984748667068}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2947840, "num_steps_sampled": 1116000, "sample_time_ms": 7581.315, "load_time_ms": 14.191, "grad_time_ms": 23158.738, "update_time_ms": 32.594, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04953542351722717, "policy_loss": 0.049528516829013824, "vf_loss": 6.899929046630859, "vf_explained_var": 0.20930613577365875, "kl": 0.0027039749547839165, "entropy": 0.1171342059969902, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1116000, "episodes_total": 31686, "training_iteration": 279, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-06-15", "timestamp": 1581509175, "time_this_iter_s": 30.295063734054565, "time_total_s": 8637.807971477509, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8637.807971477509, "timesteps_since_restore": 1116000, "iterations_since_restore": 279, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.253846153846148, "episode_len_mean": 31.43076923076923, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.295739348370925}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5674141426161095, "mean_processing_ms": 6.422734303286217, "mean_inference_ms": 0.9927138299927883}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2958336, "num_steps_sampled": 1120000, "sample_time_ms": 7580.236, "load_time_ms": 13.939, "grad_time_ms": 23221.248, "update_time_ms": 32.651, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.038838617503643036, "policy_loss": -0.03884456306695938, "vf_loss": 5.948295593261719, "vf_explained_var": 0.18934567272663116, "kl": 0.002824826631695032, "entropy": 0.11107221245765686, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1120000, "episodes_total": 31816, "training_iteration": 280, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-06-46", "timestamp": 1581509206, "time_this_iter_s": 30.57928466796875, "time_total_s": 8668.387256145477, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8668.387256145477, "timesteps_since_restore": 1120000, "iterations_since_restore": 280, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.282539682539667, "episode_len_mean": 31.936507936507937, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.233673469387751}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.572123691012089, "mean_processing_ms": 6.434263965634067, "mean_inference_ms": 0.992015127467071}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2968832, "num_steps_sampled": 1124000, "sample_time_ms": 7543.3, "load_time_ms": 14.453, "grad_time_ms": 23187.056, "update_time_ms": 32.825, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.002129455329850316, "policy_loss": -0.002135803224518895, "vf_loss": 6.3454389572143555, "vf_explained_var": 0.2086561918258667, "kl": 0.0013659553369507194, "entropy": 0.09436700493097305, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1124000, "episodes_total": 31942, "training_iteration": 281, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-07-16", "timestamp": 1581509236, "time_this_iter_s": 30.268535614013672, "time_total_s": 8698.655791759491, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8698.655791759491, "timesteps_since_restore": 1124000, "iterations_since_restore": 281, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.119083969465635, "episode_len_mean": 30.564885496183205, "episodes_this_iter": 131, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.117829457364338}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.562884035135312, "mean_processing_ms": 6.438390808760758, "mean_inference_ms": 0.9931475336638784}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2979072, "num_steps_sampled": 1128000, "sample_time_ms": 7609.517, "load_time_ms": 13.859, "grad_time_ms": 23092.772, "update_time_ms": 32.655, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.014559954404830933, "policy_loss": -0.01456616260111332, "vf_loss": 6.204209804534912, "vf_explained_var": 0.21257880330085754, "kl": 0.0029878041241317987, "entropy": 0.10424282401800156, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1128000, "episodes_total": 32073, "training_iteration": 282, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-07-48", "timestamp": 1581509268, "time_this_iter_s": 30.815666675567627, "time_total_s": 8729.471458435059, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201cea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8729.471458435059, "timesteps_since_restore": 1128000, "iterations_since_restore": 282, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.96349206349205, "episode_len_mean": 31.444444444444443, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.224415584415581}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5817549100531005, "mean_processing_ms": 6.448128493139062, "mean_inference_ms": 0.9918587384075223}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2989568, "num_steps_sampled": 1132000, "sample_time_ms": 7589.963, "load_time_ms": 13.731, "grad_time_ms": 23083.795, "update_time_ms": 32.665, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.010888267308473587, "policy_loss": -0.010894534178078175, "vf_loss": 6.2594685554504395, "vf_explained_var": 0.2159583866596222, "kl": 0.002310909563675523, "entropy": 0.1187840923666954, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1132000, "episodes_total": 32199, "training_iteration": 283, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-08-19", "timestamp": 1581509299, "time_this_iter_s": 30.78775668144226, "time_total_s": 8760.2592151165, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac32f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8760.2592151165, "timesteps_since_restore": 1132000, "iterations_since_restore": 283, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.206299212598417, "episode_len_mean": 31.456692913385826, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.223857868020302}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5661596413514385, "mean_processing_ms": 6.433595272815342, "mean_inference_ms": 0.9927383679523601}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3000192, "num_steps_sampled": 1136000, "sample_time_ms": 7540.617, "load_time_ms": 14.458, "grad_time_ms": 23086.475, "update_time_ms": 32.85, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01442236639559269, "policy_loss": 0.014416194520890713, "vf_loss": 6.167372226715088, "vf_explained_var": 0.22338952124118805, "kl": 0.0032217027619481087, "entropy": 0.10145042836666107, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1136000, "episodes_total": 32326, "training_iteration": 284, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-08-49", "timestamp": 1581509329, "time_this_iter_s": 30.27397108078003, "time_total_s": 8790.53318619728, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8790.53318619728, "timesteps_since_restore": 1136000, "iterations_since_restore": 284, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.589147286821698, "episode_len_mean": 30.651162790697676, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.196382428940566}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.570182512602609, "mean_processing_ms": 6.445819482722495, "mean_inference_ms": 0.9928041193398168}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3010688, "num_steps_sampled": 1140000, "sample_time_ms": 7548.506, "load_time_ms": 13.861, "grad_time_ms": 22990.099, "update_time_ms": 32.778, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.005044830497354269, "policy_loss": 0.005038603208959103, "vf_loss": 6.2244133949279785, "vf_explained_var": 0.20923246443271637, "kl": 0.0025059403851628304, "entropy": 0.10824154317378998, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1140000, "episodes_total": 32455, "training_iteration": 285, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-09-20", "timestamp": 1581509360, "time_this_iter_s": 30.285430431365967, "time_total_s": 8820.818616628647, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204a60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8820.818616628647, "timesteps_since_restore": 1140000, "iterations_since_restore": 285, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.6074074074074, "episode_len_mean": 30.044444444444444, "episodes_this_iter": 135, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.151589242053787}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5642830751312315, "mean_processing_ms": 6.449080647523313, "mean_inference_ms": 0.9928942290883518}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3021440, "num_steps_sampled": 1144000, "sample_time_ms": 7590.343, "load_time_ms": 13.798, "grad_time_ms": 22988.803, "update_time_ms": 32.683, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00537883723154664, "policy_loss": -0.005385352298617363, "vf_loss": 6.516819477081299, "vf_explained_var": 0.19967776536941528, "kl": 0.0085900342091918, "entropy": 0.12159956246614456, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1144000, "episodes_total": 32590, "training_iteration": 286, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-09-52", "timestamp": 1581509392, "time_this_iter_s": 31.538843393325806, "time_total_s": 8852.357460021973, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8852.357460021973, "timesteps_since_restore": 1144000, "iterations_since_restore": 286, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.13057851239668, "episode_len_mean": 32.743801652892564, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.421666666666663}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5702503253898055, "mean_processing_ms": 6.445637130792709, "mean_inference_ms": 0.9933058242201868}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3031552, "num_steps_sampled": 1148000, "sample_time_ms": 7573.445, "load_time_ms": 14.322, "grad_time_ms": 22931.112, "update_time_ms": 32.481, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011970738880336285, "policy_loss": -0.011977015063166618, "vf_loss": 6.275794982910156, "vf_explained_var": 0.2284536510705948, "kl": 0.0030240113846957684, "entropy": 0.10618682205677032, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1148000, "episodes_total": 32711, "training_iteration": 287, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-10-22", "timestamp": 1581509422, "time_this_iter_s": 29.553831100463867, "time_total_s": 8881.911291122437, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8881.911291122437, "timesteps_since_restore": 1148000, "iterations_since_restore": 287, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.289230769230757, "episode_len_mean": 29.661538461538463, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.070408163265304}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.566624286339941, "mean_processing_ms": 6.462140846596746, "mean_inference_ms": 0.9919712365269556}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3042176, "num_steps_sampled": 1152000, "sample_time_ms": 7558.822, "load_time_ms": 13.766, "grad_time_ms": 22906.183, "update_time_ms": 32.34, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.034369997680187225, "policy_loss": -0.03437667340040207, "vf_loss": 6.670396327972412, "vf_explained_var": 0.23476596176624298, "kl": 0.0030384825076907873, "entropy": 0.12330057471990585, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1152000, "episodes_total": 32841, "training_iteration": 288, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-10-53", "timestamp": 1581509453, "time_this_iter_s": 30.88472056388855, "time_total_s": 8912.796011686325, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8912.796011686325, "timesteps_since_restore": 1152000, "iterations_since_restore": 288, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.00615384615384, "episode_len_mean": 32.06923076923077, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.582828282828278}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.56344311831586, "mean_processing_ms": 6.456116699281107, "mean_inference_ms": 0.9921637339705788}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3053056, "num_steps_sampled": 1156000, "sample_time_ms": 7584.402, "load_time_ms": 13.686, "grad_time_ms": 22985.223, "update_time_ms": 32.366, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.009515837766230106, "policy_loss": 0.00950944609940052, "vf_loss": 6.393300533294678, "vf_explained_var": 0.20137235522270203, "kl": 0.001722927438095212, "entropy": 0.09758603572845459, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1156000, "episodes_total": 32971, "training_iteration": 289, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-11-25", "timestamp": 1581509485, "time_this_iter_s": 31.33958411216736, "time_total_s": 8944.135595798492, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244fa60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8944.135595798492, "timesteps_since_restore": 1156000, "iterations_since_restore": 289, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.759016393442607, "episode_len_mean": 32.68032786885246, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.452266666666664}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.566663711867931, "mean_processing_ms": 6.462252428943505, "mean_inference_ms": 0.9923442616550443}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3063680, "num_steps_sampled": 1160000, "sample_time_ms": 7554.127, "load_time_ms": 14.472, "grad_time_ms": 23012.306, "update_time_ms": 32.126, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.004461024887859821, "policy_loss": 0.004453986417502165, "vf_loss": 7.041834831237793, "vf_explained_var": 0.20685958862304688, "kl": 0.008569908328354359, "entropy": 0.11212395131587982, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1160000, "episodes_total": 33093, "training_iteration": 290, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-11-56", "timestamp": 1581509516, "time_this_iter_s": 30.55268383026123, "time_total_s": 8974.688279628754, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a9d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8974.688279628754, "timesteps_since_restore": 1160000, "iterations_since_restore": 290, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -38.80000000000001, "episode_reward_mean": -15.40153846153845, "episode_len_mean": 30.784615384615385, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.160309278350512}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.57283297943682, "mean_processing_ms": 6.459621804252012, "mean_inference_ms": 0.9929410470733719}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3074048, "num_steps_sampled": 1164000, "sample_time_ms": 7595.841, "load_time_ms": 13.922, "grad_time_ms": 22996.485, "update_time_ms": 32.165, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.006691562477499247, "policy_loss": -0.006697622127830982, "vf_loss": 6.06129264831543, "vf_explained_var": 0.22725437581539154, "kl": 0.00391077995300293, "entropy": 0.12864898145198822, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1164000, "episodes_total": 33223, "training_iteration": 291, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-12-26", "timestamp": 1581509546, "time_this_iter_s": 30.52181386947632, "time_total_s": 9005.21009349823, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9005.21009349823, "timesteps_since_restore": 1164000, "iterations_since_restore": 291, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.349999999999994, "episode_len_mean": 31.40625, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.366153846153842}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.573806400076357, "mean_processing_ms": 6.4782220754750615, "mean_inference_ms": 0.9925700988595638}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3084800, "num_steps_sampled": 1168000, "sample_time_ms": 7512.86, "load_time_ms": 13.866, "grad_time_ms": 23133.172, "update_time_ms": 32.526, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.026406316086649895, "policy_loss": -0.02641255035996437, "vf_loss": 6.236147403717041, "vf_explained_var": 0.20774208009243011, "kl": 0.0031249690800905228, "entropy": 0.10315721482038498, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1168000, "episodes_total": 33351, "training_iteration": 292, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-12-58", "timestamp": 1581509578, "time_this_iter_s": 31.35506010055542, "time_total_s": 9036.565153598785, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b3871e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9036.565153598785, "timesteps_since_restore": 1168000, "iterations_since_restore": 292, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.419548872180442, "episode_len_mean": 30.157894736842106, "episodes_this_iter": 133, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.271979434447298}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.568801577478175, "mean_processing_ms": 6.475515163908168, "mean_inference_ms": 0.9922313849311533}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3095296, "num_steps_sampled": 1172000, "sample_time_ms": 7510.577, "load_time_ms": 14.514, "grad_time_ms": 23130.834, "update_time_ms": 32.318, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.021976785734295845, "policy_loss": 0.02197050116956234, "vf_loss": 6.282380104064941, "vf_explained_var": 0.22250738739967346, "kl": 0.004584433976560831, "entropy": 0.13122232258319855, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1172000, "episodes_total": 33484, "training_iteration": 293, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-13-29", "timestamp": 1581509609, "time_this_iter_s": 30.745344877243042, "time_total_s": 9067.310498476028, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9067.310498476028, "timesteps_since_restore": 1172000, "iterations_since_restore": 293, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.08217054263565, "episode_len_mean": 30.550387596899224, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.445144356955376}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.575728059495829, "mean_processing_ms": 6.4588121402414505, "mean_inference_ms": 0.9926384884891217}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3106176, "num_steps_sampled": 1176000, "sample_time_ms": 7569.392, "load_time_ms": 13.893, "grad_time_ms": 23219.821, "update_time_ms": 32.289, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.016625849530100822, "policy_loss": -0.016632763668894768, "vf_loss": 6.905282020568848, "vf_explained_var": 0.19746074080467224, "kl": 0.004067461937665939, "entropy": 0.142960324883461, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1176000, "episodes_total": 33613, "training_iteration": 294, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-14-01", "timestamp": 1581509641, "time_this_iter_s": 31.745982885360718, "time_total_s": 9099.05648136139, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264f28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9099.05648136139, "timesteps_since_restore": 1176000, "iterations_since_restore": 294, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.898484848484841, "episode_len_mean": 30.083333333333332, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.272864321608036}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.579423452367903, "mean_processing_ms": 6.465527422828425, "mean_inference_ms": 0.993277373621393}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3117056, "num_steps_sampled": 1180000, "sample_time_ms": 7586.79, "load_time_ms": 13.754, "grad_time_ms": 23313.853, "update_time_ms": 32.646, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.012511026114225388, "policy_loss": -0.012517547234892845, "vf_loss": 6.51932430267334, "vf_explained_var": 0.23579250276088715, "kl": 0.0023273357655853033, "entropy": 0.1181265115737915, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1180000, "episodes_total": 33745, "training_iteration": 295, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-14-33", "timestamp": 1581509673, "time_this_iter_s": 31.401663780212402, "time_total_s": 9130.458145141602, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9130.458145141602, "timesteps_since_restore": 1180000, "iterations_since_restore": 295, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.543624161073817, "episode_len_mean": 27.06040268456376, "episodes_this_iter": 149, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.524663677130043}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.562040156557111, "mean_processing_ms": 6.4671598069887155, "mean_inference_ms": 0.993300780384156}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3127552, "num_steps_sampled": 1184000, "sample_time_ms": 7657.436, "load_time_ms": 14.341, "grad_time_ms": 23256.191, "update_time_ms": 32.536, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.013813741505146027, "policy_loss": -0.013820398598909378, "vf_loss": 6.656867980957031, "vf_explained_var": 0.14568506181240082, "kl": 0.03138265013694763, "entropy": 0.145216703414917, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1184000, "episodes_total": 33894, "training_iteration": 296, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-15-05", "timestamp": 1581509705, "time_this_iter_s": 31.67271852493286, "time_total_s": 9162.130863666534, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9162.130863666534, "timesteps_since_restore": 1184000, "iterations_since_restore": 296, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.33333333333332, "episode_len_mean": 31.984126984126984, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.401574803149604}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.567142487074087, "mean_processing_ms": 6.47631177234192, "mean_inference_ms": 0.9925335822067795}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3138048, "num_steps_sampled": 1188000, "sample_time_ms": 7623.565, "load_time_ms": 14.098, "grad_time_ms": 23350.531, "update_time_ms": 32.886, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.033950719982385635, "policy_loss": -0.03395695611834526, "vf_loss": 6.230721473693848, "vf_explained_var": 0.16772831976413727, "kl": 0.005589831620454788, "entropy": 0.15216122567653656, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1188000, "episodes_total": 34020, "training_iteration": 297, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-15-36", "timestamp": 1581509736, "time_this_iter_s": 30.159975290298462, "time_total_s": 9192.290838956833, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9192.290838956833, "timesteps_since_restore": 1188000, "iterations_since_restore": 297, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.948387096774187, "episode_len_mean": 31.967741935483872, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.487206266318535}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.560696894363121, "mean_processing_ms": 6.479164749524546, "mean_inference_ms": 0.9928582724817862}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3148928, "num_steps_sampled": 1192000, "sample_time_ms": 7677.935, "load_time_ms": 14.04, "grad_time_ms": 23392.487, "update_time_ms": 32.901, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00712480628862977, "policy_loss": -0.007131288293749094, "vf_loss": 6.481060981750488, "vf_explained_var": 0.19964011013507843, "kl": 0.007582494057714939, "entropy": 0.11678682267665863, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1192000, "episodes_total": 34144, "training_iteration": 298, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-16-08", "timestamp": 1581509768, "time_this_iter_s": 31.851184844970703, "time_total_s": 9224.142023801804, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9224.142023801804, "timesteps_since_restore": 1192000, "iterations_since_restore": 298, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.281481481481471, "episode_len_mean": 29.48148148148148, "episodes_this_iter": 135, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.0687960687960665}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5722291272078674, "mean_processing_ms": 6.482585033714388, "mean_inference_ms": 0.9924300689401367}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3159680, "num_steps_sampled": 1196000, "sample_time_ms": 7752.077, "load_time_ms": 15.098, "grad_time_ms": 23378.124, "update_time_ms": 32.935, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0032948567532002926, "policy_loss": -0.0033013157080858946, "vf_loss": 6.459187030792236, "vf_explained_var": 0.20079615712165833, "kl": 0.0025260813999921083, "entropy": 0.11242779344320297, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1196000, "episodes_total": 34279, "training_iteration": 299, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-16-40", "timestamp": 1581509800, "time_this_iter_s": 31.94948720932007, "time_total_s": 9256.091511011124, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9256.091511011124, "timesteps_since_restore": 1196000, "iterations_since_restore": 299, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.36984126984126, "episode_len_mean": 32.08730158730159, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.413648293963252}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5714762125320565, "mean_processing_ms": 6.49234941583736, "mean_inference_ms": 0.9923562643758342}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3170176, "num_steps_sampled": 1200000, "sample_time_ms": 7782.139, "load_time_ms": 14.597, "grad_time_ms": 23348.95, "update_time_ms": 32.762, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0053855422884225845, "policy_loss": 0.005379298701882362, "vf_loss": 6.2412543296813965, "vf_explained_var": 0.20703178644180298, "kl": 0.004013692028820515, "entropy": 0.10679315775632858, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1200000, "episodes_total": 34405, "training_iteration": 300, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-17-11", "timestamp": 1581509831, "time_this_iter_s": 30.553199529647827, "time_total_s": 9286.644710540771, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9286.644710540771, "timesteps_since_restore": 1200000, "iterations_since_restore": 300, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.233576642335759, "episode_len_mean": 29.40875912408759, "episodes_this_iter": 137, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.004796163069541}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.579086993454529, "mean_processing_ms": 6.491246076876697, "mean_inference_ms": 0.9930213165652667}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3180928, "num_steps_sampled": 1204000, "sample_time_ms": 7793.959, "load_time_ms": 14.575, "grad_time_ms": 23436.322, "update_time_ms": 32.634, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.008970445021986961, "policy_loss": 0.008964256383478642, "vf_loss": 6.191898822784424, "vf_explained_var": 0.19564111530780792, "kl": 0.003214990021660924, "entropy": 0.11875587701797485, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1204000, "episodes_total": 34542, "training_iteration": 301, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-17-43", "timestamp": 1581509863, "time_this_iter_s": 31.511054754257202, "time_total_s": 9318.155765295029, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3d90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9318.155765295029, "timesteps_since_restore": 1204000, "iterations_since_restore": 301, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.458992805755388, "episode_len_mean": 28.618705035971225, "episodes_this_iter": 139, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.717840375586853}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.577710739000552, "mean_processing_ms": 6.491396775214809, "mean_inference_ms": 0.9932298810550817}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3191424, "num_steps_sampled": 1208000, "sample_time_ms": 7813.192, "load_time_ms": 15.209, "grad_time_ms": 23374.034, "update_time_ms": 32.317, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.012970097362995148, "policy_loss": 0.012963543646037579, "vf_loss": 6.551697731018066, "vf_explained_var": 0.2297368347644806, "kl": 0.0019262422574684024, "entropy": 0.11731025576591492, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1208000, "episodes_total": 34681, "training_iteration": 302, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-18-14", "timestamp": 1581509894, "time_this_iter_s": 30.926939964294434, "time_total_s": 9349.082705259323, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9349.082705259323, "timesteps_since_restore": 1208000, "iterations_since_restore": 302, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.1953488372093, "episode_len_mean": 31.046511627906977, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.329591836734691}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.574634306599627, "mean_processing_ms": 6.49212416350487, "mean_inference_ms": 0.992933965883492}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3202176, "num_steps_sampled": 1212000, "sample_time_ms": 7753.633, "load_time_ms": 14.568, "grad_time_ms": 23423.246, "update_time_ms": 32.369, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.008176186122000217, "policy_loss": 0.008169824257493019, "vf_loss": 6.3590312004089355, "vf_explained_var": 0.22004595398902893, "kl": 0.004117877222597599, "entropy": 0.09204837679862976, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1212000, "episodes_total": 34810, "training_iteration": 303, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-18-45", "timestamp": 1581509925, "time_this_iter_s": 30.637335777282715, "time_total_s": 9379.720041036606, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9379.720041036606, "timesteps_since_restore": 1212000, "iterations_since_restore": 303, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.091743119266038, "episode_len_mean": 36.559633027522935, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.193452380952377}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.569301353434024, "mean_processing_ms": 6.500780858939118, "mean_inference_ms": 0.9920655714757637}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3212800, "num_steps_sampled": 1216000, "sample_time_ms": 7722.941, "load_time_ms": 14.616, "grad_time_ms": 23348.505, "update_time_ms": 32.39, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04090556874871254, "policy_loss": -0.04091209918260574, "vf_loss": 6.535618782043457, "vf_explained_var": 0.15086187422275543, "kl": 0.002103653270751238, "entropy": 0.07350476831197739, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1216000, "episodes_total": 34919, "training_iteration": 304, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-19-16", "timestamp": 1581509956, "time_this_iter_s": 30.69121217727661, "time_total_s": 9410.411253213882, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9410.411253213882, "timesteps_since_restore": 1216000, "iterations_since_restore": 304, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.547663551401865, "episode_len_mean": 37.94392523364486, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.504733727810646}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.57696529020617, "mean_processing_ms": 6.493465030599058, "mean_inference_ms": 0.9930730673215565}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3223808, "num_steps_sampled": 1220000, "sample_time_ms": 7647.194, "load_time_ms": 15.348, "grad_time_ms": 23399.478, "update_time_ms": 31.915, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.010249843820929527, "policy_loss": 0.010243294760584831, "vf_loss": 6.547950744628906, "vf_explained_var": 0.13860662281513214, "kl": 0.004828761797398329, "entropy": 0.061469826847314835, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1220000, "episodes_total": 35026, "training_iteration": 305, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-19-48", "timestamp": 1581509988, "time_this_iter_s": 31.157227516174316, "time_total_s": 9441.568480730057, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a0d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9441.568480730057, "timesteps_since_restore": 1220000, "iterations_since_restore": 305, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.650819672131142, "episode_len_mean": 31.78688524590164, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.52010869565217}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5683695101730075, "mean_processing_ms": 6.488527746813169, "mean_inference_ms": 0.993843836462531}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3234560, "num_steps_sampled": 1224000, "sample_time_ms": 7618.472, "load_time_ms": 14.81, "grad_time_ms": 23435.336, "update_time_ms": 32.451, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.026393728330731392, "policy_loss": -0.026401106268167496, "vf_loss": 7.381314277648926, "vf_explained_var": 0.19103293120861053, "kl": 0.002399148652330041, "entropy": 0.06859888136386871, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1224000, "episodes_total": 35148, "training_iteration": 306, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-20-20", "timestamp": 1581510020, "time_this_iter_s": 31.744922876358032, "time_total_s": 9473.313403606415, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204ea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9473.313403606415, "timesteps_since_restore": 1224000, "iterations_since_restore": 306, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.8311475409836, "episode_len_mean": 33.58196721311475, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.847849462365588}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.569973325969453, "mean_processing_ms": 6.5149668998370345, "mean_inference_ms": 0.9925362128991903}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3245568, "num_steps_sampled": 1228000, "sample_time_ms": 7664.387, "load_time_ms": 14.571, "grad_time_ms": 23553.322, "update_time_ms": 32.476, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004520127084106207, "policy_loss": -0.004526075441390276, "vf_loss": 5.95051908493042, "vf_explained_var": 0.20604351162910461, "kl": 0.00902601145207882, "entropy": 0.09256052225828171, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1228000, "episodes_total": 35270, "training_iteration": 307, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-20-52", "timestamp": 1581510052, "time_this_iter_s": 31.796781539916992, "time_total_s": 9505.110185146332, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7b69d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9505.110185146332, "timesteps_since_restore": 1228000, "iterations_since_restore": 307, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.186046511627904, "episode_len_mean": 30.131782945736433, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.312977099236638}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.55968871418204, "mean_processing_ms": 6.487280814480105, "mean_inference_ms": 0.9932019760365778}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3256576, "num_steps_sampled": 1232000, "sample_time_ms": 7605.928, "load_time_ms": 15.803, "grad_time_ms": 23600.07, "update_time_ms": 32.4, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.012476639822125435, "policy_loss": 0.012469981797039509, "vf_loss": 6.655587196350098, "vf_explained_var": 0.1946830153465271, "kl": 0.0021040227729827166, "entropy": 0.07803583890199661, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1232000, "episodes_total": 35399, "training_iteration": 308, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-21-24", "timestamp": 1581510084, "time_this_iter_s": 31.742284774780273, "time_total_s": 9536.852469921112, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9536.852469921112, "timesteps_since_restore": 1232000, "iterations_since_restore": 308, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.869696969696957, "episode_len_mean": 30.96212121212121, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.210945273631838}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.570091971085782, "mean_processing_ms": 6.505405351867776, "mean_inference_ms": 0.9935179645313091}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3267200, "num_steps_sampled": 1236000, "sample_time_ms": 7570.417, "load_time_ms": 14.856, "grad_time_ms": 23547.528, "update_time_ms": 32.437, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04312938451766968, "policy_loss": -0.04313518851995468, "vf_loss": 5.800934791564941, "vf_explained_var": 0.23500394821166992, "kl": 0.0015979522140696645, "entropy": 0.07129765301942825, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1236000, "episodes_total": 35531, "training_iteration": 309, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-21-56", "timestamp": 1581510116, "time_this_iter_s": 31.061187267303467, "time_total_s": 9567.913657188416, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264d08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9567.913657188416, "timesteps_since_restore": 1236000, "iterations_since_restore": 309, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.842335766423352, "episode_len_mean": 29.124087591240876, "episodes_this_iter": 137, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.9838235294117625}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.574547237747672, "mean_processing_ms": 6.502989923472236, "mean_inference_ms": 0.9928094942138167}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3277824, "num_steps_sampled": 1240000, "sample_time_ms": 7577.812, "load_time_ms": 14.672, "grad_time_ms": 23583.547, "update_time_ms": 32.709, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00195752433501184, "policy_loss": -0.001963886432349682, "vf_loss": 6.359243869781494, "vf_explained_var": 0.23813937604427338, "kl": 0.0017900032689794898, "entropy": 0.07051385194063187, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1240000, "episodes_total": 35668, "training_iteration": 310, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-22-27", "timestamp": 1581510147, "time_this_iter_s": 30.991385221481323, "time_total_s": 9598.905042409897, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9598.905042409897, "timesteps_since_restore": 1240000, "iterations_since_restore": 310, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.265624999999993, "episode_len_mean": 31.203125, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.4218749999999964}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.561545912901216, "mean_processing_ms": 6.512672636848856, "mean_inference_ms": 0.9927211754594637}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3288448, "num_steps_sampled": 1244000, "sample_time_ms": 7529.781, "load_time_ms": 15.382, "grad_time_ms": 23526.703, "update_time_ms": 32.915, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.015202612616121769, "policy_loss": 0.01519571989774704, "vf_loss": 6.890397548675537, "vf_explained_var": 0.21997399628162384, "kl": 0.0026761703193187714, "entropy": 0.07276030629873276, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1244000, "episodes_total": 35796, "training_iteration": 311, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-22-58", "timestamp": 1581510178, "time_this_iter_s": 30.472357034683228, "time_total_s": 9629.37739944458, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac880d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9629.37739944458, "timesteps_since_restore": 1244000, "iterations_since_restore": 311, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.088888888888881, "episode_len_mean": 29.31111111111111, "episodes_this_iter": 135, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.956204379562042}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.568497485184602, "mean_processing_ms": 6.508699434926375, "mean_inference_ms": 0.9928292197424786}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3299328, "num_steps_sampled": 1248000, "sample_time_ms": 7510.761, "load_time_ms": 14.879, "grad_time_ms": 23626.0, "update_time_ms": 32.789, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.018878081813454628, "policy_loss": 0.018871434032917023, "vf_loss": 6.652040004730225, "vf_explained_var": 0.29062342643737793, "kl": 0.006480800453573465, "entropy": 0.0997815728187561, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1248000, "episodes_total": 35931, "training_iteration": 312, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-23-30", "timestamp": 1581510210, "time_this_iter_s": 31.72483730316162, "time_total_s": 9661.102236747742, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88ea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9661.102236747742, "timesteps_since_restore": 1248000, "iterations_since_restore": 312, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.311267605633805, "episode_len_mean": 28.183098591549296, "episodes_this_iter": 142, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.044547563805102}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.567256596505047, "mean_processing_ms": 6.516466723394392, "mean_inference_ms": 0.9930539970185742}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3310336, "num_steps_sampled": 1252000, "sample_time_ms": 7617.821, "load_time_ms": 14.993, "grad_time_ms": 23685.853, "update_time_ms": 32.761, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.013775672763586044, "policy_loss": -0.013781857676804066, "vf_loss": 6.184471130371094, "vf_explained_var": 0.2273012399673462, "kl": 0.0031749792397022247, "entropy": 0.05696126073598862, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1252000, "episodes_total": 36073, "training_iteration": 313, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-24-03", "timestamp": 1581510243, "time_this_iter_s": 32.30749297142029, "time_total_s": 9693.409729719162, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88d08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9693.409729719162, "timesteps_since_restore": 1252000, "iterations_since_restore": 313, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.705970149253734, "episode_len_mean": 30.46268656716418, "episodes_this_iter": 134, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.473349633251831}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.574143166623334, "mean_processing_ms": 6.504591231475356, "mean_inference_ms": 0.9935027780542698}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3321728, "num_steps_sampled": 1256000, "sample_time_ms": 7655.743, "load_time_ms": 15.812, "grad_time_ms": 23879.896, "update_time_ms": 32.656, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013603807426989079, "policy_loss": 0.013597586192190647, "vf_loss": 6.219175338745117, "vf_explained_var": 0.248430535197258, "kl": 0.0019736355170607567, "entropy": 0.058779701590538025, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1256000, "episodes_total": 36207, "training_iteration": 314, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-24-36", "timestamp": 1581510276, "time_this_iter_s": 33.018879890441895, "time_total_s": 9726.428609609604, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387c80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9726.428609609604, "timesteps_since_restore": 1256000, "iterations_since_restore": 314, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.34531249999999, "episode_len_mean": 30.8984375, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.2833333333333306}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.579524887409165, "mean_processing_ms": 6.511298482032303, "mean_inference_ms": 0.9935395876317759}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3332608, "num_steps_sampled": 1260000, "sample_time_ms": 7810.11, "load_time_ms": 15.122, "grad_time_ms": 23915.253, "update_time_ms": 32.905, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.009372528642416, "policy_loss": 0.009365743026137352, "vf_loss": 6.786526203155518, "vf_explained_var": 0.22657865285873413, "kl": 0.009336413815617561, "entropy": 0.07223132252693176, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1260000, "episodes_total": 36335, "training_iteration": 315, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-25-09", "timestamp": 1581510309, "time_this_iter_s": 33.0499062538147, "time_total_s": 9759.478515863419, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b3879d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9759.478515863419, "timesteps_since_restore": 1260000, "iterations_since_restore": 315, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.294285714285706, "episode_len_mean": 28.228571428571428, "episodes_this_iter": 140, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.697652582159622}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5655294656078516, "mean_processing_ms": 6.515952621469341, "mean_inference_ms": 0.993514568052759}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3343104, "num_steps_sampled": 1264000, "sample_time_ms": 7822.037, "load_time_ms": 15.063, "grad_time_ms": 23829.433, "update_time_ms": 32.552, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.006179992575198412, "policy_loss": -0.006186117418110371, "vf_loss": 6.1251044273376465, "vf_explained_var": 0.23487240076065063, "kl": 0.006988446693867445, "entropy": 0.08718841522932053, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1264000, "episodes_total": 36475, "training_iteration": 316, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-25-41", "timestamp": 1581510341, "time_this_iter_s": 31.001242876052856, "time_total_s": 9790.479758739471, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9790.479758739471, "timesteps_since_restore": 1264000, "iterations_since_restore": 316, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.282269503546084, "episode_len_mean": 29.25531914893617, "episodes_this_iter": 141, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.716159250585479}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.565463291108702, "mean_processing_ms": 6.523437380100443, "mean_inference_ms": 0.9928481620078377}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3353216, "num_steps_sampled": 1268000, "sample_time_ms": 7808.847, "load_time_ms": 15.585, "grad_time_ms": 23611.974, "update_time_ms": 31.978, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.046586357057094574, "policy_loss": -0.046591851860284805, "vf_loss": 5.498308181762695, "vf_explained_var": 0.2520488202571869, "kl": 0.0016339621506631374, "entropy": 0.07035776227712631, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1268000, "episodes_total": 36616, "training_iteration": 317, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-26-10", "timestamp": 1581510370, "time_this_iter_s": 29.488656520843506, "time_total_s": 9819.968415260315, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9819.968415260315, "timesteps_since_restore": 1268000, "iterations_since_restore": 317, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.968749999999991, "episode_len_mean": 30.8203125, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.174683544303794}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.566766357402955, "mean_processing_ms": 6.526822160109592, "mean_inference_ms": 0.9927427274010537}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3363840, "num_steps_sampled": 1272000, "sample_time_ms": 7812.637, "load_time_ms": 14.611, "grad_time_ms": 23513.59, "update_time_ms": 32.23, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.024990765377879143, "policy_loss": -0.02499668300151825, "vf_loss": 5.918041229248047, "vf_explained_var": 0.2655579745769501, "kl": 0.0020150765776634216, "entropy": 0.0683787614107132, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1272000, "episodes_total": 36744, "training_iteration": 318, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-26-42", "timestamp": 1581510402, "time_this_iter_s": 30.78827691078186, "time_total_s": 9850.756692171097, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9850.756692171097, "timesteps_since_restore": 1272000, "iterations_since_restore": 318, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.61241379310344, "episode_len_mean": 27.517241379310345, "episodes_this_iter": 145, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.644235294117645}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.566065877073726, "mean_processing_ms": 6.516752266083967, "mean_inference_ms": 0.9933574024031361}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3374208, "num_steps_sampled": 1276000, "sample_time_ms": 7814.65, "load_time_ms": 14.427, "grad_time_ms": 23480.424, "update_time_ms": 31.982, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0011813428718596697, "policy_loss": -0.0011872116010636091, "vf_loss": 5.86746072769165, "vf_explained_var": 0.268791139125824, "kl": 0.005668440833687782, "entropy": 0.09060150384902954, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1276000, "episodes_total": 36889, "training_iteration": 319, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-27-13", "timestamp": 1581510433, "time_this_iter_s": 30.741495609283447, "time_total_s": 9881.49818778038, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204d90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9881.49818778038, "timesteps_since_restore": 1276000, "iterations_since_restore": 319, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.796992481202997, "episode_len_mean": 30.18045112781955, "episodes_this_iter": 133, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.907730673316706}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.565452377930235, "mean_processing_ms": 6.512617843138943, "mean_inference_ms": 0.993380714468594}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3384448, "num_steps_sampled": 1280000, "sample_time_ms": 7789.207, "load_time_ms": 14.945, "grad_time_ms": 23407.998, "update_time_ms": 31.985, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.012536892667412758, "policy_loss": 0.012530696578323841, "vf_loss": 6.198699951171875, "vf_explained_var": 0.23240704834461212, "kl": 0.007624384947121143, "entropy": 0.09346965700387955, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1280000, "episodes_total": 37022, "training_iteration": 320, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-27-43", "timestamp": 1581510463, "time_this_iter_s": 30.015077829360962, "time_total_s": 9911.513265609741, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b2041e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9911.513265609741, "timesteps_since_restore": 1280000, "iterations_since_restore": 320, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.646399999999991, "episode_len_mean": 31.36, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.271698113207544}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.565426777747933, "mean_processing_ms": 6.531380590906238, "mean_inference_ms": 0.9924312858574603}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3394688, "num_steps_sampled": 1284000, "sample_time_ms": 7796.588, "load_time_ms": 14.198, "grad_time_ms": 23364.358, "update_time_ms": 31.862, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01327961403876543, "policy_loss": 0.013273412361741066, "vf_loss": 6.199943542480469, "vf_explained_var": 0.23653583228588104, "kl": 0.0019914465956389904, "entropy": 0.0830129086971283, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1284000, "episodes_total": 37147, "training_iteration": 321, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-28-14", "timestamp": 1581510494, "time_this_iter_s": 30.10189986228943, "time_total_s": 9941.61516547203, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9941.61516547203, "timesteps_since_restore": 1284000, "iterations_since_restore": 321, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.980327868852447, "episode_len_mean": 32.24590163934426, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.445810055865918}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.559780827752801, "mean_processing_ms": 6.532123295329311, "mean_inference_ms": 0.9923575297295828}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3404928, "num_steps_sampled": 1288000, "sample_time_ms": 7704.713, "load_time_ms": 14.108, "grad_time_ms": 23227.486, "update_time_ms": 31.927, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.002669255482032895, "policy_loss": -0.0026759891770780087, "vf_loss": 6.732897758483887, "vf_explained_var": 0.2266375571489334, "kl": 0.002047790214419365, "entropy": 0.06803132593631744, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1288000, "episodes_total": 37269, "training_iteration": 322, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-28-43", "timestamp": 1581510523, "time_this_iter_s": 29.436770915985107, "time_total_s": 9971.051936388016, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8957b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9971.051936388016, "timesteps_since_restore": 1288000, "iterations_since_restore": 322, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.03870967741934, "episode_len_mean": 33.20161290322581, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.604244031830236}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.562404315838203, "mean_processing_ms": 6.529338280882523, "mean_inference_ms": 0.9933609381712595}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3415552, "num_steps_sampled": 1292000, "sample_time_ms": 7638.473, "load_time_ms": 14.654, "grad_time_ms": 23130.394, "update_time_ms": 31.888, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0041486420668661594, "policy_loss": 0.004142262041568756, "vf_loss": 6.377608299255371, "vf_explained_var": 0.23562362790107727, "kl": 0.002479461720213294, "entropy": 0.09200464934110641, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1292000, "episodes_total": 37393, "training_iteration": 323, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-29-14", "timestamp": 1581510554, "time_this_iter_s": 30.679951667785645, "time_total_s": 10001.731888055801, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b895730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10001.731888055801, "timesteps_since_restore": 1292000, "iterations_since_restore": 323, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.248611111111106, "episode_len_mean": 27.770833333333332, "episodes_this_iter": 144, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.749537037037034}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.566899622181527, "mean_processing_ms": 6.537608877119717, "mean_inference_ms": 0.9926331447823316}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3426176, "num_steps_sampled": 1296000, "sample_time_ms": 7646.72, "load_time_ms": 13.844, "grad_time_ms": 22955.716, "update_time_ms": 31.927, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03703999146819115, "policy_loss": -0.037046078592538834, "vf_loss": 6.08863639831543, "vf_explained_var": 0.21850116550922394, "kl": 0.003699923399835825, "entropy": 0.11308899521827698, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1296000, "episodes_total": 37537, "training_iteration": 324, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-29-46", "timestamp": 1581510586, "time_this_iter_s": 31.348017930984497, "time_total_s": 10033.079905986786, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10033.079905986786, "timesteps_since_restore": 1296000, "iterations_since_restore": 324, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.839999999999993, "episode_len_mean": 29.081481481481482, "episodes_this_iter": 135, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.946666666666664}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.564408983090311, "mean_processing_ms": 6.531240502175728, "mean_inference_ms": 0.9928269106646397}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3436800, "num_steps_sampled": 1300000, "sample_time_ms": 7548.986, "load_time_ms": 13.876, "grad_time_ms": 22856.394, "update_time_ms": 32.143, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.002640546765178442, "policy_loss": -0.002647388493642211, "vf_loss": 6.844272136688232, "vf_explained_var": 0.24769015610218048, "kl": 0.00324427941814065, "entropy": 0.09138588607311249, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1300000, "episodes_total": 37672, "training_iteration": 325, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-30-17", "timestamp": 1581510617, "time_this_iter_s": 31.0827534198761, "time_total_s": 10064.162659406662, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88bf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10064.162659406662, "timesteps_since_restore": 1300000, "iterations_since_restore": 325, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.430985915492954, "episode_len_mean": 29.1056338028169, "episodes_this_iter": 142, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.890692124105009}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.568307310716252, "mean_processing_ms": 6.527394879179575, "mean_inference_ms": 0.9936193623217892}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3447040, "num_steps_sampled": 1304000, "sample_time_ms": 7576.533, "load_time_ms": 14.347, "grad_time_ms": 22819.044, "update_time_ms": 32.302, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0690959170460701, "policy_loss": -0.06910181045532227, "vf_loss": 5.891972541809082, "vf_explained_var": 0.25832825899124146, "kl": 0.004354599863290787, "entropy": 0.10410018265247345, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1304000, "episodes_total": 37814, "training_iteration": 326, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-30-49", "timestamp": 1581510649, "time_this_iter_s": 30.908858060836792, "time_total_s": 10095.071517467499, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b2049d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10095.071517467499, "timesteps_since_restore": 1304000, "iterations_since_restore": 326, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.866115702479325, "episode_len_mean": 31.917355371900825, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.288705234159777}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.566403854851413, "mean_processing_ms": 6.553331382561605, "mean_inference_ms": 0.9925833472990041}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3457280, "num_steps_sampled": 1308000, "sample_time_ms": 7555.713, "load_time_ms": 13.914, "grad_time_ms": 22857.005, "update_time_ms": 32.47, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.041758619248867035, "policy_loss": -0.04176504164934158, "vf_loss": 6.416293144226074, "vf_explained_var": 0.2185123860836029, "kl": 0.00664124358445406, "entropy": 0.06842748820781708, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1308000, "episodes_total": 37935, "training_iteration": 327, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-31-19", "timestamp": 1581510679, "time_this_iter_s": 29.657124757766724, "time_total_s": 10124.728642225266, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10124.728642225266, "timesteps_since_restore": 1308000, "iterations_since_restore": 327, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.254237288135577, "episode_len_mean": 34.71186440677966, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.53260869565217}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5655723511363435, "mean_processing_ms": 6.552219048538912, "mean_inference_ms": 0.9925024250372554}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3467392, "num_steps_sampled": 1312000, "sample_time_ms": 7526.06, "load_time_ms": 13.601, "grad_time_ms": 22744.593, "update_time_ms": 32.427, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.011499661020934582, "policy_loss": 0.011492964811623096, "vf_loss": 6.697688102722168, "vf_explained_var": 0.1882077306509018, "kl": 0.014171247370541096, "entropy": 0.12865807116031647, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1312000, "episodes_total": 38053, "training_iteration": 328, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-31-49", "timestamp": 1581510709, "time_this_iter_s": 29.364043474197388, "time_total_s": 10154.092685699463, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac889d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10154.092685699463, "timesteps_since_restore": 1312000, "iterations_since_restore": 328, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.971428571428566, "episode_len_mean": 29.977443609022558, "episodes_this_iter": 133, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.131958762886595}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.566028295676041, "mean_processing_ms": 6.545213237697816, "mean_inference_ms": 0.9923183494461842}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3477760, "num_steps_sampled": 1316000, "sample_time_ms": 7435.373, "load_time_ms": 13.554, "grad_time_ms": 22754.731, "update_time_ms": 32.248, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.011677175760269165, "policy_loss": 0.011670566163957119, "vf_loss": 6.614581108093262, "vf_explained_var": 0.24544143676757812, "kl": 0.003471746575087309, "entropy": 0.09800179302692413, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1316000, "episodes_total": 38186, "training_iteration": 329, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-32-19", "timestamp": 1581510739, "time_this_iter_s": 29.935042142868042, "time_total_s": 10184.027727842331, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88e18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10184.027727842331, "timesteps_since_restore": 1316000, "iterations_since_restore": 329, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.894736842105264, "episode_len_mean": 34.3421052631579, "episodes_this_iter": 114, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.136752136752133}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.567730600832037, "mean_processing_ms": 6.541840750302291, "mean_inference_ms": 0.9932498122911476}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3489024, "num_steps_sampled": 1320000, "sample_time_ms": 7420.498, "load_time_ms": 13.758, "grad_time_ms": 22967.902, "update_time_ms": 32.476, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.030686091631650925, "policy_loss": -0.030693041160702705, "vf_loss": 6.946052551269531, "vf_explained_var": 0.1884179562330246, "kl": 0.005582027602940798, "entropy": 0.1354200392961502, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1320000, "episodes_total": 38300, "training_iteration": 330, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-32-51", "timestamp": 1581510771, "time_this_iter_s": 32.001718044281006, "time_total_s": 10216.029445886612, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8f7a60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10216.029445886612, "timesteps_since_restore": 1320000, "iterations_since_restore": 330, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.312781954887207, "episode_len_mean": 30.639097744360903, "episodes_this_iter": 133, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.289870129870128}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.56331376285508, "mean_processing_ms": 6.547556820456626, "mean_inference_ms": 0.9926373334582118}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3499392, "num_steps_sampled": 1324000, "sample_time_ms": 7530.632, "load_time_ms": 13.714, "grad_time_ms": 22966.83, "update_time_ms": 32.514, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.015614045783877373, "policy_loss": -0.015620524063706398, "vf_loss": 6.472743511199951, "vf_explained_var": 0.21293847262859344, "kl": 0.0030258793849498034, "entropy": 0.15013426542282104, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1324000, "episodes_total": 38433, "training_iteration": 331, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-33-23", "timestamp": 1581510803, "time_this_iter_s": 31.191839933395386, "time_total_s": 10247.221285820007, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387f28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10247.221285820007, "timesteps_since_restore": 1324000, "iterations_since_restore": 331, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.442519685039372, "episode_len_mean": 31.874015748031496, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.551879699248118}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.572039336734796, "mean_processing_ms": 6.5459577084928, "mean_inference_ms": 0.9925028516018548}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3510528, "num_steps_sampled": 1328000, "sample_time_ms": 7575.872, "load_time_ms": 13.722, "grad_time_ms": 23165.043, "update_time_ms": 33.542, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.012826993130147457, "policy_loss": 0.012820908799767494, "vf_loss": 6.088163375854492, "vf_explained_var": 0.2155900001525879, "kl": 0.0038730045780539513, "entropy": 0.1208215057849884, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1328000, "episodes_total": 38560, "training_iteration": 332, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-33-55", "timestamp": 1581510835, "time_this_iter_s": 31.881332635879517, "time_total_s": 10279.102618455887, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387ae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10279.102618455887, "timesteps_since_restore": 1328000, "iterations_since_restore": 332, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.20483870967741, "episode_len_mean": 32.395161290322584, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.505205479452052}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.562041374867914, "mean_processing_ms": 6.545436554351692, "mean_inference_ms": 0.9927857148865367}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3520896, "num_steps_sampled": 1332000, "sample_time_ms": 7572.613, "load_time_ms": 13.689, "grad_time_ms": 23104.194, "update_time_ms": 33.365, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00549247907474637, "policy_loss": -0.005499145947396755, "vf_loss": 6.671492099761963, "vf_explained_var": 0.2199825644493103, "kl": 0.003610634943470359, "entropy": 0.08254818618297577, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1332000, "episodes_total": 38684, "training_iteration": 333, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-34-26", "timestamp": 1581510866, "time_this_iter_s": 30.035187482833862, "time_total_s": 10309.13780593872, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204ae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10309.13780593872, "timesteps_since_restore": 1332000, "iterations_since_restore": 333, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.184745762711852, "episode_len_mean": 33.46610169491525, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.601657458563532}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.56069250674501, "mean_processing_ms": 6.530089778297165, "mean_inference_ms": 0.992680290776507}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3531392, "num_steps_sampled": 1336000, "sample_time_ms": 7466.739, "load_time_ms": 13.729, "grad_time_ms": 23071.325, "update_time_ms": 33.455, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.008398574776947498, "policy_loss": 0.00839223712682724, "vf_loss": 6.335202693939209, "vf_explained_var": 0.2210347056388855, "kl": 0.0037132035940885544, "entropy": 0.12052631378173828, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1336000, "episodes_total": 38802, "training_iteration": 334, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-34-56", "timestamp": 1581510896, "time_this_iter_s": 29.962371349334717, "time_total_s": 10339.100177288055, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10339.100177288055, "timesteps_since_restore": 1336000, "iterations_since_restore": 334, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.702521008403348, "episode_len_mean": 33.36134453781513, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.598873239436616}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.557505225765903, "mean_processing_ms": 6.533527136411931, "mean_inference_ms": 0.9927117057833521}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3541760, "num_steps_sampled": 1340000, "sample_time_ms": 7444.285, "load_time_ms": 13.618, "grad_time_ms": 23039.291, "update_time_ms": 33.467, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.018070420250296593, "policy_loss": -0.018077120184898376, "vf_loss": 6.699062824249268, "vf_explained_var": 0.19338220357894897, "kl": 0.004838162567466497, "entropy": 0.11939292401075363, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1340000, "episodes_total": 38921, "training_iteration": 335, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-35-27", "timestamp": 1581510927, "time_this_iter_s": 30.536258220672607, "time_total_s": 10369.636435508728, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10369.636435508728, "timesteps_since_restore": 1340000, "iterations_since_restore": 335, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.747058823529407, "episode_len_mean": 29.58823529411765, "episodes_this_iter": 136, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.16048192771084}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.560991450196491, "mean_processing_ms": 6.557634821538993, "mean_inference_ms": 0.9932384018801185}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3552768, "num_steps_sampled": 1344000, "sample_time_ms": 7446.031, "load_time_ms": 13.831, "grad_time_ms": 23187.693, "update_time_ms": 33.636, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.030892282724380493, "policy_loss": 0.030885525047779083, "vf_loss": 6.7652692794799805, "vf_explained_var": 0.2324138730764389, "kl": 0.004796719644218683, "entropy": 0.106694795191288, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1344000, "episodes_total": 39057, "training_iteration": 336, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-36-00", "timestamp": 1581510960, "time_this_iter_s": 32.41326928138733, "time_total_s": 10402.049704790115, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57de18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10402.049704790115, "timesteps_since_restore": 1344000, "iterations_since_restore": 336, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.466101694915242, "episode_len_mean": 34.04237288135593, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.855113636363632}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5643497934518455, "mean_processing_ms": 6.553704206533678, "mean_inference_ms": 0.9926437360823257}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3563264, "num_steps_sampled": 1348000, "sample_time_ms": 7419.815, "load_time_ms": 13.71, "grad_time_ms": 23253.134, "update_time_ms": 33.897, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01990378461778164, "policy_loss": -0.019910160452127457, "vf_loss": 6.375777721405029, "vf_explained_var": 0.1739363968372345, "kl": 0.004637243691831827, "entropy": 0.13049936294555664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1348000, "episodes_total": 39175, "training_iteration": 337, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-36-30", "timestamp": 1581510990, "time_this_iter_s": 30.05357789993286, "time_total_s": 10432.103282690048, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10432.103282690048, "timesteps_since_restore": 1348000, "iterations_since_restore": 337, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.817054263565883, "episode_len_mean": 31.046511627906977, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.397883597883594}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.555860410548341, "mean_processing_ms": 6.5393470985345346, "mean_inference_ms": 0.9929118729454596}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3573888, "num_steps_sampled": 1352000, "sample_time_ms": 7423.22, "load_time_ms": 13.7, "grad_time_ms": 23342.571, "update_time_ms": 33.663, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.019160930067300797, "policy_loss": -0.019167089834809303, "vf_loss": 6.160623073577881, "vf_explained_var": 0.21805165708065033, "kl": 0.0018841353012248874, "entropy": 0.07736687362194061, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1352000, "episodes_total": 39304, "training_iteration": 338, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-37-01", "timestamp": 1581511021, "time_this_iter_s": 30.290428638458252, "time_total_s": 10462.393711328506, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b2046a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10462.393711328506, "timesteps_since_restore": 1352000, "iterations_since_restore": 338, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.549999999999994, "episode_len_mean": 31.467741935483872, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.572832369942192}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.554910857750177, "mean_processing_ms": 6.5531099031506415, "mean_inference_ms": 0.9925072737069753}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3584000, "num_steps_sampled": 1356000, "sample_time_ms": 7391.723, "load_time_ms": 14.518, "grad_time_ms": 23262.645, "update_time_ms": 33.909, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0012501089368015528, "policy_loss": -0.0012569400714710355, "vf_loss": 6.831577777862549, "vf_explained_var": 0.20588120818138123, "kl": 0.004353373311460018, "entropy": 0.08146201819181442, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1356000, "episodes_total": 39428, "training_iteration": 339, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-37-30", "timestamp": 1581511050, "time_this_iter_s": 28.830894947052002, "time_total_s": 10491.224606275558, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10491.224606275558, "timesteps_since_restore": 1356000, "iterations_since_restore": 339, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.569841269841262, "episode_len_mean": 32.45238095238095, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.673369565217388}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.558620992020654, "mean_processing_ms": 6.568498675784552, "mean_inference_ms": 0.9914953983638817}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3594496, "num_steps_sampled": 1360000, "sample_time_ms": 7397.148, "load_time_ms": 13.927, "grad_time_ms": 23068.032, "update_time_ms": 33.807, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01744527742266655, "policy_loss": -0.017452405765652657, "vf_loss": 7.127788066864014, "vf_explained_var": 0.17166399955749512, "kl": 0.0028835658449679613, "entropy": 0.09014078229665756, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1360000, "episodes_total": 39554, "training_iteration": 340, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-38-01", "timestamp": 1581511081, "time_this_iter_s": 30.10374093055725, "time_total_s": 10521.328347206116, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10521.328347206116, "timesteps_since_restore": 1360000, "iterations_since_restore": 340, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.551879699248111, "episode_len_mean": 29.909774436090224, "episodes_this_iter": 133, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.18395989974937}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.566095171029917, "mean_processing_ms": 6.539287034769871, "mean_inference_ms": 0.9941485907857351}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3605248, "num_steps_sampled": 1364000, "sample_time_ms": 7402.855, "load_time_ms": 14.202, "grad_time_ms": 23145.437, "update_time_ms": 33.816, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.003452596254646778, "policy_loss": -0.0034587900154292583, "vf_loss": 6.1992716789245605, "vf_explained_var": 0.23436100780963898, "kl": 0.005433111451566219, "entropy": 0.11518527567386627, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1364000, "episodes_total": 39687, "training_iteration": 341, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-38-33", "timestamp": 1581511113, "time_this_iter_s": 32.02450942993164, "time_total_s": 10553.352856636047, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3364596a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10553.352856636047, "timesteps_since_restore": 1364000, "iterations_since_restore": 341, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.309230769230757, "episode_len_mean": 30.553846153846155, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.000502512562812}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5553830418208685, "mean_processing_ms": 6.557781487969243, "mean_inference_ms": 0.9930610931015575}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3615616, "num_steps_sampled": 1368000, "sample_time_ms": 7410.209, "load_time_ms": 14.8, "grad_time_ms": 22958.493, "update_time_ms": 32.881, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0019234184874221683, "policy_loss": 0.0019170783925801516, "vf_loss": 6.338717937469482, "vf_explained_var": 0.22022956609725952, "kl": 0.0041159819811582565, "entropy": 0.11726720631122589, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1368000, "episodes_total": 39817, "training_iteration": 342, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-39-04", "timestamp": 1581511144, "time_this_iter_s": 30.081122636795044, "time_total_s": 10583.433979272842, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10583.433979272842, "timesteps_since_restore": 1368000, "iterations_since_restore": 342, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.592700729926998, "episode_len_mean": 29.204379562043794, "episodes_this_iter": 137, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.960794044665009}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.561882892675901, "mean_processing_ms": 6.5505724848812985, "mean_inference_ms": 0.9923983796992285}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3625856, "num_steps_sampled": 1372000, "sample_time_ms": 7403.003, "load_time_ms": 14.152, "grad_time_ms": 22951.981, "update_time_ms": 33.157, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.025725891813635826, "policy_loss": -0.025732118636369705, "vf_loss": 6.218794345855713, "vf_explained_var": 0.22606590390205383, "kl": 0.00198925007134676, "entropy": 0.0922992154955864, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1372000, "episodes_total": 39954, "training_iteration": 343, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-39-34", "timestamp": 1581511174, "time_this_iter_s": 29.892054796218872, "time_total_s": 10613.326034069061, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3d08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10613.326034069061, "timesteps_since_restore": 1372000, "iterations_since_restore": 343, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.857599999999987, "episode_len_mean": 32.92, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.5893899204244}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.564073403621347, "mean_processing_ms": 6.556330247525264, "mean_inference_ms": 0.9930157723385549}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3636480, "num_steps_sampled": 1376000, "sample_time_ms": 7438.589, "load_time_ms": 13.903, "grad_time_ms": 22990.498, "update_time_ms": 33.118, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00549069931730628, "policy_loss": 0.005484326276928186, "vf_loss": 6.37449836730957, "vf_explained_var": 0.20949462056159973, "kl": 0.0031438814476132393, "entropy": 0.11133754998445511, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1376000, "episodes_total": 40079, "training_iteration": 344, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-40-05", "timestamp": 1581511205, "time_this_iter_s": 30.698208570480347, "time_total_s": 10644.024242639542, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10644.024242639542, "timesteps_since_restore": 1376000, "iterations_since_restore": 344, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.132231404958667, "episode_len_mean": 32.17355371900826, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.577142857142854}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.558091335401402, "mean_processing_ms": 6.577545788421584, "mean_inference_ms": 0.9918753104994356}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3646720, "num_steps_sampled": 1380000, "sample_time_ms": 7432.332, "load_time_ms": 14.696, "grad_time_ms": 22981.393, "update_time_ms": 33.371, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.013570171780884266, "policy_loss": -0.013576683588325977, "vf_loss": 6.511802673339844, "vf_explained_var": 0.21096959710121155, "kl": 0.0027199385222047567, "entropy": 0.07695968449115753, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1380000, "episodes_total": 40200, "training_iteration": 345, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-40-36", "timestamp": 1581511236, "time_this_iter_s": 30.39493680000305, "time_total_s": 10674.419179439545, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387d08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10674.419179439545, "timesteps_since_restore": 1380000, "iterations_since_restore": 345, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.396747967479662, "episode_len_mean": 32.8780487804878, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.649299719887952}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.560886935162985, "mean_processing_ms": 6.561044229791751, "mean_inference_ms": 0.9922556933521367}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3656960, "num_steps_sampled": 1384000, "sample_time_ms": 7267.929, "load_time_ms": 14.175, "grad_time_ms": 22817.666, "update_time_ms": 33.181, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0017704360652714968, "policy_loss": -0.0017767779063433409, "vf_loss": 6.339632987976074, "vf_explained_var": 0.19618138670921326, "kl": 0.0018755877390503883, "entropy": 0.08557572215795517, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1384000, "episodes_total": 40323, "training_iteration": 346, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-41-06", "timestamp": 1581511266, "time_this_iter_s": 29.12600564956665, "time_total_s": 10703.545185089111, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10703.545185089111, "timesteps_since_restore": 1384000, "iterations_since_restore": 346, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -38.400000000000006, "episode_reward_mean": -13.943283582089537, "episode_len_mean": 29.097014925373134, "episodes_this_iter": 134, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.718181818181815}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5561368647201475, "mean_processing_ms": 6.567036595220811, "mean_inference_ms": 0.9923456604223779}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3666944, "num_steps_sampled": 1388000, "sample_time_ms": 7284.96, "load_time_ms": 14.046, "grad_time_ms": 22694.695, "update_time_ms": 32.922, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.07354342192411423, "policy_loss": -0.07354925572872162, "vf_loss": 5.827411651611328, "vf_explained_var": 0.2511272430419922, "kl": 0.004487536381930113, "entropy": 0.0719454437494278, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1388000, "episodes_total": 40457, "training_iteration": 347, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-41-35", "timestamp": 1581511295, "time_this_iter_s": 28.987272024154663, "time_total_s": 10732.532457113266, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10732.532457113266, "timesteps_since_restore": 1388000, "iterations_since_restore": 347, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.47899159663864, "episode_len_mean": 33.88235294117647, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.508426966292131}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.561471813999692, "mean_processing_ms": 6.56245670124737, "mean_inference_ms": 0.9922105004066717}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3676928, "num_steps_sampled": 1392000, "sample_time_ms": 7269.486, "load_time_ms": 14.214, "grad_time_ms": 22595.814, "update_time_ms": 33.242, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03563883528113365, "policy_loss": -0.035644639283418655, "vf_loss": 5.812674522399902, "vf_explained_var": 0.23527541756629944, "kl": 0.003423269372433424, "entropy": 0.07721331715583801, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1392000, "episodes_total": 40576, "training_iteration": 348, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-42-04", "timestamp": 1581511324, "time_this_iter_s": 29.150863885879517, "time_total_s": 10761.683320999146, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b895598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10761.683320999146, "timesteps_since_restore": 1392000, "iterations_since_restore": 348, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.921167883211671, "episode_len_mean": 29.48905109489051, "episodes_this_iter": 137, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -4.9257831325301185}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.56056048085992, "mean_processing_ms": 6.572180386243929, "mean_inference_ms": 0.9920427786211333}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3687424, "num_steps_sampled": 1396000, "sample_time_ms": 7358.989, "load_time_ms": 14.292, "grad_time_ms": 22677.426, "update_time_ms": 33.352, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.034123703837394714, "policy_loss": 0.03411725535988808, "vf_loss": 6.45498514175415, "vf_explained_var": 0.21908333897590637, "kl": 0.00457513052970171, "entropy": 0.08598087728023529, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1396000, "episodes_total": 40713, "training_iteration": 349, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-42-35", "timestamp": 1581511355, "time_this_iter_s": 30.543710708618164, "time_total_s": 10792.227031707764, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10792.227031707764, "timesteps_since_restore": 1396000, "iterations_since_restore": 349, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.628776978417259, "episode_len_mean": 28.60431654676259, "episodes_this_iter": 139, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.864593301435404}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.55483754369043, "mean_processing_ms": 6.569570587966636, "mean_inference_ms": 0.9923694155390451}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3698048, "num_steps_sampled": 1400000, "sample_time_ms": 7387.285, "load_time_ms": 14.181, "grad_time_ms": 22715.471, "update_time_ms": 33.197, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0012935006525367498, "policy_loss": -0.0012998675229027867, "vf_loss": 6.367578029632568, "vf_explained_var": 0.2273315042257309, "kl": 0.0027453447692096233, "entropy": 0.10983622074127197, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1400000, "episodes_total": 40852, "training_iteration": 350, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-43-07", "timestamp": 1581511387, "time_this_iter_s": 30.764818906784058, "time_total_s": 10822.991850614548, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10822.991850614548, "timesteps_since_restore": 1400000, "iterations_since_restore": 350, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.64159999999999, "episode_len_mean": 32.448, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.5471999999999975}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.559397811483251, "mean_processing_ms": 6.580811081162828, "mean_inference_ms": 0.9920305347803493}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3708672, "num_steps_sampled": 1404000, "sample_time_ms": 7261.155, "load_time_ms": 13.94, "grad_time_ms": 22708.932, "update_time_ms": 33.123, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.006443096790462732, "policy_loss": 0.0064369505271315575, "vf_loss": 6.143836975097656, "vf_explained_var": 0.2402176409959793, "kl": 0.001591822481714189, "entropy": 0.08148814737796783, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1404000, "episodes_total": 40977, "training_iteration": 351, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-43-38", "timestamp": 1581511418, "time_this_iter_s": 30.695753812789917, "time_total_s": 10853.687604427338, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88a60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10853.687604427338, "timesteps_since_restore": 1404000, "iterations_since_restore": 351, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.121538461538453, "episode_len_mean": 30.20769230769231, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.146073298429316}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5592232193798345, "mean_processing_ms": 6.583741056626558, "mean_inference_ms": 0.9919849496021168}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3719040, "num_steps_sampled": 1408000, "sample_time_ms": 7258.269, "load_time_ms": 14.022, "grad_time_ms": 22715.299, "update_time_ms": 33.285, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011105600744485855, "policy_loss": -0.011111839674413204, "vf_loss": 6.243082523345947, "vf_explained_var": 0.23334644734859467, "kl": 0.00330727850086987, "entropy": 0.08388575166463852, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1408000, "episodes_total": 41107, "training_iteration": 352, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-44-08", "timestamp": 1581511448, "time_this_iter_s": 30.119423866271973, "time_total_s": 10883.80702829361, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10883.80702829361, "timesteps_since_restore": 1408000, "iterations_since_restore": 352, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.429032258064506, "episode_len_mean": 32.00806451612903, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.332984293193714}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.552991178950809, "mean_processing_ms": 6.581668759749842, "mean_inference_ms": 0.9917155697874683}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3729664, "num_steps_sampled": 1412000, "sample_time_ms": 7276.325, "load_time_ms": 14.016, "grad_time_ms": 22757.259, "update_time_ms": 33.231, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.015723783522844315, "policy_loss": -0.01573055051267147, "vf_loss": 6.770948886871338, "vf_explained_var": 0.19905519485473633, "kl": 0.002857215004041791, "entropy": 0.0749940276145935, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1412000, "episodes_total": 41231, "training_iteration": 353, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-44-39", "timestamp": 1581511479, "time_this_iter_s": 30.49366855621338, "time_total_s": 10914.300696849823, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459a60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10914.300696849823, "timesteps_since_restore": 1412000, "iterations_since_restore": 353, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.131147540983594, "episode_len_mean": 33.15573770491803, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.603217158176942}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.561087138984593, "mean_processing_ms": 6.563311284096546, "mean_inference_ms": 0.9930414081237946}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3740160, "num_steps_sampled": 1416000, "sample_time_ms": 7282.985, "load_time_ms": 14.065, "grad_time_ms": 22726.797, "update_time_ms": 33.141, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0015814290381968021, "policy_loss": -0.0015885321190580726, "vf_loss": 7.096894264221191, "vf_explained_var": 0.2064742147922516, "kl": 0.006769451312720776, "entropy": 0.09139877557754517, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1416000, "episodes_total": 41353, "training_iteration": 354, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-45-10", "timestamp": 1581511510, "time_this_iter_s": 30.46047019958496, "time_total_s": 10944.761167049408, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459f28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10944.761167049408, "timesteps_since_restore": 1416000, "iterations_since_restore": 354, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.559398496240595, "episode_len_mean": 30.31578947368421, "episodes_this_iter": 133, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.097044334975366}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.562986416276654, "mean_processing_ms": 6.586614065857441, "mean_inference_ms": 0.9916341024417259}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3750784, "num_steps_sampled": 1420000, "sample_time_ms": 7333.552, "load_time_ms": 14.006, "grad_time_ms": 22777.888, "update_time_ms": 33.025, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0027442765422165394, "policy_loss": -0.00275066657923162, "vf_loss": 6.390185832977295, "vf_explained_var": 0.2179967761039734, "kl": 0.007671849336475134, "entropy": 0.11483863741159439, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1420000, "episodes_total": 41486, "training_iteration": 355, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-45-42", "timestamp": 1581511542, "time_this_iter_s": 31.40722894668579, "time_total_s": 10976.168395996094, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10976.168395996094, "timesteps_since_restore": 1420000, "iterations_since_restore": 355, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.339999999999993, "episode_len_mean": 33.208333333333336, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.700821917808216}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.548968737130383, "mean_processing_ms": 6.578949517868477, "mean_inference_ms": 0.9925043661760882}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3761536, "num_steps_sampled": 1424000, "sample_time_ms": 7463.537, "load_time_ms": 13.886, "grad_time_ms": 22888.625, "update_time_ms": 33.388, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.005206690169870853, "policy_loss": 0.005199997220188379, "vf_loss": 6.693103790283203, "vf_explained_var": 0.20255513489246368, "kl": 0.003626026678830385, "entropy": 0.12694311141967773, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1424000, "episodes_total": 41606, "training_iteration": 356, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-46-14", "timestamp": 1581511574, "time_this_iter_s": 31.53637170791626, "time_total_s": 11007.70476770401, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11007.70476770401, "timesteps_since_restore": 1424000, "iterations_since_restore": 356, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.05225225225224, "episode_len_mean": 36.027027027027025, "episodes_this_iter": 111, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.294047619047614}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.562298371135322, "mean_processing_ms": 6.589121187060833, "mean_inference_ms": 0.9914938913125156}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3772416, "num_steps_sampled": 1428000, "sample_time_ms": 7472.715, "load_time_ms": 14.101, "grad_time_ms": 23092.953, "update_time_ms": 33.684, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.005576130002737045, "policy_loss": -0.005583170801401138, "vf_loss": 7.036889553070068, "vf_explained_var": 0.16304880380630493, "kl": 0.005280788987874985, "entropy": 0.15654274821281433, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1428000, "episodes_total": 41717, "training_iteration": 357, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-46-45", "timestamp": 1581511605, "time_this_iter_s": 31.1273672580719, "time_total_s": 11038.832134962082, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11038.832134962082, "timesteps_since_restore": 1428000, "iterations_since_restore": 357, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.882258064516122, "episode_len_mean": 32.16935483870968, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.552785145888591}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5671319893467075, "mean_processing_ms": 6.579405315944285, "mean_inference_ms": 0.9922989124376118}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3783168, "num_steps_sampled": 1432000, "sample_time_ms": 7497.689, "load_time_ms": 14.743, "grad_time_ms": 23212.387, "update_time_ms": 33.408, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0219940897077322, "policy_loss": -0.02200072444975376, "vf_loss": 6.631415843963623, "vf_explained_var": 0.18918612599372864, "kl": 0.004551495425403118, "entropy": 0.15583977103233337, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1432000, "episodes_total": 41841, "training_iteration": 358, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-47-16", "timestamp": 1581511636, "time_this_iter_s": 30.600281238555908, "time_total_s": 11069.432416200638, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11069.432416200638, "timesteps_since_restore": 1432000, "iterations_since_restore": 358, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.59272727272726, "episode_len_mean": 36.68181818181818, "episodes_this_iter": 110, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.235365853658532}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5594723308388625, "mean_processing_ms": 6.579096486960213, "mean_inference_ms": 0.9923516262474694}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3793536, "num_steps_sampled": 1436000, "sample_time_ms": 7433.346, "load_time_ms": 14.134, "grad_time_ms": 23220.691, "update_time_ms": 33.406, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011015331372618675, "policy_loss": -0.011022317223250866, "vf_loss": 6.984936237335205, "vf_explained_var": 0.13562799990177155, "kl": 0.003569927765056491, "entropy": 0.14869436621665955, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1436000, "episodes_total": 41951, "training_iteration": 359, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-47-47", "timestamp": 1581511667, "time_this_iter_s": 29.97706627845764, "time_total_s": 11099.409482479095, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11099.409482479095, "timesteps_since_restore": 1436000, "iterations_since_restore": 359, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.978461538461538, "episode_len_mean": 30.523076923076925, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.2454545454545425}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.564086086961359, "mean_processing_ms": 6.571306901455061, "mean_inference_ms": 0.9926795468082118}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3804288, "num_steps_sampled": 1440000, "sample_time_ms": 7470.504, "load_time_ms": 14.005, "grad_time_ms": 23258.106, "update_time_ms": 33.574, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02525429241359234, "policy_loss": -0.025260452181100845, "vf_loss": 6.156299591064453, "vf_explained_var": 0.20760037004947662, "kl": 0.0022696342784911394, "entropy": 0.141469806432724, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1440000, "episodes_total": 42081, "training_iteration": 360, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-48-19", "timestamp": 1581511699, "time_this_iter_s": 31.512791633605957, "time_total_s": 11130.922274112701, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11130.922274112701, "timesteps_since_restore": 1440000, "iterations_since_restore": 360, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.55090909090908, "episode_len_mean": 36.71818181818182, "episodes_this_iter": 110, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.202431610942245}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.555328435330134, "mean_processing_ms": 6.574651323353855, "mean_inference_ms": 0.9919778322025649}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3814656, "num_steps_sampled": 1444000, "sample_time_ms": 7420.771, "load_time_ms": 14.675, "grad_time_ms": 23202.515, "update_time_ms": 33.813, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04033404961228371, "policy_loss": -0.04034058377146721, "vf_loss": 6.539609432220459, "vf_explained_var": 0.1439162641763687, "kl": 0.003965402953326702, "entropy": 0.12380366772413254, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1444000, "episodes_total": 42191, "training_iteration": 361, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-48-49", "timestamp": 1581511729, "time_this_iter_s": 29.65115451812744, "time_total_s": 11160.573428630829, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ceb70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11160.573428630829, "timesteps_since_restore": 1444000, "iterations_since_restore": 361, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.443548387096765, "episode_len_mean": 32.225806451612904, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.58630136986301}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.551178663937739, "mean_processing_ms": 6.580489521377276, "mean_inference_ms": 0.9918260011993543}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3825024, "num_steps_sampled": 1448000, "sample_time_ms": 7394.395, "load_time_ms": 14.037, "grad_time_ms": 23208.123, "update_time_ms": 33.849, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0357150137424469, "policy_loss": -0.03572138771414757, "vf_loss": 6.372201442718506, "vf_explained_var": 0.19917269051074982, "kl": 0.0034714993089437485, "entropy": 0.1199934333562851, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1448000, "episodes_total": 42315, "training_iteration": 362, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-49-19", "timestamp": 1581511759, "time_this_iter_s": 29.90554141998291, "time_total_s": 11190.478970050812, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b3878c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11190.478970050812, "timesteps_since_restore": 1448000, "iterations_since_restore": 362, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.919117647058814, "episode_len_mean": 29.830882352941178, "episodes_this_iter": 136, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.936739659367395}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.564795368594688, "mean_processing_ms": 6.57597712992452, "mean_inference_ms": 0.9923391456251986}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3835520, "num_steps_sampled": 1452000, "sample_time_ms": 7446.981, "load_time_ms": 13.915, "grad_time_ms": 23201.682, "update_time_ms": 33.672, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.035676561295986176, "policy_loss": -0.035682711750268936, "vf_loss": 6.1462721824646, "vf_explained_var": 0.23439785838127136, "kl": 0.0027006708551198244, "entropy": 0.09743034839630127, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1452000, "episodes_total": 42451, "training_iteration": 363, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-49-51", "timestamp": 1581511791, "time_this_iter_s": 30.95163083076477, "time_total_s": 11221.430600881577, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11221.430600881577, "timesteps_since_restore": 1452000, "iterations_since_restore": 363, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.590624999999992, "episode_len_mean": 31.6171875, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.269478908188583}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.54894069917451, "mean_processing_ms": 6.576547865556372, "mean_inference_ms": 0.9922052993991346}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3846272, "num_steps_sampled": 1456000, "sample_time_ms": 7459.422, "load_time_ms": 14.647, "grad_time_ms": 23262.593, "update_time_ms": 33.575, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.036315061151981354, "policy_loss": -0.03632139414548874, "vf_loss": 6.332932949066162, "vf_explained_var": 0.20611581206321716, "kl": 0.003454614197835326, "entropy": 0.11240803450345993, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1456000, "episodes_total": 42579, "training_iteration": 364, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-50-22", "timestamp": 1581511822, "time_this_iter_s": 31.19883894920349, "time_total_s": 11252.62943983078, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3364597b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11252.62943983078, "timesteps_since_restore": 1456000, "iterations_since_restore": 364, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.534453781512592, "episode_len_mean": 32.285714285714285, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.526966292134829}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.550813105592065, "mean_processing_ms": 6.583363244135433, "mean_inference_ms": 0.9912643096901521}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3856896, "num_steps_sampled": 1460000, "sample_time_ms": 7418.979, "load_time_ms": 14.044, "grad_time_ms": 23271.334, "update_time_ms": 33.353, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.020642317831516266, "policy_loss": -0.020648879930377007, "vf_loss": 6.565104007720947, "vf_explained_var": 0.20056143403053284, "kl": 0.0031122365035116673, "entropy": 0.10787298530340195, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1460000, "episodes_total": 42698, "training_iteration": 365, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-50-54", "timestamp": 1581511854, "time_this_iter_s": 31.083109855651855, "time_total_s": 11283.712549686432, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459ea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11283.712549686432, "timesteps_since_restore": 1460000, "iterations_since_restore": 365, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.318399999999993, "episode_len_mean": 32.544, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.637499999999996}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.550748544400555, "mean_processing_ms": 6.598047481714648, "mean_inference_ms": 0.9916895186014811}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3867776, "num_steps_sampled": 1464000, "sample_time_ms": 7345.482, "load_time_ms": 13.996, "grad_time_ms": 23351.58, "update_time_ms": 32.92, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03206072002649307, "policy_loss": -0.03206649795174599, "vf_loss": 5.7783050537109375, "vf_explained_var": 0.24739287793636322, "kl": 0.0024524738546460867, "entropy": 0.1008540689945221, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1464000, "episodes_total": 42823, "training_iteration": 366, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-51-26", "timestamp": 1581511886, "time_this_iter_s": 31.602559089660645, "time_total_s": 11315.315108776093, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11315.315108776093, "timesteps_since_restore": 1464000, "iterations_since_restore": 366, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.416513761467876, "episode_len_mean": 36.48623853211009, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.0830303030302995}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.561821842473838, "mean_processing_ms": 6.597228192758375, "mean_inference_ms": 0.9915606492146227}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3878144, "num_steps_sampled": 1468000, "sample_time_ms": 7303.116, "load_time_ms": 14.657, "grad_time_ms": 23228.585, "update_time_ms": 33.249, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.012200837023556232, "policy_loss": -0.012207474559545517, "vf_loss": 6.637127876281738, "vf_explained_var": 0.1863197386264801, "kl": 0.002397303469479084, "entropy": 0.1165454089641571, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1468000, "episodes_total": 42932, "training_iteration": 367, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-51-56", "timestamp": 1581511916, "time_this_iter_s": 29.482837677001953, "time_total_s": 11344.797946453094, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3364592f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11344.797946453094, "timesteps_since_restore": 1468000, "iterations_since_restore": 367, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.31056910569105, "episode_len_mean": 31.691056910569106, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.481420765027319}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.555894852944845, "mean_processing_ms": 6.573844469804885, "mean_inference_ms": 0.9922711085937493}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3888512, "num_steps_sampled": 1472000, "sample_time_ms": 7293.764, "load_time_ms": 13.995, "grad_time_ms": 23186.967, "update_time_ms": 33.421, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.006033402867615223, "policy_loss": -0.006039890460669994, "vf_loss": 6.4913177490234375, "vf_explained_var": 0.23519004881381989, "kl": 0.003469903953373432, "entropy": 0.11298201978206635, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1472000, "episodes_total": 43055, "training_iteration": 368, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-52-26", "timestamp": 1581511946, "time_this_iter_s": 30.08560848236084, "time_total_s": 11374.883554935455, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7ce048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11374.883554935455, "timesteps_since_restore": 1472000, "iterations_since_restore": 368, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.654098360655723, "episode_len_mean": 33.9344262295082, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.581868131868128}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.549786255015459, "mean_processing_ms": 6.5754031796582595, "mean_inference_ms": 0.9922668535512639}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3898624, "num_steps_sampled": 1476000, "sample_time_ms": 7309.249, "load_time_ms": 13.849, "grad_time_ms": 23118.137, "update_time_ms": 33.347, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.006546595599502325, "policy_loss": 0.00654012942686677, "vf_loss": 6.471841335296631, "vf_explained_var": 0.16168992221355438, "kl": 0.0051569631323218346, "entropy": 0.1340854912996292, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1476000, "episodes_total": 43177, "training_iteration": 369, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-52-56", "timestamp": 1581511976, "time_this_iter_s": 29.441386938095093, "time_total_s": 11404.32494187355, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11404.32494187355, "timesteps_since_restore": 1476000, "iterations_since_restore": 369, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.395384615384602, "episode_len_mean": 31.23076923076923, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.198441558441555}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5416017532714354, "mean_processing_ms": 6.580156805999045, "mean_inference_ms": 0.9922496403007653}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3908864, "num_steps_sampled": 1480000, "sample_time_ms": 7315.081, "load_time_ms": 14.781, "grad_time_ms": 23030.243, "update_time_ms": 33.273, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.010586373507976532, "policy_loss": -0.010592418722808361, "vf_loss": 6.045811176300049, "vf_explained_var": 0.21067342162132263, "kl": 0.010787577368319035, "entropy": 0.10866162925958633, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1480000, "episodes_total": 43307, "training_iteration": 370, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-53-27", "timestamp": 1581512007, "time_this_iter_s": 30.7004132270813, "time_total_s": 11435.025355100632, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11435.025355100632, "timesteps_since_restore": 1480000, "iterations_since_restore": 370, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.44142857142856, "episode_len_mean": 27.6, "episodes_this_iter": 140, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.40702576112412}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.547028033361305, "mean_processing_ms": 6.577615568364451, "mean_inference_ms": 0.9917730658203798}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3918976, "num_steps_sampled": 1484000, "sample_time_ms": 7349.29, "load_time_ms": 14.301, "grad_time_ms": 22968.213, "update_time_ms": 33.018, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0064759887754917145, "policy_loss": -0.006482087541371584, "vf_loss": 6.103211402893066, "vf_explained_var": 0.26147976517677307, "kl": 0.0037641185335814953, "entropy": 0.08931826055049896, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1484000, "episodes_total": 43447, "training_iteration": 371, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-53-57", "timestamp": 1581512037, "time_this_iter_s": 29.36548948287964, "time_total_s": 11464.390844583511, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11464.390844583511, "timesteps_since_restore": 1484000, "iterations_since_restore": 371, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.23749999999999, "episode_len_mean": 31.3203125, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.15732009925558}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.558326343644444, "mean_processing_ms": 6.565215236783617, "mean_inference_ms": 0.9922834717098719}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3929728, "num_steps_sampled": 1488000, "sample_time_ms": 7369.539, "load_time_ms": 14.301, "grad_time_ms": 23043.263, "update_time_ms": 32.839, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.013004601001739502, "policy_loss": -0.013010566122829914, "vf_loss": 5.967106342315674, "vf_explained_var": 0.2280767560005188, "kl": 0.0028313822112977505, "entropy": 0.07305119931697845, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1488000, "episodes_total": 43575, "training_iteration": 372, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-54-28", "timestamp": 1581512068, "time_this_iter_s": 30.855777502059937, "time_total_s": 11495.246622085571, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244ff28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11495.246622085571, "timesteps_since_restore": 1488000, "iterations_since_restore": 372, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.243902439024385, "episode_len_mean": 32.4390243902439, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.480620155038756}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.553262749034883, "mean_processing_ms": 6.590643117538873, "mean_inference_ms": 0.991593494569994}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3940608, "num_steps_sampled": 1492000, "sample_time_ms": 7328.673, "load_time_ms": 15.057, "grad_time_ms": 23120.274, "update_time_ms": 32.959, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.005156057886779308, "policy_loss": 0.005148875527083874, "vf_loss": 7.182976722717285, "vf_explained_var": 0.19875101745128632, "kl": 0.0014649375807493925, "entropy": 0.05726611614227295, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1492000, "episodes_total": 43698, "training_iteration": 373, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-55-00", "timestamp": 1581512100, "time_this_iter_s": 31.32287335395813, "time_total_s": 11526.56949543953, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a7b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11526.56949543953, "timesteps_since_restore": 1492000, "iterations_since_restore": 373, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.84881889763779, "episode_len_mean": 31.68503937007874, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.362907268170422}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.563134714831943, "mean_processing_ms": 6.592440624528423, "mean_inference_ms": 0.9912726756051466}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3951488, "num_steps_sampled": 1496000, "sample_time_ms": 7344.704, "load_time_ms": 14.443, "grad_time_ms": 23141.572, "update_time_ms": 33.305, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01692068576812744, "policy_loss": 0.016913695260882378, "vf_loss": 6.990786075592041, "vf_explained_var": 0.17195506393909454, "kl": 0.03381563723087311, "entropy": 0.1386183351278305, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1496000, "episodes_total": 43825, "training_iteration": 374, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-55-32", "timestamp": 1581512132, "time_this_iter_s": 31.569645643234253, "time_total_s": 11558.139141082764, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11558.139141082764, "timesteps_since_restore": 1496000, "iterations_since_restore": 374, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.615254237288127, "episode_len_mean": 34.11864406779661, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.679234972677592}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.550443097053098, "mean_processing_ms": 6.578896381691508, "mean_inference_ms": 0.9915456489239388}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3962240, "num_steps_sampled": 1500000, "sample_time_ms": 7336.004, "load_time_ms": 14.338, "grad_time_ms": 23151.983, "update_time_ms": 33.204, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.007159081287682056, "policy_loss": 0.007152351550757885, "vf_loss": 6.728936195373535, "vf_explained_var": 0.21759307384490967, "kl": 0.006727715488523245, "entropy": 0.11110416799783707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1500000, "episodes_total": 43943, "training_iteration": 375, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-56-04", "timestamp": 1581512164, "time_this_iter_s": 31.097212553024292, "time_total_s": 11589.236353635788, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3ea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11589.236353635788, "timesteps_since_restore": 1500000, "iterations_since_restore": 375, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.05439999999999, "episode_len_mean": 31.616, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.145641025641023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.543038173719654, "mean_processing_ms": 6.593607179477, "mean_inference_ms": 0.9916032763613704}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3972608, "num_steps_sampled": 1504000, "sample_time_ms": 7378.976, "load_time_ms": 15.037, "grad_time_ms": 23002.291, "update_time_ms": 33.159, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.021770309656858444, "policy_loss": -0.021777231246232986, "vf_loss": 6.916004180908203, "vf_explained_var": 0.15496157109737396, "kl": 0.005287851206958294, "entropy": 0.09687501192092896, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1504000, "episodes_total": 44068, "training_iteration": 376, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-56-35", "timestamp": 1581512195, "time_this_iter_s": 30.53739881515503, "time_total_s": 11619.773752450943, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11619.773752450943, "timesteps_since_restore": 1504000, "iterations_since_restore": 376, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.750746268656702, "episode_len_mean": 29.91044776119403, "episodes_this_iter": 134, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.856511056511054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.555290211778322, "mean_processing_ms": 6.577115602467322, "mean_inference_ms": 0.9917216826114478}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3982848, "num_steps_sampled": 1508000, "sample_time_ms": 7463.555, "load_time_ms": 14.316, "grad_time_ms": 22973.051, "update_time_ms": 32.861, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.004752536304295063, "policy_loss": 0.0047458261251449585, "vf_loss": 6.716189384460449, "vf_explained_var": 0.26015594601631165, "kl": 0.005316241178661585, "entropy": 0.10654936730861664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1508000, "episodes_total": 44202, "training_iteration": 377, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-57-05", "timestamp": 1581512225, "time_this_iter_s": 30.029448747634888, "time_total_s": 11649.803201198578, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204e18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11649.803201198578, "timesteps_since_restore": 1508000, "iterations_since_restore": 377, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.739823008849537, "episode_len_mean": 35.35398230088496, "episodes_this_iter": 113, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.793641618497106}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.551312627536494, "mean_processing_ms": 6.594318128693011, "mean_inference_ms": 0.9910823208557097}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3993216, "num_steps_sampled": 1512000, "sample_time_ms": 7493.577, "load_time_ms": 14.263, "grad_time_ms": 22966.77, "update_time_ms": 32.743, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00328686716966331, "policy_loss": 0.0032796435989439487, "vf_loss": 7.224371910095215, "vf_explained_var": 0.19154135882854462, "kl": 0.0027667980175465345, "entropy": 0.10605333000421524, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1512000, "episodes_total": 44315, "training_iteration": 378, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-57-36", "timestamp": 1581512256, "time_this_iter_s": 30.32058358192444, "time_total_s": 11680.123784780502, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11680.123784780502, "timesteps_since_restore": 1512000, "iterations_since_restore": 378, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.874193548387087, "episode_len_mean": 32.483870967741936, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.365128205128202}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5492784934307595, "mean_processing_ms": 6.5807723234987785, "mean_inference_ms": 0.992232078986921}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4003840, "num_steps_sampled": 1516000, "sample_time_ms": 7481.51, "load_time_ms": 14.892, "grad_time_ms": 23066.823, "update_time_ms": 32.796, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.007745945826172829, "policy_loss": -0.007752507459372282, "vf_loss": 6.563901424407959, "vf_explained_var": 0.1718096286058426, "kl": 0.007250788155943155, "entropy": 0.09833543747663498, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1516000, "episodes_total": 44439, "training_iteration": 379, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-58-07", "timestamp": 1581512287, "time_this_iter_s": 30.327762603759766, "time_total_s": 11710.451547384262, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b8bd840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11710.451547384262, "timesteps_since_restore": 1516000, "iterations_since_restore": 379, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.598290598290586, "episode_len_mean": 33.743589743589745, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.520107238605895}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.553195036500484, "mean_processing_ms": 6.57800725858263, "mean_inference_ms": 0.9920722061218005}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4014592, "num_steps_sampled": 1520000, "sample_time_ms": 7453.413, "load_time_ms": 14.05, "grad_time_ms": 23136.248, "update_time_ms": 32.775, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01858524978160858, "policy_loss": 0.018578186631202698, "vf_loss": 7.068394184112549, "vf_explained_var": 0.2043410688638687, "kl": 0.006250843405723572, "entropy": 0.1104309931397438, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1520000, "episodes_total": 44556, "training_iteration": 380, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-58-38", "timestamp": 1581512318, "time_this_iter_s": 31.10206913948059, "time_total_s": 11741.553616523743, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b808c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11741.553616523743, "timesteps_since_restore": 1520000, "iterations_since_restore": 380, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.30655737704917, "episode_len_mean": 33.40983606557377, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.5417322834645635}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5557758751399975, "mean_processing_ms": 6.590899266667526, "mean_inference_ms": 0.9911715993885762}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4025216, "num_steps_sampled": 1524000, "sample_time_ms": 7471.983, "load_time_ms": 13.778, "grad_time_ms": 23224.465, "update_time_ms": 33.0, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0065722898580133915, "policy_loss": -0.006579414941370487, "vf_loss": 7.124617099761963, "vf_explained_var": 0.2014046013355255, "kl": 0.00448636244982481, "entropy": 0.11810769140720367, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1524000, "episodes_total": 44678, "training_iteration": 381, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-59-09", "timestamp": 1581512349, "time_this_iter_s": 30.431914806365967, "time_total_s": 11771.985531330109, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11771.985531330109, "timesteps_since_restore": 1524000, "iterations_since_restore": 381, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.657142857142848, "episode_len_mean": 31.833333333333332, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.409278350515461}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.554883660481663, "mean_processing_ms": 6.586782023532046, "mean_inference_ms": 0.9922351974864352}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4035968, "num_steps_sampled": 1528000, "sample_time_ms": 7497.378, "load_time_ms": 14.499, "grad_time_ms": 23229.069, "update_time_ms": 33.24, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00047929983702488244, "policy_loss": 0.00047238756087608635, "vf_loss": 6.915730953216553, "vf_explained_var": 0.1847405731678009, "kl": 0.002319850493222475, "entropy": 0.10171455144882202, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1528000, "episodes_total": 44804, "training_iteration": 382, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_12-59-41", "timestamp": 1581512381, "time_this_iter_s": 31.16726303100586, "time_total_s": 11803.152794361115, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11803.152794361115, "timesteps_since_restore": 1528000, "iterations_since_restore": 382, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.322033898305072, "episode_len_mean": 33.70338983050848, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.479892761394098}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5509488532954565, "mean_processing_ms": 6.592593462956242, "mean_inference_ms": 0.9913038589079304}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4046592, "num_steps_sampled": 1532000, "sample_time_ms": 7533.615, "load_time_ms": 13.916, "grad_time_ms": 23161.869, "update_time_ms": 33.27, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03246051073074341, "policy_loss": 0.032454296946525574, "vf_loss": 6.220784664154053, "vf_explained_var": 0.21822823584079742, "kl": 0.0027363160625100136, "entropy": 0.10124862939119339, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1532000, "episodes_total": 44922, "training_iteration": 383, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-00-12", "timestamp": 1581512412, "time_this_iter_s": 31.00779628753662, "time_total_s": 11834.160590648651, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa7b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11834.160590648651, "timesteps_since_restore": 1532000, "iterations_since_restore": 383, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.761599999999987, "episode_len_mean": 32.304, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.277581863979846}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.557281782545535, "mean_processing_ms": 6.5989563180898045, "mean_inference_ms": 0.9915915525576552}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4057216, "num_steps_sampled": 1536000, "sample_time_ms": 7512.743, "load_time_ms": 13.827, "grad_time_ms": 23121.524, "update_time_ms": 33.085, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03132051229476929, "policy_loss": -0.031326815485954285, "vf_loss": 6.301037311553955, "vf_explained_var": 0.18873262405395508, "kl": 0.002303809393197298, "entropy": 0.08966551721096039, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1536000, "episodes_total": 45047, "training_iteration": 384, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-00-44", "timestamp": 1581512444, "time_this_iter_s": 30.954885244369507, "time_total_s": 11865.11547589302, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80a60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11865.11547589302, "timesteps_since_restore": 1536000, "iterations_since_restore": 384, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.183333333333326, "episode_len_mean": 32.80833333333333, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.455026455026451}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.55494780901038, "mean_processing_ms": 6.600248069517193, "mean_inference_ms": 0.9913725275049993}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4067968, "num_steps_sampled": 1540000, "sample_time_ms": 7580.35, "load_time_ms": 14.87, "grad_time_ms": 23120.807, "update_time_ms": 32.938, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.009422521106898785, "policy_loss": 0.009416013024747372, "vf_loss": 6.5077338218688965, "vf_explained_var": 0.2265838384628296, "kl": 0.0022362656891345978, "entropy": 0.07539688050746918, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1540000, "episodes_total": 45167, "training_iteration": 385, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-01-16", "timestamp": 1581512476, "time_this_iter_s": 31.775066614151, "time_total_s": 11896.890542507172, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3364598c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11896.890542507172, "timesteps_since_restore": 1540000, "iterations_since_restore": 385, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.492799999999992, "episode_len_mean": 31.832, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.396858638743453}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.546828714584345, "mean_processing_ms": 6.598276302057797, "mean_inference_ms": 0.9917739609906429}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4078592, "num_steps_sampled": 1544000, "sample_time_ms": 7602.057, "load_time_ms": 14.17, "grad_time_ms": 23195.476, "update_time_ms": 33.186, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01698753610253334, "policy_loss": 0.016981109976768494, "vf_loss": 6.424511909484863, "vf_explained_var": 0.2108602225780487, "kl": 0.0023679910227656364, "entropy": 0.06910207122564316, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1544000, "episodes_total": 45292, "training_iteration": 386, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-01-48", "timestamp": 1581512508, "time_this_iter_s": 31.49608826637268, "time_total_s": 11928.386630773544, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11928.386630773544, "timesteps_since_restore": 1544000, "iterations_since_restore": 386, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.649612403100763, "episode_len_mean": 31.48062015503876, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.284816753926698}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.558855772047178, "mean_processing_ms": 6.585082056575277, "mean_inference_ms": 0.9915847875904973}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4088832, "num_steps_sampled": 1548000, "sample_time_ms": 7567.981, "load_time_ms": 14.117, "grad_time_ms": 23195.312, "update_time_ms": 32.961, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04268106073141098, "policy_loss": -0.042687367647886276, "vf_loss": 6.304718971252441, "vf_explained_var": 0.24462179839611053, "kl": 0.00324002793058753, "entropy": 0.09714177995920181, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1548000, "episodes_total": 45421, "training_iteration": 387, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-02-18", "timestamp": 1581512538, "time_this_iter_s": 29.681869506835938, "time_total_s": 11958.06850028038, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b2040d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11958.06850028038, "timesteps_since_restore": 1548000, "iterations_since_restore": 387, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.21487603305784, "episode_len_mean": 33.11570247933884, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.539893617021273}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.551641886618214, "mean_processing_ms": 6.597310581254067, "mean_inference_ms": 0.9915770200198748}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4099456, "num_steps_sampled": 1552000, "sample_time_ms": 7565.844, "load_time_ms": 14.858, "grad_time_ms": 23232.804, "update_time_ms": 33.128, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01678646169602871, "policy_loss": -0.01679331250488758, "vf_loss": 6.846044540405273, "vf_explained_var": 0.21171963214874268, "kl": 0.0015768391313031316, "entropy": 0.09620624780654907, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1552000, "episodes_total": 45542, "training_iteration": 388, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-02-49", "timestamp": 1581512569, "time_this_iter_s": 30.685230016708374, "time_total_s": 11988.753730297089, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11988.753730297089, "timesteps_since_restore": 1552000, "iterations_since_restore": 388, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.435971223021578, "episode_len_mean": 29.33093525179856, "episodes_this_iter": 139, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -4.966666666666663}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.550507893380431, "mean_processing_ms": 6.598579285016578, "mean_inference_ms": 0.991331419297472}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4110336, "num_steps_sampled": 1556000, "sample_time_ms": 7650.193, "load_time_ms": 14.279, "grad_time_ms": 23274.276, "update_time_ms": 33.244, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.008848913013935089, "policy_loss": 0.008843266405165195, "vf_loss": 5.644287586212158, "vf_explained_var": 0.2408650815486908, "kl": 0.002737631555646658, "entropy": 0.088556207716465, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1556000, "episodes_total": 45681, "training_iteration": 389, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-03-21", "timestamp": 1581512601, "time_this_iter_s": 31.581951141357422, "time_total_s": 12020.335681438446, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12020.335681438446, "timesteps_since_restore": 1556000, "iterations_since_restore": 389, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.937499999999996, "episode_len_mean": 26.555555555555557, "episodes_this_iter": 144, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.571753986332571}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.563371821607256, "mean_processing_ms": 6.600516275511083, "mean_inference_ms": 0.9912041665692427}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4121216, "num_steps_sampled": 1560000, "sample_time_ms": 7695.983, "load_time_ms": 14.261, "grad_time_ms": 23322.94, "update_time_ms": 33.442, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.025059964507818222, "policy_loss": 0.025053804740309715, "vf_loss": 6.163177013397217, "vf_explained_var": 0.3025324046611786, "kl": 0.004042948596179485, "entropy": 0.10204453021287918, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1560000, "episodes_total": 45825, "training_iteration": 390, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-03-54", "timestamp": 1581512634, "time_this_iter_s": 32.050150871276855, "time_total_s": 12052.385832309723, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12052.385832309723, "timesteps_since_restore": 1560000, "iterations_since_restore": 390, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.654687499999994, "episode_len_mean": 31.3515625, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.4244274809160276}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.558465865988074, "mean_processing_ms": 6.584759848773032, "mean_inference_ms": 0.99204519066948}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4132096, "num_steps_sampled": 1564000, "sample_time_ms": 7728.769, "load_time_ms": 14.947, "grad_time_ms": 23413.894, "update_time_ms": 33.206, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0666598454117775, "policy_loss": -0.06666713953018188, "vf_loss": 7.288931846618652, "vf_explained_var": 0.18887090682983398, "kl": 0.0034160814248025417, "entropy": 0.10018883645534515, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1564000, "episodes_total": 45953, "training_iteration": 391, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-04-26", "timestamp": 1581512666, "time_this_iter_s": 31.67529058456421, "time_total_s": 12084.061122894287, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12084.061122894287, "timesteps_since_restore": 1564000, "iterations_since_restore": 391, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.310924369747887, "episode_len_mean": 34.10084033613445, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.659340659340655}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.543839509163059, "mean_processing_ms": 6.594200327368697, "mean_inference_ms": 0.9915861406755972}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4142464, "num_steps_sampled": 1568000, "sample_time_ms": 7688.804, "load_time_ms": 14.164, "grad_time_ms": 23342.578, "update_time_ms": 32.98, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.008643900975584984, "policy_loss": -0.008650084026157856, "vf_loss": 6.1832756996154785, "vf_explained_var": 0.20208528637886047, "kl": 0.0038547415751963854, "entropy": 0.09815847873687744, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1568000, "episodes_total": 46072, "training_iteration": 392, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-04-56", "timestamp": 1581512696, "time_this_iter_s": 30.042039155960083, "time_total_s": 12114.103162050247, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459e18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12114.103162050247, "timesteps_since_restore": 1568000, "iterations_since_restore": 392, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.46349206349206, "episode_len_mean": 31.72222222222222, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.278371501272261}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.555814415079325, "mean_processing_ms": 6.606364408842935, "mean_inference_ms": 0.9911378595281831}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4153216, "num_steps_sampled": 1572000, "sample_time_ms": 7659.131, "load_time_ms": 14.131, "grad_time_ms": 23406.816, "update_time_ms": 33.1, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.008862597867846489, "policy_loss": -0.008869295939803123, "vf_loss": 6.7010979652404785, "vf_explained_var": 0.23156361281871796, "kl": 0.025911835953593254, "entropy": 0.18983493745326996, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1572000, "episodes_total": 46198, "training_iteration": 393, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-05-28", "timestamp": 1581512728, "time_this_iter_s": 31.35258460044861, "time_total_s": 12145.455746650696, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204c80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12145.455746650696, "timesteps_since_restore": 1572000, "iterations_since_restore": 393, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.1937984496124, "episode_len_mean": 30.94573643410853, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.463054187192115}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.551102114131918, "mean_processing_ms": 6.582071030813111, "mean_inference_ms": 0.9926009116150208}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4164608, "num_steps_sampled": 1576000, "sample_time_ms": 7711.335, "load_time_ms": 15.04, "grad_time_ms": 23591.066, "update_time_ms": 32.945, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00890906061977148, "policy_loss": -0.00891556590795517, "vf_loss": 6.500278472900391, "vf_explained_var": 0.2080119103193283, "kl": 0.006325774826109409, "entropy": 0.1910291314125061, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1576000, "episodes_total": 46327, "training_iteration": 394, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-06-02", "timestamp": 1581512762, "time_this_iter_s": 33.326950550079346, "time_total_s": 12178.782697200775, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b2047b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12178.782697200775, "timesteps_since_restore": 1576000, "iterations_since_restore": 394, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.479069767441848, "episode_len_mean": 31.131782945736433, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.1199999999999966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.560107900947013, "mean_processing_ms": 6.617174711867447, "mean_inference_ms": 0.9914027280592334}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4174976, "num_steps_sampled": 1580000, "sample_time_ms": 7710.857, "load_time_ms": 14.0, "grad_time_ms": 23497.062, "update_time_ms": 33.129, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.004793057683855295, "policy_loss": 0.0047867028042674065, "vf_loss": 6.354771614074707, "vf_explained_var": 0.23887354135513306, "kl": 0.003782367566600442, "entropy": 0.17426098883152008, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1580000, "episodes_total": 46456, "training_iteration": 395, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-06-33", "timestamp": 1581512793, "time_this_iter_s": 30.820723056793213, "time_total_s": 12209.603420257568, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aaa60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12209.603420257568, "timesteps_since_restore": 1580000, "iterations_since_restore": 395, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.009677419354826, "episode_len_mean": 32.37096774193548, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.350943396226413}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.552779773457048, "mean_processing_ms": 6.599106356362749, "mean_inference_ms": 0.9910936556324907}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4185088, "num_steps_sampled": 1584000, "sample_time_ms": 7610.175, "load_time_ms": 13.907, "grad_time_ms": 23364.451, "update_time_ms": 33.002, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.031155947595834732, "policy_loss": -0.03116244077682495, "vf_loss": 6.488765716552734, "vf_explained_var": 0.20654456317424774, "kl": 0.003635553177446127, "entropy": 0.15362142026424408, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1584000, "episodes_total": 46580, "training_iteration": 396, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-07-03", "timestamp": 1581512823, "time_this_iter_s": 29.162243127822876, "time_total_s": 12238.765663385391, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204bf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12238.765663385391, "timesteps_since_restore": 1584000, "iterations_since_restore": 396, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.983870967741925, "episode_len_mean": 31.193548387096776, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.24338624338624}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.549732244530541, "mean_processing_ms": 6.6011755662754, "mean_inference_ms": 0.9921862736912739}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4195712, "num_steps_sampled": 1588000, "sample_time_ms": 7592.743, "load_time_ms": 14.542, "grad_time_ms": 23468.315, "update_time_ms": 33.334, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.005881280638277531, "policy_loss": -0.005887799430638552, "vf_loss": 6.520164966583252, "vf_explained_var": 0.21066640317440033, "kl": 0.005079141817986965, "entropy": 0.1654358059167862, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1588000, "episodes_total": 46704, "training_iteration": 397, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-07-34", "timestamp": 1581512854, "time_this_iter_s": 30.55508828163147, "time_total_s": 12269.320751667023, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12269.320751667023, "timesteps_since_restore": 1588000, "iterations_since_restore": 397, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.562121212121205, "episode_len_mean": 31.333333333333332, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.451870324189524}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.559754172143128, "mean_processing_ms": 6.594989435154072, "mean_inference_ms": 0.9911242056697308}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4206592, "num_steps_sampled": 1592000, "sample_time_ms": 7545.817, "load_time_ms": 13.81, "grad_time_ms": 23546.809, "update_time_ms": 33.072, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.037933219224214554, "policy_loss": -0.03793906420469284, "vf_loss": 5.8488850593566895, "vf_explained_var": 0.19143079221248627, "kl": 0.002267547184601426, "entropy": 0.12930530309677124, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1592000, "episodes_total": 46836, "training_iteration": 398, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-08-05", "timestamp": 1581512885, "time_this_iter_s": 30.989534378051758, "time_total_s": 12300.310286045074, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201cd08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12300.310286045074, "timesteps_since_restore": 1592000, "iterations_since_restore": 398, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.211594202898542, "episode_len_mean": 29.108695652173914, "episodes_this_iter": 138, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.939294117647056}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.549723911993564, "mean_processing_ms": 6.594288606704756, "mean_inference_ms": 0.9924118468751686}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4217344, "num_steps_sampled": 1596000, "sample_time_ms": 7524.512, "load_time_ms": 13.853, "grad_time_ms": 23546.146, "update_time_ms": 32.844, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.023475198075175285, "policy_loss": 0.023468991741538048, "vf_loss": 6.209474086761475, "vf_explained_var": 0.2347431480884552, "kl": 0.0017981264973059297, "entropy": 0.11021685600280762, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1596000, "episodes_total": 46974, "training_iteration": 399, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-08-37", "timestamp": 1581512917, "time_this_iter_s": 31.36184549331665, "time_total_s": 12331.672131538391, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292ac80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12331.672131538391, "timesteps_since_restore": 1596000, "iterations_since_restore": 399, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.474796747967474, "episode_len_mean": 32.016260162601625, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.461994609164417}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.555059061719342, "mean_processing_ms": 6.610184738199234, "mean_inference_ms": 0.9917879875350438}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4227840, "num_steps_sampled": 1600000, "sample_time_ms": 7422.217, "load_time_ms": 14.715, "grad_time_ms": 23433.067, "update_time_ms": 32.685, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02372828871011734, "policy_loss": -0.023734385147690773, "vf_loss": 6.097921371459961, "vf_explained_var": 0.20100729167461395, "kl": 0.003175851423293352, "entropy": 0.12173405289649963, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1600000, "episodes_total": 47097, "training_iteration": 400, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-09-07", "timestamp": 1581512947, "time_this_iter_s": 29.90342950820923, "time_total_s": 12361.5755610466, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12361.5755610466, "timesteps_since_restore": 1600000, "iterations_since_restore": 400, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.425196850393688, "episode_len_mean": 31.165354330708663, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.155263157894734}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.554842180679012, "mean_processing_ms": 6.613551640780393, "mean_inference_ms": 0.9909990108748763}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4238208, "num_steps_sampled": 1604000, "sample_time_ms": 7413.317, "load_time_ms": 14.207, "grad_time_ms": 23321.469, "update_time_ms": 32.699, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.020756136626005173, "policy_loss": 0.020749878138303757, "vf_loss": 6.246349811553955, "vf_explained_var": 0.24439741671085358, "kl": 0.002385607920587063, "entropy": 0.12047247588634491, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1604000, "episodes_total": 47224, "training_iteration": 401, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-09-38", "timestamp": 1581512978, "time_this_iter_s": 30.46463680267334, "time_total_s": 12392.040197849274, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12392.040197849274, "timesteps_since_restore": 1604000, "iterations_since_restore": 401, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.93613445378151, "episode_len_mean": 34.32773109243698, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.661538461538458}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.554548839242754, "mean_processing_ms": 6.592596114058698, "mean_inference_ms": 0.9919030489565743}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4248832, "num_steps_sampled": 1608000, "sample_time_ms": 7464.295, "load_time_ms": 14.197, "grad_time_ms": 23357.753, "update_time_ms": 32.415, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.031061267480254173, "policy_loss": -0.03106788359582424, "vf_loss": 6.619485378265381, "vf_explained_var": 0.1847054660320282, "kl": 0.004294523969292641, "entropy": 0.11406268924474716, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1608000, "episodes_total": 47343, "training_iteration": 402, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-10-10", "timestamp": 1581513010, "time_this_iter_s": 30.911612510681152, "time_total_s": 12422.951810359955, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80c80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12422.951810359955, "timesteps_since_restore": 1608000, "iterations_since_restore": 402, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.073134328358204, "episode_len_mean": 29.29850746268657, "episodes_this_iter": 134, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.902427184466016}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.554884460564761, "mean_processing_ms": 6.603849042811481, "mean_inference_ms": 0.9924659867254987}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4259456, "num_steps_sampled": 1612000, "sample_time_ms": 7450.477, "load_time_ms": 15.146, "grad_time_ms": 23353.521, "update_time_ms": 32.242, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04106751084327698, "policy_loss": 0.04106098785996437, "vf_loss": 6.524153232574463, "vf_explained_var": 0.24267812073230743, "kl": 0.003487084759399295, "entropy": 0.15880459547042847, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1612000, "episodes_total": 47477, "training_iteration": 403, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-10-42", "timestamp": 1581513042, "time_this_iter_s": 31.182316780090332, "time_total_s": 12454.134127140045, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459d08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12454.134127140045, "timesteps_since_restore": 1612000, "iterations_since_restore": 403, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.773228346456687, "episode_len_mean": 32.59842519685039, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.434183673469385}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5489001239787195, "mean_processing_ms": 6.602114321471191, "mean_inference_ms": 0.9918418418572337}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4270080, "num_steps_sampled": 1616000, "sample_time_ms": 7407.28, "load_time_ms": 14.34, "grad_time_ms": 23182.329, "update_time_ms": 32.556, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.009183724410831928, "policy_loss": -0.009189381264150143, "vf_loss": 5.6644287109375, "vf_explained_var": 0.22724716365337372, "kl": 0.0033347250428050756, "entropy": 0.13209444284439087, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1616000, "episodes_total": 47604, "training_iteration": 404, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-11-13", "timestamp": 1581513073, "time_this_iter_s": 31.177991151809692, "time_total_s": 12485.312118291855, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12485.312118291855, "timesteps_since_restore": 1616000, "iterations_since_restore": 404, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.254237288135585, "episode_len_mean": 32.779661016949156, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.402816901408447}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.553575071921077, "mean_processing_ms": 6.613637126166642, "mean_inference_ms": 0.9914531558223254}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4280320, "num_steps_sampled": 1620000, "sample_time_ms": 7393.158, "load_time_ms": 14.328, "grad_time_ms": 23168.761, "update_time_ms": 32.776, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03460615128278732, "policy_loss": -0.034612517803907394, "vf_loss": 6.366905689239502, "vf_explained_var": 0.224728062748909, "kl": 0.00445948913693428, "entropy": 0.13199041783809662, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1620000, "episodes_total": 47722, "training_iteration": 405, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-11-44", "timestamp": 1581513104, "time_this_iter_s": 30.544944286346436, "time_total_s": 12515.857062578201, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12515.857062578201, "timesteps_since_restore": 1620000, "iterations_since_restore": 405, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.958778625954194, "episode_len_mean": 30.641221374045802, "episodes_this_iter": 131, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.292658227848097}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.559239663091231, "mean_processing_ms": 6.6133434079390225, "mean_inference_ms": 0.9910630141296319}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4291072, "num_steps_sampled": 1624000, "sample_time_ms": 7436.138, "load_time_ms": 15.139, "grad_time_ms": 23329.954, "update_time_ms": 32.301, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.05055060237646103, "policy_loss": 0.050543706864118576, "vf_loss": 6.9088568687438965, "vf_explained_var": 0.22017331421375275, "kl": 0.002423091558739543, "entropy": 0.13648054003715515, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1624000, "episodes_total": 47853, "training_iteration": 406, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-12-16", "timestamp": 1581513136, "time_this_iter_s": 31.205883026123047, "time_total_s": 12547.062945604324, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aab70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12547.062945604324, "timesteps_since_restore": 1624000, "iterations_since_restore": 406, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.293442622950817, "episode_len_mean": 32.47540983606557, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.641176470588232}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.547963407497731, "mean_processing_ms": 6.6198414652866, "mean_inference_ms": 0.9914131333122982}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4301952, "num_steps_sampled": 1628000, "sample_time_ms": 7463.518, "load_time_ms": 14.647, "grad_time_ms": 23361.061, "update_time_ms": 32.154, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0006767634185962379, "policy_loss": -0.0006836176034994423, "vf_loss": 6.856272220611572, "vf_explained_var": 0.18209250271320343, "kl": 0.003312322311103344, "entropy": 0.09307798743247986, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1628000, "episodes_total": 47975, "training_iteration": 407, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-12-48", "timestamp": 1581513168, "time_this_iter_s": 31.135898113250732, "time_total_s": 12578.198843717575, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459bf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12578.198843717575, "timesteps_since_restore": 1628000, "iterations_since_restore": 407, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.424817518248167, "episode_len_mean": 30.021897810218977, "episodes_this_iter": 137, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.055502392344496}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.556225162122977, "mean_processing_ms": 6.621751779882534, "mean_inference_ms": 0.9910879135585704}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4312576, "num_steps_sampled": 1632000, "sample_time_ms": 7559.818, "load_time_ms": 14.574, "grad_time_ms": 23288.252, "update_time_ms": 32.197, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.026160361245274544, "policy_loss": 0.02615373395383358, "vf_loss": 6.632943630218506, "vf_explained_var": 0.21988584101200104, "kl": 0.003263654885813594, "entropy": 0.090811587870121, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1632000, "episodes_total": 48112, "training_iteration": 408, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-13-19", "timestamp": 1581513199, "time_this_iter_s": 31.22266411781311, "time_total_s": 12609.421507835388, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff2b5b51ae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12609.421507835388, "timesteps_since_restore": 1632000, "iterations_since_restore": 408, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.391044776119392, "episode_len_mean": 29.880597014925375, "episodes_this_iter": 134, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.9701030927835035}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.546592518492933, "mean_processing_ms": 6.612379474821103, "mean_inference_ms": 0.9916889148212105}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4322688, "num_steps_sampled": 1636000, "sample_time_ms": 7558.716, "load_time_ms": 15.016, "grad_time_ms": 23122.998, "update_time_ms": 32.379, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.002910963259637356, "policy_loss": 0.002904810244217515, "vf_loss": 6.1512298583984375, "vf_explained_var": 0.2357555776834488, "kl": 0.0020416961051523685, "entropy": 0.06373906135559082, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1636000, "episodes_total": 48246, "training_iteration": 409, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-13-49", "timestamp": 1581513229, "time_this_iter_s": 29.70412826538086, "time_total_s": 12639.125636100769, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459c80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12639.125636100769, "timesteps_since_restore": 1636000, "iterations_since_restore": 409, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.654545454545442, "episode_len_mean": 35.981818181818184, "episodes_this_iter": 110, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.162162162162158}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.553329673424772, "mean_processing_ms": 6.603254026920922, "mean_inference_ms": 0.9913998050268521}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4333184, "num_steps_sampled": 1640000, "sample_time_ms": 7559.103, "load_time_ms": 14.191, "grad_time_ms": 23134.128, "update_time_ms": 32.19, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04800883308053017, "policy_loss": 0.04800194501876831, "vf_loss": 6.882265567779541, "vf_explained_var": 0.15322020649909973, "kl": 0.00257076951675117, "entropy": 0.07757135480642319, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1640000, "episodes_total": 48356, "training_iteration": 410, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-14-20", "timestamp": 1581513260, "time_this_iter_s": 30.007917165756226, "time_total_s": 12669.133553266525, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12669.133553266525, "timesteps_since_restore": 1640000, "iterations_since_restore": 410, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.471317829457352, "episode_len_mean": 30.96124031007752, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.210966057441252}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.556658136773509, "mean_processing_ms": 6.620400075187645, "mean_inference_ms": 0.990507815855675}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4343552, "num_steps_sampled": 1644000, "sample_time_ms": 7550.369, "load_time_ms": 14.044, "grad_time_ms": 23147.683, "update_time_ms": 32.272, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.038871873170137405, "policy_loss": 0.038865428417921066, "vf_loss": 6.446331977844238, "vf_explained_var": 0.2369067370891571, "kl": 0.00247297459281981, "entropy": 0.07953149080276489, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1644000, "episodes_total": 48485, "training_iteration": 411, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-14-51", "timestamp": 1581513291, "time_this_iter_s": 30.51295495033264, "time_total_s": 12699.646508216858, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa6a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12699.646508216858, "timesteps_since_restore": 1644000, "iterations_since_restore": 411, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.100699300699294, "episode_len_mean": 28.146853146853147, "episodes_this_iter": 143, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.733333333333331}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.542297056984431, "mean_processing_ms": 6.609155568653695, "mean_inference_ms": 0.991724371482888}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4353920, "num_steps_sampled": 1648000, "sample_time_ms": 7597.483, "load_time_ms": 14.718, "grad_time_ms": 23072.534, "update_time_ms": 32.633, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.025072209537029266, "policy_loss": -0.02507825568318367, "vf_loss": 6.049500465393066, "vf_explained_var": 0.24892227351665497, "kl": 0.004821631126105785, "entropy": 0.07589145004749298, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1648000, "episodes_total": 48628, "training_iteration": 412, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-15-22", "timestamp": 1581513322, "time_this_iter_s": 30.64324140548706, "time_total_s": 12730.289749622345, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12730.289749622345, "timesteps_since_restore": 1648000, "iterations_since_restore": 412, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.09599999999999, "episode_len_mean": 32.536, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.760107816711587}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5472918767454535, "mean_processing_ms": 6.602325082211405, "mean_inference_ms": 0.9923264630589776}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4364800, "num_steps_sampled": 1652000, "sample_time_ms": 7611.561, "load_time_ms": 13.983, "grad_time_ms": 23148.075, "update_time_ms": 32.638, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0003848315682262182, "policy_loss": 0.00037770712515339255, "vf_loss": 7.126005172729492, "vf_explained_var": 0.17348206043243408, "kl": 0.0049150558188557625, "entropy": 0.10662759840488434, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1652000, "episodes_total": 48753, "training_iteration": 413, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-15-55", "timestamp": 1581513355, "time_this_iter_s": 32.07092046737671, "time_total_s": 12762.360670089722, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac39d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12762.360670089722, "timesteps_since_restore": 1652000, "iterations_since_restore": 413, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.813333333333324, "episode_len_mean": 29.14814814814815, "episodes_this_iter": 135, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.784210526315786}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.551418582089045, "mean_processing_ms": 6.630021649487541, "mean_inference_ms": 0.9917600797759412}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4375296, "num_steps_sampled": 1656000, "sample_time_ms": 7670.338, "load_time_ms": 13.866, "grad_time_ms": 23465.575, "update_time_ms": 32.537, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02525385469198227, "policy_loss": -0.02525993622839451, "vf_loss": 6.08274507522583, "vf_explained_var": 0.23304760456085205, "kl": 0.0028560669161379337, "entropy": 0.07020941376686096, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1656000, "episodes_total": 48888, "training_iteration": 414, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-16-30", "timestamp": 1581513390, "time_this_iter_s": 34.940369606018066, "time_total_s": 12797.30103969574, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3364591e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12797.30103969574, "timesteps_since_restore": 1656000, "iterations_since_restore": 414, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.53870967741934, "episode_len_mean": 32.12903225806452, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.207567567567565}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.549227567338126, "mean_processing_ms": 6.634958133921266, "mean_inference_ms": 0.9926821613474481}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4385280, "num_steps_sampled": 1660000, "sample_time_ms": 7916.051, "load_time_ms": 14.952, "grad_time_ms": 23749.472, "update_time_ms": 32.89, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.006790557876229286, "policy_loss": -0.006796992849558592, "vf_loss": 6.435825824737549, "vf_explained_var": 0.20167511701583862, "kl": 0.0014633983373641968, "entropy": 0.0585932731628418, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1660000, "episodes_total": 49012, "training_iteration": 415, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-17-06", "timestamp": 1581513426, "time_this_iter_s": 35.86083936691284, "time_total_s": 12833.161879062653, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88ae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12833.161879062653, "timesteps_since_restore": 1660000, "iterations_since_restore": 415, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.12656249999999, "episode_len_mean": 31.5625, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.361558441558438}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.556163439424896, "mean_processing_ms": 6.638257605389246, "mean_inference_ms": 0.9928220758361423}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4395776, "num_steps_sampled": 1664000, "sample_time_ms": 8043.081, "load_time_ms": 14.509, "grad_time_ms": 24126.311, "update_time_ms": 33.53, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.05774637684226036, "policy_loss": -0.05775298550724983, "vf_loss": 6.607571601867676, "vf_explained_var": 0.20538656413555145, "kl": 0.0016158411744982004, "entropy": 0.07369425147771835, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1664000, "episodes_total": 49140, "training_iteration": 416, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-17-43", "timestamp": 1581513463, "time_this_iter_s": 36.24901580810547, "time_total_s": 12869.410894870758, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aae18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12869.410894870758, "timesteps_since_restore": 1664000, "iterations_since_restore": 416, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.201769911504407, "episode_len_mean": 34.6283185840708, "episodes_this_iter": 113, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.6505813953488335}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.550097888812644, "mean_processing_ms": 6.634324963135559, "mean_inference_ms": 0.9944160428786912}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4406016, "num_steps_sampled": 1668000, "sample_time_ms": 8178.972, "load_time_ms": 14.412, "grad_time_ms": 24516.551, "update_time_ms": 33.884, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.026453956961631775, "policy_loss": 0.02644726075232029, "vf_loss": 6.690492153167725, "vf_explained_var": 0.20771686732769012, "kl": 0.0027667691465467215, "entropy": 0.07845218479633331, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1668000, "episodes_total": 49253, "training_iteration": 417, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-18-20", "timestamp": 1581513500, "time_this_iter_s": 36.40042805671692, "time_total_s": 12905.811322927475, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aabf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12905.811322927475, "timesteps_since_restore": 1668000, "iterations_since_restore": 417, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.585826771653528, "episode_len_mean": 31.944881889763778, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.292513368983954}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.561240503097429, "mean_processing_ms": 6.644342602458379, "mean_inference_ms": 0.9946464929728474}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4416000, "num_steps_sampled": 1672000, "sample_time_ms": 8308.869, "load_time_ms": 15.466, "grad_time_ms": 24841.909, "update_time_ms": 34.349, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.055232126265764236, "policy_loss": 0.05522545799612999, "vf_loss": 6.677060604095459, "vf_explained_var": 0.22644515335559845, "kl": 0.002721143653616309, "entropy": 0.06897612661123276, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1672000, "episodes_total": 49380, "training_iteration": 418, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-18-57", "timestamp": 1581513537, "time_this_iter_s": 35.793856382369995, "time_total_s": 12941.605179309845, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12941.605179309845, "timesteps_since_restore": 1672000, "iterations_since_restore": 418, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.936764705882348, "episode_len_mean": 29.433823529411764, "episodes_this_iter": 136, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.894939759036142}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.553892636632655, "mean_processing_ms": 6.638275909688542, "mean_inference_ms": 0.9952423322156371}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4426496, "num_steps_sampled": 1676000, "sample_time_ms": 8529.668, "load_time_ms": 15.178, "grad_time_ms": 25444.33, "update_time_ms": 34.761, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.022498948499560356, "policy_loss": 0.022492703050374985, "vf_loss": 6.25329065322876, "vf_explained_var": 0.2501419484615326, "kl": 0.005383394658565521, "entropy": 0.10656461119651794, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1676000, "episodes_total": 49516, "training_iteration": 419, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-19-35", "timestamp": 1581513575, "time_this_iter_s": 37.938868284225464, "time_total_s": 12979.54404759407, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12979.54404759407, "timesteps_since_restore": 1676000, "iterations_since_restore": 419, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.210769230769218, "episode_len_mean": 30.56153846153846, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.203684210526313}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.569634290981073, "mean_processing_ms": 6.657571976590178, "mean_inference_ms": 0.9964251840664019}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4436864, "num_steps_sampled": 1680000, "sample_time_ms": 8783.836, "load_time_ms": 15.34, "grad_time_ms": 25917.588, "update_time_ms": 35.499, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.006831375882029533, "policy_loss": 0.00682503217831254, "vf_loss": 6.34412145614624, "vf_explained_var": 0.2156946212053299, "kl": 0.010793488472700119, "entropy": 0.1133524551987648, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1680000, "episodes_total": 49646, "training_iteration": 420, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-20-13", "timestamp": 1581513613, "time_this_iter_s": 37.2945454120636, "time_total_s": 13016.838593006134, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7daea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13016.838593006134, "timesteps_since_restore": 1680000, "iterations_since_restore": 420, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.257391304347816, "episode_len_mean": 34.834782608695654, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.802923976608184}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5654780441958875, "mean_processing_ms": 6.652017750560907, "mean_inference_ms": 0.9961496046062099}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4446976, "num_steps_sampled": 1684000, "sample_time_ms": 8861.426, "load_time_ms": 16.22, "grad_time_ms": 26327.565, "update_time_ms": 36.289, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.031939294189214706, "policy_loss": -0.03194572776556015, "vf_loss": 6.43342399597168, "vf_explained_var": 0.18516582250595093, "kl": 0.003679166082292795, "entropy": 0.08317713439464569, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1684000, "episodes_total": 49761, "training_iteration": 421, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-20-49", "timestamp": 1581513649, "time_this_iter_s": 35.407376527786255, "time_total_s": 13052.24596953392, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aaea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13052.24596953392, "timesteps_since_restore": 1684000, "iterations_since_restore": 421, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.2991304347826, "episode_len_mean": 33.504347826086956, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.651704545454542}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5687218605791715, "mean_processing_ms": 6.653793417613631, "mean_inference_ms": 0.9969594951910756}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4457472, "num_steps_sampled": 1688000, "sample_time_ms": 8957.939, "load_time_ms": 15.931, "grad_time_ms": 26913.658, "update_time_ms": 36.721, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.027086583897471428, "policy_loss": -0.027093136683106422, "vf_loss": 6.549964904785156, "vf_explained_var": 0.19762523472309113, "kl": 0.0036813293118029833, "entropy": 0.11249585449695587, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1688000, "episodes_total": 49876, "training_iteration": 422, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-21-27", "timestamp": 1581513687, "time_this_iter_s": 37.47368144989014, "time_total_s": 13089.71965098381, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3362811e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13089.71965098381, "timesteps_since_restore": 1688000, "iterations_since_restore": 422, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.379104477611929, "episode_len_mean": 31.34328358208955, "episodes_this_iter": 134, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.1909319899244295}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.569498327698492, "mean_processing_ms": 6.682349702197557, "mean_inference_ms": 0.9969857703337636}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4467584, "num_steps_sampled": 1692000, "sample_time_ms": 9200.031, "load_time_ms": 15.683, "grad_time_ms": 27224.989, "update_time_ms": 36.825, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014716391451656818, "policy_loss": 0.01471004169434309, "vf_loss": 6.350647926330566, "vf_explained_var": 0.21899054944515228, "kl": 0.002383910119533539, "entropy": 0.10260920971632004, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1692000, "episodes_total": 50010, "training_iteration": 423, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-22-05", "timestamp": 1581513725, "time_this_iter_s": 37.605605363845825, "time_total_s": 13127.325256347656, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3362810d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13127.325256347656, "timesteps_since_restore": 1692000, "iterations_since_restore": 423, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.906569343065682, "episode_len_mean": 28.16788321167883, "episodes_this_iter": 137, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.658190709046453}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5709333017686955, "mean_processing_ms": 6.687320843162742, "mean_inference_ms": 0.9982602688273743}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4477824, "num_steps_sampled": 1696000, "sample_time_ms": 9390.552, "load_time_ms": 16.631, "grad_time_ms": 27271.079, "update_time_ms": 37.093, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01522209495306015, "policy_loss": -0.015228363685309887, "vf_loss": 6.271140098571777, "vf_explained_var": 0.2575417459011078, "kl": 0.002710467204451561, "entropy": 0.12949725985527039, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1696000, "episodes_total": 50147, "training_iteration": 424, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-22-43", "timestamp": 1581513763, "time_this_iter_s": 37.31969428062439, "time_total_s": 13164.64495062828, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281ea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13164.64495062828, "timesteps_since_restore": 1696000, "iterations_since_restore": 424, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.143548387096768, "episode_len_mean": 33.233870967741936, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.535937499999997}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.56843107220747, "mean_processing_ms": 6.665290062659406, "mean_inference_ms": 0.9996377442401123}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4488448, "num_steps_sampled": 1700000, "sample_time_ms": 9315.516, "load_time_ms": 15.955, "grad_time_ms": 27557.062, "update_time_ms": 37.509, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03155343234539032, "policy_loss": -0.03156008943915367, "vf_loss": 6.676137924194336, "vf_explained_var": 0.16577084362506866, "kl": 0.0022435516584664583, "entropy": 0.10682027786970139, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1700000, "episodes_total": 50271, "training_iteration": 425, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-23-22", "timestamp": 1581513802, "time_this_iter_s": 37.96688151359558, "time_total_s": 13202.611832141876, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13202.611832141876, "timesteps_since_restore": 1700000, "iterations_since_restore": 425, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.763492063492054, "episode_len_mean": 31.6984126984127, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.17239583333333}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.580668160939667, "mean_processing_ms": 6.678461116659528, "mean_inference_ms": 0.9997312854151442}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4498816, "num_steps_sampled": 1704000, "sample_time_ms": 9310.622, "load_time_ms": 15.722, "grad_time_ms": 27551.534, "update_time_ms": 37.679, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01797834224998951, "policy_loss": 0.017971720546483994, "vf_loss": 6.627248287200928, "vf_explained_var": 0.1868004947900772, "kl": 0.007043976336717606, "entropy": 0.11990997195243835, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1704000, "episodes_total": 50397, "training_iteration": 426, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-23-59", "timestamp": 1581513839, "time_this_iter_s": 36.14523935317993, "time_total_s": 13238.757071495056, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f0d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13238.757071495056, "timesteps_since_restore": 1704000, "iterations_since_restore": 426, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.199999999999992, "episode_len_mean": 28.753623188405797, "episodes_this_iter": 138, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.676849642004771}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.586738068896154, "mean_processing_ms": 6.699351067769112, "mean_inference_ms": 1.000424667286566}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4509056, "num_steps_sampled": 1708000, "sample_time_ms": 9422.991, "load_time_ms": 16.598, "grad_time_ms": 27551.49, "update_time_ms": 37.662, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.002279820619150996, "policy_loss": 0.002273720921948552, "vf_loss": 6.1004252433776855, "vf_explained_var": 0.24637457728385925, "kl": 0.0014216967392712831, "entropy": 0.07984668016433716, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1708000, "episodes_total": 50535, "training_iteration": 427, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-24-37", "timestamp": 1581513877, "time_this_iter_s": 37.533926486968994, "time_total_s": 13276.290997982025, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3364599d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13276.290997982025, "timesteps_since_restore": 1708000, "iterations_since_restore": 427, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.188135593220327, "episode_len_mean": 34.110169491525426, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.602762430939223}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.5769174132510475, "mean_processing_ms": 6.675224069898963, "mean_inference_ms": 1.0011936830820334}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4519424, "num_steps_sampled": 1712000, "sample_time_ms": 9377.245, "load_time_ms": 15.954, "grad_time_ms": 27673.108, "update_time_ms": 37.679, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04800701141357422, "policy_loss": 0.04800007864832878, "vf_loss": 6.937870025634766, "vf_explained_var": 0.19260546565055847, "kl": 0.008035986684262753, "entropy": 0.11274639517068863, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1712000, "episodes_total": 50653, "training_iteration": 428, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-25-14", "timestamp": 1581513914, "time_this_iter_s": 36.54576563835144, "time_total_s": 13312.836763620377, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88f28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13312.836763620377, "timesteps_since_restore": 1712000, "iterations_since_restore": 428, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -42.40000000000006, "episode_reward_mean": -14.928455284552829, "episode_len_mean": 31.747967479674795, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.9627027027027}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.589857396459238, "mean_processing_ms": 6.705199463115588, "mean_inference_ms": 1.0009201600294582}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4529152, "num_steps_sampled": 1716000, "sample_time_ms": 9276.061, "load_time_ms": 15.8, "grad_time_ms": 27470.737, "update_time_ms": 37.639, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02678145468235016, "policy_loss": 0.02677483856678009, "vf_loss": 6.613351345062256, "vf_explained_var": 0.1998811960220337, "kl": 0.0030060792341828346, "entropy": 0.10577701032161713, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1716000, "episodes_total": 50776, "training_iteration": 429, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-25-49", "timestamp": 1581513949, "time_this_iter_s": 34.90307831764221, "time_total_s": 13347.739841938019, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13347.739841938019, "timesteps_since_restore": 1716000, "iterations_since_restore": 429, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.204687499999984, "episode_len_mean": 31.6484375, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.028940568475449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.579709350625786, "mean_processing_ms": 6.696026574165039, "mean_inference_ms": 1.0017809224998633}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4539136, "num_steps_sampled": 1720000, "sample_time_ms": 9238.179, "load_time_ms": 16.758, "grad_time_ms": 27397.508, "update_time_ms": 37.861, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.018601927906274796, "policy_loss": 0.018595434725284576, "vf_loss": 6.493766784667969, "vf_explained_var": 0.2565259635448456, "kl": 0.003209264250472188, "entropy": 0.08996715396642685, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1720000, "episodes_total": 50904, "training_iteration": 430, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-26-26", "timestamp": 1581513986, "time_this_iter_s": 36.19516921043396, "time_total_s": 13383.935011148453, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa9d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13383.935011148453, "timesteps_since_restore": 1720000, "iterations_since_restore": 430, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.684403669724755, "episode_len_mean": 36.88990825688074, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.920348837209299}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.591056816498792, "mean_processing_ms": 6.697669163488521, "mean_inference_ms": 1.0029354831053083}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4549504, "num_steps_sampled": 1724000, "sample_time_ms": 9271.884, "load_time_ms": 16.244, "grad_time_ms": 27446.745, "update_time_ms": 37.547, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0012277858331799507, "policy_loss": 0.0012213042937219143, "vf_loss": 6.478085994720459, "vf_explained_var": 0.18621110916137695, "kl": 0.002093779155984521, "entropy": 0.09255263954401016, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1724000, "episodes_total": 51013, "training_iteration": 431, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-27-03", "timestamp": 1581514023, "time_this_iter_s": 36.228970766067505, "time_total_s": 13420.16398191452, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281f28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13420.16398191452, "timesteps_since_restore": 1724000, "iterations_since_restore": 431, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.391869918699182, "episode_len_mean": 32.97560975609756, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.659259259259256}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.582241139655897, "mean_processing_ms": 6.701205909060903, "mean_inference_ms": 1.003243726316903}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4560256, "num_steps_sampled": 1728000, "sample_time_ms": 9296.677, "load_time_ms": 16.017, "grad_time_ms": 27513.619, "update_time_ms": 38.402, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.011949309147894382, "policy_loss": 0.011942477896809578, "vf_loss": 6.828305721282959, "vf_explained_var": 0.1724025011062622, "kl": 0.0024314604233950377, "entropy": 0.10170233994722366, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1728000, "episodes_total": 51136, "training_iteration": 432, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-27-42", "timestamp": 1581514062, "time_this_iter_s": 38.394447803497314, "time_total_s": 13458.558429718018, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204d08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13458.558429718018, "timesteps_since_restore": 1728000, "iterations_since_restore": 432, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.781666666666663, "episode_len_mean": 32.88333333333333, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.64497354497354}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.596024464228955, "mean_processing_ms": 6.719546245694536, "mean_inference_ms": 1.0040523826852719}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4571392, "num_steps_sampled": 1732000, "sample_time_ms": 9222.173, "load_time_ms": 17.181, "grad_time_ms": 27714.101, "update_time_ms": 39.084, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.05839809402823448, "policy_loss": -0.05840460956096649, "vf_loss": 6.5035834312438965, "vf_explained_var": 0.21325995028018951, "kl": 0.0018303928663954139, "entropy": 0.10530787706375122, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1732000, "episodes_total": 51256, "training_iteration": 433, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-28-22", "timestamp": 1581514102, "time_this_iter_s": 38.88239240646362, "time_total_s": 13497.440822124481, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13497.440822124481, "timesteps_since_restore": 1732000, "iterations_since_restore": 433, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.776271186440674, "episode_len_mean": 33.932203389830505, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.8105263157894695}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.600478210228232, "mean_processing_ms": 6.727561500190493, "mean_inference_ms": 1.004365600698645}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4582144, "num_steps_sampled": 1736000, "sample_time_ms": 9138.335, "load_time_ms": 16.751, "grad_time_ms": 27857.493, "update_time_ms": 39.056, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03967134654521942, "policy_loss": -0.039677757769823074, "vf_loss": 6.409651279449463, "vf_explained_var": 0.19188715517520905, "kl": 0.0031909013632684946, "entropy": 0.1078992486000061, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1736000, "episodes_total": 51374, "training_iteration": 434, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-29-00", "timestamp": 1581514140, "time_this_iter_s": 37.91036319732666, "time_total_s": 13535.351185321808, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aac80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13535.351185321808, "timesteps_since_restore": 1736000, "iterations_since_restore": 434, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.023255813953483, "episode_len_mean": 30.751937984496124, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.129032258064514}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.601486820020882, "mean_processing_ms": 6.718507753402046, "mean_inference_ms": 1.005288961723027}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4592768, "num_steps_sampled": 1740000, "sample_time_ms": 9207.47, "load_time_ms": 16.727, "grad_time_ms": 27813.868, "update_time_ms": 38.669, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01971951127052307, "policy_loss": -0.019726073369383812, "vf_loss": 6.562321186065674, "vf_explained_var": 0.2458857297897339, "kl": 0.002404181519523263, "entropy": 0.05867519602179527, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1740000, "episodes_total": 51503, "training_iteration": 435, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-29-39", "timestamp": 1581514179, "time_this_iter_s": 38.21770524978638, "time_total_s": 13573.568890571594, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac3268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13573.568890571594, "timesteps_since_restore": 1740000, "iterations_since_restore": 435, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.35934959349592, "episode_len_mean": 32.82113821138211, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.199483204134364}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.588567290207757, "mean_processing_ms": 6.725155584119583, "mean_inference_ms": 1.0060836069606083}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4603136, "num_steps_sampled": 1744000, "sample_time_ms": 9301.99, "load_time_ms": 17.58, "grad_time_ms": 27808.961, "update_time_ms": 38.914, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.010082545690238476, "policy_loss": -0.010089092887938023, "vf_loss": 6.547924041748047, "vf_explained_var": 0.2317037731409073, "kl": 0.0045740315690636635, "entropy": 0.10614924877882004, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1744000, "episodes_total": 51626, "training_iteration": 436, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-30-17", "timestamp": 1581514217, "time_this_iter_s": 37.048125982284546, "time_total_s": 13610.617016553879, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13610.617016553879, "timesteps_since_restore": 1744000, "iterations_since_restore": 436, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.928124999999989, "episode_len_mean": 31.5234375, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.009336609336606}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.608967692555197, "mean_processing_ms": 6.730371645465748, "mean_inference_ms": 1.0062247875196455}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4613504, "num_steps_sampled": 1748000, "sample_time_ms": 9265.402, "load_time_ms": 16.99, "grad_time_ms": 27812.915, "update_time_ms": 39.297, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013351060450077057, "policy_loss": 0.013344770297408104, "vf_loss": 6.294585227966309, "vf_explained_var": 0.24046535789966583, "kl": 0.007501713931560516, "entropy": 0.07898452877998352, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1748000, "episodes_total": 51754, "training_iteration": 437, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-30-55", "timestamp": 1581514255, "time_this_iter_s": 37.20468068122864, "time_total_s": 13647.821697235107, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b2048c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13647.821697235107, "timesteps_since_restore": 1748000, "iterations_since_restore": 437, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.999999999999986, "episode_len_mean": 33.96521739130435, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.538243626062319}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.608297789935964, "mean_processing_ms": 6.732750650879054, "mean_inference_ms": 1.006877721215257}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4623744, "num_steps_sampled": 1752000, "sample_time_ms": 9281.335, "load_time_ms": 16.713, "grad_time_ms": 27799.255, "update_time_ms": 39.66, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 7.593780901515856e-05, "policy_loss": 6.912648677825928e-05, "vf_loss": 6.814853668212891, "vf_explained_var": 0.1869392842054367, "kl": 0.0036385327111929655, "entropy": 0.07646103948354721, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1752000, "episodes_total": 51869, "training_iteration": 438, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-31-32", "timestamp": 1581514292, "time_this_iter_s": 36.56998348236084, "time_total_s": 13684.391680717468, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281d90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13684.391680717468, "timesteps_since_restore": 1752000, "iterations_since_restore": 438, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.006153846153834, "episode_len_mean": 30.73076923076923, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.976530612244895}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.599024982989543, "mean_processing_ms": 6.741438486414863, "mean_inference_ms": 1.0078936968859575}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4633856, "num_steps_sampled": 1756000, "sample_time_ms": 9288.928, "load_time_ms": 17.554, "grad_time_ms": 27857.741, "update_time_ms": 40.249, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01399711612612009, "policy_loss": 0.013990948908030987, "vf_loss": 6.174160480499268, "vf_explained_var": 0.2334834784269333, "kl": 0.001681767520494759, "entropy": 0.0766761526465416, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1756000, "episodes_total": 51999, "training_iteration": 439, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-32-08", "timestamp": 1581514328, "time_this_iter_s": 35.576435565948486, "time_total_s": 13719.968116283417, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13719.968116283417, "timesteps_since_restore": 1756000, "iterations_since_restore": 439, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -41.00000000000004, "episode_reward_mean": -15.715702479338823, "episode_len_mean": 34.06611570247934, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.253038674033147}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.622147684892405, "mean_processing_ms": 6.728895082346098, "mean_inference_ms": 1.0083640347700635}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4643328, "num_steps_sampled": 1760000, "sample_time_ms": 9362.629, "load_time_ms": 16.549, "grad_time_ms": 27686.358, "update_time_ms": 40.277, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013145700097084045, "policy_loss": 0.01313946582376957, "vf_loss": 6.2396745681762695, "vf_explained_var": 0.1961999088525772, "kl": 0.0018843025900423527, "entropy": 0.056387901306152344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1760000, "episodes_total": 52120, "training_iteration": 440, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-32-44", "timestamp": 1581514364, "time_this_iter_s": 35.207409381866455, "time_total_s": 13755.175525665283, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387bf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13755.175525665283, "timesteps_since_restore": 1760000, "iterations_since_restore": 440, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.88392857142855, "episode_len_mean": 34.69642857142857, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.497093023255811}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.605272760219778, "mean_processing_ms": 6.736403408990526, "mean_inference_ms": 1.00882287851101}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4653440, "num_steps_sampled": 1764000, "sample_time_ms": 9362.442, "load_time_ms": 16.297, "grad_time_ms": 27619.12, "update_time_ms": 40.661, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03579976409673691, "policy_loss": 0.035793233662843704, "vf_loss": 6.515187740325928, "vf_explained_var": 0.22048062086105347, "kl": 0.003988169599324465, "entropy": 0.06421923637390137, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1764000, "episodes_total": 52232, "training_iteration": 441, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-33-20", "timestamp": 1581514400, "time_this_iter_s": 35.556723833084106, "time_total_s": 13790.732249498367, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459d90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13790.732249498367, "timesteps_since_restore": 1764000, "iterations_since_restore": 441, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.758064516129018, "episode_len_mean": 32.08870967741935, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.260759493670883}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.603242420883038, "mean_processing_ms": 6.736608067747243, "mean_inference_ms": 1.0102200207014906}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4664064, "num_steps_sampled": 1768000, "sample_time_ms": 9315.569, "load_time_ms": 17.096, "grad_time_ms": 27554.889, "update_time_ms": 39.51, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014124464243650436, "policy_loss": 0.014117706567049026, "vf_loss": 6.752912998199463, "vf_explained_var": 0.21930396556854248, "kl": 0.002913834759965539, "entropy": 0.07577814161777496, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1768000, "episodes_total": 52356, "training_iteration": 442, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-33-58", "timestamp": 1581514438, "time_this_iter_s": 37.28255105018616, "time_total_s": 13828.014800548553, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13828.014800548553, "timesteps_since_restore": 1768000, "iterations_since_restore": 442, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.763333333333325, "episode_len_mean": 33.86666666666667, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.639153439153436}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6260917691164645, "mean_processing_ms": 6.746333331768112, "mean_inference_ms": 1.0104337219912678}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4674816, "num_steps_sampled": 1772000, "sample_time_ms": 9346.511, "load_time_ms": 16.251, "grad_time_ms": 27481.144, "update_time_ms": 39.55, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.010171917267143726, "policy_loss": 0.010165022686123848, "vf_loss": 6.892307758331299, "vf_explained_var": 0.16768287122249603, "kl": 0.0033689949195832014, "entropy": 0.0742102637887001, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1772000, "episodes_total": 52476, "training_iteration": 443, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-34-37", "timestamp": 1581514477, "time_this_iter_s": 38.44538688659668, "time_total_s": 13866.46018743515, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13866.46018743515, "timesteps_since_restore": 1772000, "iterations_since_restore": 443, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.565811965811957, "episode_len_mean": 33.51282051282051, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.599999999999997}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.615079208669148, "mean_processing_ms": 6.747785846547524, "mean_inference_ms": 1.011135950369699}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4685440, "num_steps_sampled": 1776000, "sample_time_ms": 9389.565, "load_time_ms": 15.965, "grad_time_ms": 27428.286, "update_time_ms": 39.846, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013400302268564701, "policy_loss": 0.013393298722803593, "vf_loss": 7.00969934463501, "vf_explained_var": 0.19819577038288116, "kl": 0.0021924846805632114, "entropy": 0.0716296061873436, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1776000, "episodes_total": 52593, "training_iteration": 444, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-35-16", "timestamp": 1581514516, "time_this_iter_s": 37.81323981285095, "time_total_s": 13904.273427248001, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b387378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13904.273427248001, "timesteps_since_restore": 1776000, "iterations_since_restore": 444, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.046153846153832, "episode_len_mean": 35.042735042735046, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.848753462603875}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.617678161597089, "mean_processing_ms": 6.745702302450468, "mean_inference_ms": 1.011577380511196}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4696064, "num_steps_sampled": 1780000, "sample_time_ms": 9320.455, "load_time_ms": 16.613, "grad_time_ms": 27430.088, "update_time_ms": 40.429, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.006673203315585852, "policy_loss": 0.006666789762675762, "vf_loss": 6.415136337280273, "vf_explained_var": 0.21557143330574036, "kl": 0.0022145071998238564, "entropy": 0.08651753515005112, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1780000, "episodes_total": 52710, "training_iteration": 445, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-35-54", "timestamp": 1581514554, "time_this_iter_s": 37.55690956115723, "time_total_s": 13941.830336809158, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34292a598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13941.830336809158, "timesteps_since_restore": 1780000, "iterations_since_restore": 445, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.888888888888879, "episode_len_mean": 29.022222222222222, "episodes_this_iter": 135, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.808612440191384}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.618676589186757, "mean_processing_ms": 6.760363473342052, "mean_inference_ms": 1.0124328089630388}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4706688, "num_steps_sampled": 1784000, "sample_time_ms": 9336.625, "load_time_ms": 16.055, "grad_time_ms": 27562.418, "update_time_ms": 40.062, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03084806352853775, "policy_loss": -0.030854791402816772, "vf_loss": 6.7277021408081055, "vf_explained_var": 0.2584422528743744, "kl": 0.0009753549820743501, "entropy": 0.05776515230536461, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1784000, "episodes_total": 52845, "training_iteration": 446, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-36-33", "timestamp": 1581514593, "time_this_iter_s": 38.52549457550049, "time_total_s": 13980.355831384659, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13980.355831384659, "timesteps_since_restore": 1784000, "iterations_since_restore": 446, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.346268656716408, "episode_len_mean": 29.761194029850746, "episodes_this_iter": 134, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.027872860635694}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.627996694345817, "mean_processing_ms": 6.761851616171043, "mean_inference_ms": 1.0133230266392192}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4717312, "num_steps_sampled": 1788000, "sample_time_ms": 9323.099, "load_time_ms": 16.016, "grad_time_ms": 27628.045, "update_time_ms": 39.86, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.020308787003159523, "policy_loss": -0.020315609872341156, "vf_loss": 6.821303844451904, "vf_explained_var": 0.22857357561588287, "kl": 0.002048589987680316, "entropy": 0.06456775963306427, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1788000, "episodes_total": 52979, "training_iteration": 447, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-37-11", "timestamp": 1581514631, "time_this_iter_s": 37.724562883377075, "time_total_s": 14018.080394268036, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3362812f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14018.080394268036, "timesteps_since_restore": 1788000, "iterations_since_restore": 447, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.86849315068492, "episode_len_mean": 27.965753424657535, "episodes_this_iter": 146, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.499555555555553}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.621809232700962, "mean_processing_ms": 6.773083551813448, "mean_inference_ms": 1.0133988331791226}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4727680, "num_steps_sampled": 1792000, "sample_time_ms": 9381.79, "load_time_ms": 16.907, "grad_time_ms": 27681.855, "update_time_ms": 39.839, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.011380799114704132, "policy_loss": 0.011374871246516705, "vf_loss": 5.933383464813232, "vf_explained_var": 0.2901076078414917, "kl": 0.007856718264520168, "entropy": 0.0650518611073494, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1792000, "episodes_total": 53125, "training_iteration": 448, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-37-50", "timestamp": 1581514670, "time_this_iter_s": 37.70131325721741, "time_total_s": 14055.781707525253, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14055.781707525253, "timesteps_since_restore": 1792000, "iterations_since_restore": 448, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.238167938931289, "episode_len_mean": 30.15267175572519, "episodes_this_iter": 131, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.015577889447234}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.633172682201559, "mean_processing_ms": 6.7767480037795265, "mean_inference_ms": 1.01290281066784}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4738048, "num_steps_sampled": 1796000, "sample_time_ms": 9353.117, "load_time_ms": 16.18, "grad_time_ms": 27513.863, "update_time_ms": 39.121, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0419873371720314, "policy_loss": -0.04199345409870148, "vf_loss": 6.119119167327881, "vf_explained_var": 0.2446119487285614, "kl": 0.002333970507606864, "entropy": 0.07949040085077286, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1796000, "episodes_total": 53256, "training_iteration": 449, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-38-24", "timestamp": 1581514704, "time_this_iter_s": 33.59465432167053, "time_total_s": 14089.376361846924, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac886a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14089.376361846924, "timesteps_since_restore": 1796000, "iterations_since_restore": 449, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -38.60000000000001, "episode_reward_mean": -15.82362204724408, "episode_len_mean": 32.23622047244095, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.074747474747472}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6217861202393395, "mean_processing_ms": 6.7946019078464746, "mean_inference_ms": 1.0129232461459508}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4748160, "num_steps_sampled": 1800000, "sample_time_ms": 9167.375, "load_time_ms": 16.041, "grad_time_ms": 27561.985, "update_time_ms": 38.495, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01767214946448803, "policy_loss": 0.01766577921807766, "vf_loss": 6.371959209442139, "vf_explained_var": 0.21203912794589996, "kl": 0.0022952810395509005, "entropy": 0.07233557850122452, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1800000, "episodes_total": 53383, "training_iteration": 450, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-38-59", "timestamp": 1581514739, "time_this_iter_s": 33.82127285003662, "time_total_s": 14123.19763469696, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88c80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14123.19763469696, "timesteps_since_restore": 1800000, "iterations_since_restore": 450, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.072727272727258, "episode_len_mean": 30.060606060606062, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.888452088452086}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.638218607995098, "mean_processing_ms": 6.78809615620837, "mean_inference_ms": 1.0141957809757602}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4758528, "num_steps_sampled": 1804000, "sample_time_ms": 9274.627, "load_time_ms": 17.507, "grad_time_ms": 27582.522, "update_time_ms": 37.913, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.028439857065677643, "policy_loss": 0.02843339927494526, "vf_loss": 6.460622310638428, "vf_explained_var": 0.2498140037059784, "kl": 0.006145956460386515, "entropy": 0.07931660115718842, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1804000, "episodes_total": 53515, "training_iteration": 451, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-39-36", "timestamp": 1581514776, "time_this_iter_s": 36.83955097198486, "time_total_s": 14160.037185668945, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14160.037185668945, "timesteps_since_restore": 1804000, "iterations_since_restore": 451, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.048648648648637, "episode_len_mean": 36.189189189189186, "episodes_this_iter": 111, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.006818181818178}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.627086080578538, "mean_processing_ms": 6.792312358306321, "mean_inference_ms": 1.0143639354928002}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4769280, "num_steps_sampled": 1808000, "sample_time_ms": 9217.874, "load_time_ms": 16.874, "grad_time_ms": 27599.458, "update_time_ms": 38.042, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011557710357010365, "policy_loss": -0.011564678512513638, "vf_loss": 6.969908237457275, "vf_explained_var": 0.14805082976818085, "kl": 0.0040336125530302525, "entropy": 0.08618899434804916, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1808000, "episodes_total": 53626, "training_iteration": 452, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-40-13", "timestamp": 1581514813, "time_this_iter_s": 36.878639459609985, "time_total_s": 14196.915825128555, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa0d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14196.915825128555, "timesteps_since_restore": 1808000, "iterations_since_restore": 452, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.099099099099085, "episode_len_mean": 35.4054054054054, "episodes_this_iter": 111, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.70738636363636}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.632375445069627, "mean_processing_ms": 6.786956112791312, "mean_inference_ms": 1.0151780289589427}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4779776, "num_steps_sampled": 1812000, "sample_time_ms": 9177.505, "load_time_ms": 16.694, "grad_time_ms": 27523.12, "update_time_ms": 37.768, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.007977981120347977, "policy_loss": 0.007970888167619705, "vf_loss": 7.09055233001709, "vf_explained_var": 0.14700642228126526, "kl": 0.004770735278725624, "entropy": 0.09332350641489029, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1812000, "episodes_total": 53737, "training_iteration": 453, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-40-51", "timestamp": 1581514851, "time_this_iter_s": 37.27557945251465, "time_total_s": 14234.19140458107, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14234.19140458107, "timesteps_since_restore": 1812000, "iterations_since_restore": 453, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.058015267175563, "episode_len_mean": 30.778625954198475, "episodes_this_iter": 131, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.181280788177338}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.637966772403299, "mean_processing_ms": 6.787819877614627, "mean_inference_ms": 1.015316284346294}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4790528, "num_steps_sampled": 1816000, "sample_time_ms": 9219.439, "load_time_ms": 17.524, "grad_time_ms": 27604.352, "update_time_ms": 38.058, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.003490923438221216, "policy_loss": -0.0034972275607287884, "vf_loss": 6.307633399963379, "vf_explained_var": 0.21896518766880035, "kl": 0.003192899050191045, "entropy": 0.1339644193649292, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1816000, "episodes_total": 53868, "training_iteration": 454, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-41-31", "timestamp": 1581514891, "time_this_iter_s": 39.05461001396179, "time_total_s": 14273.246014595032, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac88d90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14273.246014595032, "timesteps_since_restore": 1816000, "iterations_since_restore": 454, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.97599999999998, "episode_len_mean": 40.41, "episodes_this_iter": 94, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.744694533762053}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.632438293317424, "mean_processing_ms": 6.780208841682372, "mean_inference_ms": 1.016184147034644}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4801024, "num_steps_sampled": 1820000, "sample_time_ms": 9110.849, "load_time_ms": 16.743, "grad_time_ms": 27560.622, "update_time_ms": 37.262, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04951874911785126, "policy_loss": -0.04952603951096535, "vf_loss": 7.2919182777404785, "vf_explained_var": 0.12199151515960693, "kl": 0.0023414429742842913, "entropy": 0.0772988423705101, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1820000, "episodes_total": 53962, "training_iteration": 455, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-42-08", "timestamp": 1581514928, "time_this_iter_s": 36.01722168922424, "time_total_s": 14309.263236284256, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14309.263236284256, "timesteps_since_restore": 1820000, "iterations_since_restore": 455, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.851239669421478, "episode_len_mean": 33.34710743801653, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.885558583106263}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.639927824170066, "mean_processing_ms": 6.790797024772551, "mean_inference_ms": 1.0169429891453483}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4812032, "num_steps_sampled": 1824000, "sample_time_ms": 9080.638, "load_time_ms": 16.718, "grad_time_ms": 27651.092, "update_time_ms": 37.718, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.035978127270936966, "policy_loss": 0.03597082197666168, "vf_loss": 7.310798168182373, "vf_explained_var": 0.19107933342456818, "kl": 0.0036221728660166264, "entropy": 0.11064872145652771, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1824000, "episodes_total": 54083, "training_iteration": 456, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-42-48", "timestamp": 1581514968, "time_this_iter_s": 39.13407850265503, "time_total_s": 14348.397314786911, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14348.397314786911, "timesteps_since_restore": 1824000, "iterations_since_restore": 456, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.556060606060596, "episode_len_mean": 30.25, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.29226804123711}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.643914319599155, "mean_processing_ms": 6.806686519840444, "mean_inference_ms": 1.0170863689119551}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4822656, "num_steps_sampled": 1828000, "sample_time_ms": 9121.802, "load_time_ms": 17.477, "grad_time_ms": 27629.014, "update_time_ms": 37.906, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03785146400332451, "policy_loss": 0.037845153361558914, "vf_loss": 6.311924934387207, "vf_explained_var": 0.2315569967031479, "kl": 0.0024357906077057123, "entropy": 0.07720307260751724, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1828000, "episodes_total": 54215, "training_iteration": 457, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-43-26", "timestamp": 1581515006, "time_this_iter_s": 37.922794818878174, "time_total_s": 14386.32010960579, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14386.32010960579, "timesteps_since_restore": 1828000, "iterations_since_restore": 457, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.438410596026483, "episode_len_mean": 26.629139072847682, "episodes_this_iter": 151, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.363870967741933}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.641438700703339, "mean_processing_ms": 6.827948280896652, "mean_inference_ms": 1.0171534669900526}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4833152, "num_steps_sampled": 1832000, "sample_time_ms": 9169.033, "load_time_ms": 16.985, "grad_time_ms": 27607.424, "update_time_ms": 37.244, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03350605443120003, "policy_loss": -0.0335114561021328, "vf_loss": 5.395753860473633, "vf_explained_var": 0.25948938727378845, "kl": 0.0011453204788267612, "entropy": 0.04749002307653427, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1832000, "episodes_total": 54366, "training_iteration": 458, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-44-05", "timestamp": 1581515045, "time_this_iter_s": 37.94888973236084, "time_total_s": 14424.26899933815, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af8c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14424.26899933815, "timesteps_since_restore": 1832000, "iterations_since_restore": 458, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.282926829268284, "episode_len_mean": 31.682926829268293, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.188601036269427}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.653373154789478, "mean_processing_ms": 6.808226242179369, "mean_inference_ms": 1.0189249216290293}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4843648, "num_steps_sampled": 1836000, "sample_time_ms": 9152.88, "load_time_ms": 16.985, "grad_time_ms": 27943.997, "update_time_ms": 37.599, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.003253531875088811, "policy_loss": -0.0032601701095700264, "vf_loss": 6.636938095092773, "vf_explained_var": 0.20956756174564362, "kl": 0.003614207962527871, "entropy": 0.06100344657897949, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1836000, "episodes_total": 54489, "training_iteration": 459, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-44-42", "timestamp": 1581515082, "time_this_iter_s": 36.80398607254028, "time_total_s": 14461.07298541069, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff35b7da378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14461.07298541069, "timesteps_since_restore": 1836000, "iterations_since_restore": 459, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.472268907563006, "episode_len_mean": 34.747899159663866, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.759556786703598}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.650612379146121, "mean_processing_ms": 6.8016283688164805, "mean_inference_ms": 1.019822799646827}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4853888, "num_steps_sampled": 1840000, "sample_time_ms": 9345.817, "load_time_ms": 17.78, "grad_time_ms": 28060.411, "update_time_ms": 38.16, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011426267214119434, "policy_loss": -0.011432811617851257, "vf_loss": 6.53940486907959, "vf_explained_var": 0.22860178351402283, "kl": 0.002552942605689168, "entropy": 0.09074679017066956, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1840000, "episodes_total": 54608, "training_iteration": 460, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-45-20", "timestamp": 1581515120, "time_this_iter_s": 36.93011260032654, "time_total_s": 14498.003098011017, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c0d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14498.003098011017, "timesteps_since_restore": 1840000, "iterations_since_restore": 460, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.244961240310067, "episode_len_mean": 30.31782945736434, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.068556701030925}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.637919233048425, "mean_processing_ms": 6.8059205311030215, "mean_inference_ms": 1.020099644720929}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4864384, "num_steps_sampled": 1844000, "sample_time_ms": 9339.961, "load_time_ms": 16.652, "grad_time_ms": 28131.424, "update_time_ms": 38.392, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.027779050171375275, "policy_loss": 0.027772027999162674, "vf_loss": 7.02683162689209, "vf_explained_var": 0.26400041580200195, "kl": 0.0011892965994775295, "entropy": 0.05430108308792114, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1844000, "episodes_total": 54737, "training_iteration": 461, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-45-58", "timestamp": 1581515158, "time_this_iter_s": 37.48592758178711, "time_total_s": 14535.489025592804, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3362816a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14535.489025592804, "timesteps_since_restore": 1844000, "iterations_since_restore": 461, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.847058823529405, "episode_len_mean": 34.46218487394958, "episodes_this_iter": 119, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.755555555555552}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.647752355225466, "mean_processing_ms": 6.8285481047281165, "mean_inference_ms": 1.0199987587064905}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4874880, "num_steps_sampled": 1848000, "sample_time_ms": 9423.161, "load_time_ms": 16.534, "grad_time_ms": 28041.711, "update_time_ms": 39.107, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03574343025684357, "policy_loss": 0.03573639318346977, "vf_loss": 7.037411689758301, "vf_explained_var": 0.18638862669467926, "kl": 0.0025588306598365307, "entropy": 0.0617557093501091, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1848000, "episodes_total": 54856, "training_iteration": 462, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-46-36", "timestamp": 1581515196, "time_this_iter_s": 36.81928896903992, "time_total_s": 14572.308314561844, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14572.308314561844, "timesteps_since_restore": 1848000, "iterations_since_restore": 462, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -38.80000000000001, "episode_reward_mean": -16.608474576271167, "episode_len_mean": 33.25423728813559, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.567613636363633}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6534350946351575, "mean_processing_ms": 6.833703878393813, "mean_inference_ms": 1.0210780155856714}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4885248, "num_steps_sampled": 1852000, "sample_time_ms": 9419.545, "load_time_ms": 17.602, "grad_time_ms": 28005.851, "update_time_ms": 39.412, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00010498658957658336, "policy_loss": 9.831510396907106e-05, "vf_loss": 6.669894695281982, "vf_explained_var": 0.21916523575782776, "kl": 0.0039151632227003574, "entropy": 0.10591638833284378, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1852000, "episodes_total": 54974, "training_iteration": 463, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-47-13", "timestamp": 1581515233, "time_this_iter_s": 36.893816232681274, "time_total_s": 14609.202130794525, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7afae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14609.202130794525, "timesteps_since_restore": 1852000, "iterations_since_restore": 463, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.604580152671744, "episode_len_mean": 30.900763358778626, "episodes_this_iter": 131, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.1104999999999965}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.653857800889701, "mean_processing_ms": 6.835800427797598, "mean_inference_ms": 1.0204431942924448}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4895744, "num_steps_sampled": 1856000, "sample_time_ms": 9388.742, "load_time_ms": 17.268, "grad_time_ms": 27979.192, "update_time_ms": 39.254, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01708906516432762, "policy_loss": -0.017095867544412613, "vf_loss": 6.798211097717285, "vf_explained_var": 0.21023419499397278, "kl": 0.002733045257627964, "entropy": 0.11061962693929672, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1856000, "episodes_total": 55105, "training_iteration": 464, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-47-53", "timestamp": 1581515273, "time_this_iter_s": 38.475794553756714, "time_total_s": 14647.677925348282, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d9d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14647.677925348282, "timesteps_since_restore": 1856000, "iterations_since_restore": 464, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.49279999999999, "episode_len_mean": 32.168, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.439577836411606}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.660355078322573, "mean_processing_ms": 6.83183812238304, "mean_inference_ms": 1.0215508758388059}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4906240, "num_steps_sampled": 1860000, "sample_time_ms": 9537.267, "load_time_ms": 17.271, "grad_time_ms": 28012.077, "update_time_ms": 39.265, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.003359868424013257, "policy_loss": -0.0033660640474408865, "vf_loss": 6.191934585571289, "vf_explained_var": 0.24052950739860535, "kl": 0.0022018002346158028, "entropy": 0.09045559912919998, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1860000, "episodes_total": 55230, "training_iteration": 465, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-48-31", "timestamp": 1581515311, "time_this_iter_s": 37.832226276397705, "time_total_s": 14685.51015162468, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14685.51015162468, "timesteps_since_restore": 1860000, "iterations_since_restore": 465, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.835460992907796, "episode_len_mean": 28.141843971631207, "episodes_this_iter": 141, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.830946882217089}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.659485453987641, "mean_processing_ms": 6.851417823559183, "mean_inference_ms": 1.0223259060397154}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4917248, "num_steps_sampled": 1864000, "sample_time_ms": 9521.641, "load_time_ms": 17.803, "grad_time_ms": 27951.251, "update_time_ms": 39.121, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03302440792322159, "policy_loss": 0.03301795944571495, "vf_loss": 6.451949596405029, "vf_explained_var": 0.21033024787902832, "kl": 0.00253982818685472, "entropy": 0.10876604914665222, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1864000, "episodes_total": 55371, "training_iteration": 466, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-49-10", "timestamp": 1581515350, "time_this_iter_s": 38.37441945075989, "time_total_s": 14723.88457107544, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aad90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14723.88457107544, "timesteps_since_restore": 1864000, "iterations_since_restore": 466, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.148529411764695, "episode_len_mean": 29.375, "episodes_this_iter": 136, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.20252525252525}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.658398781693902, "mean_processing_ms": 6.851528566128603, "mean_inference_ms": 1.022714136296489}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4927872, "num_steps_sampled": 1868000, "sample_time_ms": 9574.287, "load_time_ms": 16.966, "grad_time_ms": 27980.797, "update_time_ms": 39.059, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03986088186502457, "policy_loss": -0.03986693546175957, "vf_loss": 6.054409027099609, "vf_explained_var": 0.21747902035713196, "kl": 0.0019482516217976809, "entropy": 0.0781303346157074, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1868000, "episodes_total": 55507, "training_iteration": 467, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-49-49", "timestamp": 1581515389, "time_this_iter_s": 38.73492074012756, "time_total_s": 14762.619491815567, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281bf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14762.619491815567, "timesteps_since_restore": 1868000, "iterations_since_restore": 467, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.75371900826445, "episode_len_mean": 33.72727272727273, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.805945945945943}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.662598199774684, "mean_processing_ms": 6.85852462581854, "mean_inference_ms": 1.023301415268003}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4938624, "num_steps_sampled": 1872000, "sample_time_ms": 9501.497, "load_time_ms": 16.648, "grad_time_ms": 28050.219, "update_time_ms": 39.444, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.003326510777696967, "policy_loss": -0.0033333091996610165, "vf_loss": 6.802786827087402, "vf_explained_var": 0.17660443484783173, "kl": 0.007142913527786732, "entropy": 0.07419842481613159, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1872000, "episodes_total": 55628, "training_iteration": 468, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-50-28", "timestamp": 1581515428, "time_this_iter_s": 37.91695475578308, "time_total_s": 14800.53644657135, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14800.53644657135, "timesteps_since_restore": 1872000, "iterations_since_restore": 468, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.240601503759388, "episode_len_mean": 29.398496240601503, "episodes_this_iter": 133, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.997361477572557}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.659199924571522, "mean_processing_ms": 6.864235344650522, "mean_inference_ms": 1.0234179788754958}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4948608, "num_steps_sampled": 1876000, "sample_time_ms": 9638.259, "load_time_ms": 17.844, "grad_time_ms": 27871.041, "update_time_ms": 39.253, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00527114886790514, "policy_loss": -0.005277423653751612, "vf_loss": 6.274332523345947, "vf_explained_var": 0.23525401949882507, "kl": 0.0018767280271276832, "entropy": 0.07473228871822357, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1876000, "episodes_total": 55761, "training_iteration": 469, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-51-05", "timestamp": 1581515465, "time_this_iter_s": 36.39166450500488, "time_total_s": 14836.928111076355, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14836.928111076355, "timesteps_since_restore": 1876000, "iterations_since_restore": 469, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.672131147540966, "episode_len_mean": 32.0, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.325905292479105}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.659874281717979, "mean_processing_ms": 6.857853790514444, "mean_inference_ms": 1.024134067807183}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4958848, "num_steps_sampled": 1880000, "sample_time_ms": 9510.954, "load_time_ms": 17.152, "grad_time_ms": 27906.237, "update_time_ms": 38.831, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03721132501959801, "policy_loss": 0.03720416873693466, "vf_loss": 7.150502681732178, "vf_explained_var": 0.2046855390071869, "kl": 0.003443764057010412, "entropy": 0.10993494838476181, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1880000, "episodes_total": 55883, "training_iteration": 470, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-51-42", "timestamp": 1581515502, "time_this_iter_s": 35.99915313720703, "time_total_s": 14872.927264213562, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b3877b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14872.927264213562, "timesteps_since_restore": 1880000, "iterations_since_restore": 470, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.665185185185173, "episode_len_mean": 30.666666666666668, "episodes_this_iter": 135, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.260696517412931}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6631002496432, "mean_processing_ms": 6.871693754138945, "mean_inference_ms": 1.0251407010493856}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4969344, "num_steps_sampled": 1884000, "sample_time_ms": 9553.356, "load_time_ms": 16.833, "grad_time_ms": 28170.872, "update_time_ms": 39.211, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.013890836387872696, "policy_loss": -0.013897132128477097, "vf_loss": 6.288464069366455, "vf_explained_var": 0.2367745190858841, "kl": 0.009370430372655392, "entropy": 0.0875246599316597, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1884000, "episodes_total": 56018, "training_iteration": 471, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-52-23", "timestamp": 1581515543, "time_this_iter_s": 40.55651235580444, "time_total_s": 14913.483776569366, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14913.483776569366, "timesteps_since_restore": 1884000, "iterations_since_restore": 471, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.871186440677953, "episode_len_mean": 33.11864406779661, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.737175792507201}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.657408698584171, "mean_processing_ms": 6.849372784290633, "mean_inference_ms": 1.0269897863614035}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4979840, "num_steps_sampled": 1888000, "sample_time_ms": 9664.89, "load_time_ms": 17.982, "grad_time_ms": 28767.854, "update_time_ms": 38.824, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03725338727235794, "policy_loss": -0.03726007416844368, "vf_loss": 6.693094253540039, "vf_explained_var": 0.19323861598968506, "kl": 0.00319427577778697, "entropy": 0.1148119568824768, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1888000, "episodes_total": 56136, "training_iteration": 472, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-53-08", "timestamp": 1581515588, "time_this_iter_s": 43.91447567939758, "time_total_s": 14957.398252248764, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14957.398252248764, "timesteps_since_restore": 1888000, "iterations_since_restore": 472, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.439999999999987, "episode_len_mean": 33.68333333333333, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.733698630136983}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.666882531798054, "mean_processing_ms": 6.883191823002161, "mean_inference_ms": 1.0265835632080522}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4990464, "num_steps_sampled": 1892000, "sample_time_ms": 9652.761, "load_time_ms": 17.106, "grad_time_ms": 29042.69, "update_time_ms": 38.927, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.020792974159121513, "policy_loss": 0.02078704908490181, "vf_loss": 5.926778793334961, "vf_explained_var": 0.2235315591096878, "kl": 0.003172223223373294, "entropy": 0.11100321263074875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1892000, "episodes_total": 56256, "training_iteration": 473, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-53-48", "timestamp": 1581515628, "time_this_iter_s": 39.51568078994751, "time_total_s": 14996.913933038712, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b80e18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14996.913933038712, "timesteps_since_restore": 1892000, "iterations_since_restore": 473, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.902399999999986, "episode_len_mean": 32.544, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.545406824146979}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6715159799018435, "mean_processing_ms": 6.889041473547874, "mean_inference_ms": 1.0277173437499518}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5001088, "num_steps_sampled": 1896000, "sample_time_ms": 9738.094, "load_time_ms": 16.94, "grad_time_ms": 29555.289, "update_time_ms": 39.705, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.012686430476605892, "policy_loss": -0.012692885473370552, "vf_loss": 6.4561767578125, "vf_explained_var": 0.24103091657161713, "kl": 0.0033045541495084763, "entropy": 0.1198326051235199, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1896000, "episodes_total": 56381, "training_iteration": 474, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-54-33", "timestamp": 1581515673, "time_this_iter_s": 44.466418504714966, "time_total_s": 15041.380351543427, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15041.380351543427, "timesteps_since_restore": 1896000, "iterations_since_restore": 474, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.09354838709676, "episode_len_mean": 31.79032258064516, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.45245901639344}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.682099363308516, "mean_processing_ms": 6.874489288821051, "mean_inference_ms": 1.0295711011676847}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5011456, "num_steps_sampled": 1900000, "sample_time_ms": 9868.727, "load_time_ms": 18.093, "grad_time_ms": 30399.955, "update_time_ms": 41.39, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.019197599962353706, "policy_loss": -0.019203756004571915, "vf_loss": 6.156693935394287, "vf_explained_var": 0.22814369201660156, "kl": 0.0028734072111546993, "entropy": 0.10432405769824982, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1900000, "episodes_total": 56505, "training_iteration": 475, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-55-22", "timestamp": 1581515722, "time_this_iter_s": 47.61369705200195, "time_total_s": 15088.994048595428, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aaae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15088.994048595428, "timesteps_since_restore": 1900000, "iterations_since_restore": 475, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.844604316546754, "episode_len_mean": 29.258992805755394, "episodes_this_iter": 139, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.91285714285714}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.684123614109914, "mean_processing_ms": 6.885158441707336, "mean_inference_ms": 1.030078759765953}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5021952, "num_steps_sampled": 1904000, "sample_time_ms": 9994.441, "load_time_ms": 17.64, "grad_time_ms": 30591.365, "update_time_ms": 41.782, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0059045967645943165, "policy_loss": -0.005910423584282398, "vf_loss": 5.831705570220947, "vf_explained_var": 0.23260535299777985, "kl": 0.003936099819839001, "entropy": 0.12711945176124573, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1904000, "episodes_total": 56644, "training_iteration": 476, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-56-04", "timestamp": 1581515764, "time_this_iter_s": 41.543238401412964, "time_total_s": 15130.537286996841, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15130.537286996841, "timesteps_since_restore": 1904000, "iterations_since_restore": 476, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -38.400000000000006, "episode_reward_mean": -14.43333333333332, "episode_len_mean": 28.804347826086957, "episodes_this_iter": 138, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.765071770334926}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.693280015094236, "mean_processing_ms": 6.897618882329799, "mean_inference_ms": 1.030659284002659}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5032320, "num_steps_sampled": 1908000, "sample_time_ms": 10047.401, "load_time_ms": 17.627, "grad_time_ms": 30943.63, "update_time_ms": 42.258, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00796330813318491, "policy_loss": 0.007956882938742638, "vf_loss": 6.427552700042725, "vf_explained_var": 0.2357371300458908, "kl": 0.0022727379109710455, "entropy": 0.08951830118894577, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1908000, "episodes_total": 56782, "training_iteration": 477, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-56-47", "timestamp": 1581515807, "time_this_iter_s": 42.79590678215027, "time_total_s": 15173.333193778992, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15173.333193778992, "timesteps_since_restore": 1908000, "iterations_since_restore": 477, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.79999999999999, "episode_len_mean": 32.19166666666667, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.523287671232874}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6873855663974116, "mean_processing_ms": 6.9019195805145355, "mean_inference_ms": 1.0321275106429941}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5043072, "num_steps_sampled": 1912000, "sample_time_ms": 10187.949, "load_time_ms": 18.737, "grad_time_ms": 31328.737, "update_time_ms": 42.766, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.06165224686264992, "policy_loss": 0.06164511665701866, "vf_loss": 7.142691612243652, "vf_explained_var": 0.20039285719394684, "kl": 0.005203643348067999, "entropy": 0.11028946191072464, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1912000, "episodes_total": 56902, "training_iteration": 478, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-57-31", "timestamp": 1581515851, "time_this_iter_s": 43.191696882247925, "time_total_s": 15216.52489066124, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15216.52489066124, "timesteps_since_restore": 1912000, "iterations_since_restore": 478, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.475806451612897, "episode_len_mean": 33.21774193548387, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.763297872340422}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6846153240185044, "mean_processing_ms": 6.923059772340299, "mean_inference_ms": 1.0331049101956333}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5053824, "num_steps_sampled": 1916000, "sample_time_ms": 10272.868, "load_time_ms": 18.09, "grad_time_ms": 32014.84, "update_time_ms": 44.451, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.05049693584442139, "policy_loss": 0.050489477813243866, "vf_loss": 7.458421230316162, "vf_explained_var": 0.19961869716644287, "kl": 0.0024731233716011047, "entropy": 0.10349961370229721, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1916000, "episodes_total": 57026, "training_iteration": 479, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-58-17", "timestamp": 1581515897, "time_this_iter_s": 44.11388921737671, "time_total_s": 15260.638779878616, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fcad08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15260.638779878616, "timesteps_since_restore": 1916000, "iterations_since_restore": 479, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.027972027972023, "episode_len_mean": 27.377622377622377, "episodes_this_iter": 143, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.78758949880668}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.687313230571453, "mean_processing_ms": 6.93152431931264, "mean_inference_ms": 1.0339060967145113}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5064448, "num_steps_sampled": 1920000, "sample_time_ms": 10544.252, "load_time_ms": 18.462, "grad_time_ms": 32511.885, "update_time_ms": 45.433, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.008086826652288437, "policy_loss": -0.008093316107988358, "vf_loss": 6.4914960861206055, "vf_explained_var": 0.23167479038238525, "kl": 0.002180442214012146, "entropy": 0.12038605660200119, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1920000, "episodes_total": 57169, "training_iteration": 480, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-59-01", "timestamp": 1581515941, "time_this_iter_s": 43.70094704627991, "time_total_s": 15304.339726924896, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459ae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15304.339726924896, "timesteps_since_restore": 1920000, "iterations_since_restore": 480, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.881599999999995, "episode_len_mean": 32.416, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.553157894736839}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.698805336927846, "mean_processing_ms": 6.918061383545215, "mean_inference_ms": 1.0349200983916937}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5075200, "num_steps_sampled": 1924000, "sample_time_ms": 10541.224, "load_time_ms": 19.863, "grad_time_ms": 32831.732, "update_time_ms": 46.086, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04132290929555893, "policy_loss": 0.0413161963224411, "vf_loss": 6.7079997062683105, "vf_explained_var": 0.2130751609802246, "kl": 0.0022818867582827806, "entropy": 0.07423990964889526, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1924000, "episodes_total": 57294, "training_iteration": 481, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_13-59-46", "timestamp": 1581515986, "time_this_iter_s": 43.74689030647278, "time_total_s": 15348.086617231369, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15348.086617231369, "timesteps_since_restore": 1924000, "iterations_since_restore": 481, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.766972477064208, "episode_len_mean": 37.027522935779814, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.412539184952974}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.697777776672881, "mean_processing_ms": 6.9392417668273385, "mean_inference_ms": 1.0350447422085498}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5085440, "num_steps_sampled": 1928000, "sample_time_ms": 10519.426, "load_time_ms": 18.922, "grad_time_ms": 32613.019, "update_time_ms": 46.513, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.014729807153344154, "policy_loss": -0.014736627228558064, "vf_loss": 6.823763847351074, "vf_explained_var": 0.18750323355197906, "kl": 0.0022181360982358456, "entropy": 0.06520499289035797, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1928000, "episodes_total": 57403, "training_iteration": 482, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-00-28", "timestamp": 1581516028, "time_this_iter_s": 41.5028760433197, "time_total_s": 15389.589493274689, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7afd08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15389.589493274689, "timesteps_since_restore": 1928000, "iterations_since_restore": 482, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.567796610169477, "episode_len_mean": 33.53389830508475, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.617816091954021}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.707079778629491, "mean_processing_ms": 6.935376107466439, "mean_inference_ms": 1.0370597353763682}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5095552, "num_steps_sampled": 1932000, "sample_time_ms": 10602.466, "load_time_ms": 18.734, "grad_time_ms": 32708.605, "update_time_ms": 46.908, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03961648419499397, "policy_loss": -0.03962332010269165, "vf_loss": 6.834825038909912, "vf_explained_var": 0.17606660723686218, "kl": 0.0036365853156894445, "entropy": 0.10494153946638107, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1932000, "episodes_total": 57521, "training_iteration": 483, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-01-10", "timestamp": 1581516070, "time_this_iter_s": 41.30578303337097, "time_total_s": 15430.89527630806, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15430.89527630806, "timesteps_since_restore": 1932000, "iterations_since_restore": 483, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.136434108527123, "episode_len_mean": 31.11627906976744, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.31020408163265}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.699049792442183, "mean_processing_ms": 6.944028223309876, "mean_inference_ms": 1.037426839713353}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5106304, "num_steps_sampled": 1936000, "sample_time_ms": 10619.083, "load_time_ms": 19.538, "grad_time_ms": 32645.15, "update_time_ms": 46.477, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0130020035430789, "policy_loss": 0.012995719909667969, "vf_loss": 6.284050464630127, "vf_explained_var": 0.22369441390037537, "kl": 0.0038871329743415117, "entropy": 0.09472549706697464, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1936000, "episodes_total": 57650, "training_iteration": 484, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-01-55", "timestamp": 1581516115, "time_this_iter_s": 43.99856615066528, "time_total_s": 15474.893842458725, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15474.893842458725, "timesteps_since_restore": 1936000, "iterations_since_restore": 484, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.949090909090902, "episode_len_mean": 35.96363636363636, "episodes_this_iter": 110, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.278313253012044}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.705306859879598, "mean_processing_ms": 6.954703966978061, "mean_inference_ms": 1.0384777264478149}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5117056, "num_steps_sampled": 1940000, "sample_time_ms": 10547.324, "load_time_ms": 18.922, "grad_time_ms": 32290.582, "update_time_ms": 45.973, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0010858324822038412, "policy_loss": 0.0010788477957248688, "vf_loss": 6.986155986785889, "vf_explained_var": 0.15927691757678986, "kl": 0.004936892539262772, "entropy": 0.09046250581741333, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1940000, "episodes_total": 57760, "training_iteration": 485, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-02-39", "timestamp": 1581516159, "time_this_iter_s": 43.345871925354004, "time_total_s": 15518.239714384079, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15518.239714384079, "timesteps_since_restore": 1940000, "iterations_since_restore": 485, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.841481481481477, "episode_len_mean": 30.14074074074074, "episodes_this_iter": 135, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.319900497512434}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.714675530918361, "mean_processing_ms": 6.951734299882446, "mean_inference_ms": 1.0397718921550945}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5127936, "num_steps_sampled": 1944000, "sample_time_ms": 10627.145, "load_time_ms": 18.907, "grad_time_ms": 32622.896, "update_time_ms": 46.143, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.05331118404865265, "policy_loss": -0.05331745743751526, "vf_loss": 6.271999359130859, "vf_explained_var": 0.23135943710803986, "kl": 0.004373532719910145, "entropy": 0.12791506946086884, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1944000, "episodes_total": 57895, "training_iteration": 486, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-03-26", "timestamp": 1581516206, "time_this_iter_s": 45.67126202583313, "time_total_s": 15563.910976409912, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff342b802f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15563.910976409912, "timesteps_since_restore": 1944000, "iterations_since_restore": 486, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.747619047619033, "episode_len_mean": 31.634920634920636, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.362702702702699}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.722717169611785, "mean_processing_ms": 6.958729109286853, "mean_inference_ms": 1.0404242228058849}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5138176, "num_steps_sampled": 1948000, "sample_time_ms": 10640.121, "load_time_ms": 20.108, "grad_time_ms": 32595.987, "update_time_ms": 46.18, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0002753406879492104, "policy_loss": -0.0002816110791172832, "vf_loss": 6.271880626678467, "vf_explained_var": 0.21257321536540985, "kl": 0.0019417995354160666, "entropy": 0.089250348508358, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1948000, "episodes_total": 58021, "training_iteration": 487, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-04-09", "timestamp": 1581516249, "time_this_iter_s": 42.66745209693909, "time_total_s": 15606.578428506851, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15606.578428506851, "timesteps_since_restore": 1948000, "iterations_since_restore": 487, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.932307692307681, "episode_len_mean": 31.307692307692307, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.217128463476068}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.718445444014608, "mean_processing_ms": 6.963340065942804, "mean_inference_ms": 1.0410299982809665}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5148672, "num_steps_sampled": 1952000, "sample_time_ms": 10660.511, "load_time_ms": 19.677, "grad_time_ms": 32637.695, "update_time_ms": 46.027, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02960016392171383, "policy_loss": -0.029606327414512634, "vf_loss": 6.16013240814209, "vf_explained_var": 0.2296985536813736, "kl": 0.0016542022349312901, "entropy": 0.08724990487098694, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1952000, "episodes_total": 58151, "training_iteration": 488, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-04-54", "timestamp": 1581516294, "time_this_iter_s": 43.80641293525696, "time_total_s": 15650.384841442108, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281ae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15650.384841442108, "timesteps_since_restore": 1952000, "iterations_since_restore": 488, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.67142857142856, "episode_len_mean": 31.261904761904763, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.264661654135335}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.711802373872624, "mean_processing_ms": 6.957259463846313, "mean_inference_ms": 1.0424766434684014}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5159680, "num_steps_sampled": 1956000, "sample_time_ms": 10626.809, "load_time_ms": 19.552, "grad_time_ms": 32685.348, "update_time_ms": 45.053, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.008887926116585732, "policy_loss": -0.008894032798707485, "vf_loss": 6.106074810028076, "vf_explained_var": 0.2177741974592209, "kl": 0.004530709236860275, "entropy": 0.12293211370706558, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1956000, "episodes_total": 58277, "training_iteration": 489, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-05-39", "timestamp": 1581516339, "time_this_iter_s": 44.243112087249756, "time_total_s": 15694.627953529358, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15694.627953529358, "timesteps_since_restore": 1956000, "iterations_since_restore": 489, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.74188034188034, "episode_len_mean": 34.35042735042735, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.108077994428965}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.727799202198217, "mean_processing_ms": 6.975304890090302, "mean_inference_ms": 1.042799238946506}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5170816, "num_steps_sampled": 1960000, "sample_time_ms": 10431.302, "load_time_ms": 20.425, "grad_time_ms": 32840.248, "update_time_ms": 44.724, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.025135178118944168, "policy_loss": -0.0251418836414814, "vf_loss": 6.7092671394348145, "vf_explained_var": 0.14895612001419067, "kl": 0.002098596189171076, "entropy": 0.07113667577505112, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1960000, "episodes_total": 58394, "training_iteration": 490, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-06-23", "timestamp": 1581516383, "time_this_iter_s": 43.29774188995361, "time_total_s": 15737.925695419312, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa8c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15737.925695419312, "timesteps_since_restore": 1960000, "iterations_since_restore": 490, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.879687499999992, "episode_len_mean": 31.015625, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.32094240837696}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.736389469085348, "mean_processing_ms": 7.0007641558428215, "mean_inference_ms": 1.0439568939469164}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5181312, "num_steps_sampled": 1964000, "sample_time_ms": 10534.272, "load_time_ms": 19.635, "grad_time_ms": 32711.18, "update_time_ms": 44.436, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.05079694464802742, "policy_loss": 0.05079058185219765, "vf_loss": 6.3527045249938965, "vf_explained_var": 0.2222302407026291, "kl": 0.0019073733128607273, "entropy": 0.06743133068084717, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1964000, "episodes_total": 58522, "training_iteration": 491, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-07-07", "timestamp": 1581516427, "time_this_iter_s": 43.47530436515808, "time_total_s": 15781.40099978447, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15781.40099978447, "timesteps_since_restore": 1964000, "iterations_since_restore": 491, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.087499999999988, "episode_len_mean": 31.6640625, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.433245382585749}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.733657347363954, "mean_processing_ms": 6.983524577435535, "mean_inference_ms": 1.0450847811500084}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5191808, "num_steps_sampled": 1968000, "sample_time_ms": 10541.563, "load_time_ms": 19.476, "grad_time_ms": 32738.89, "update_time_ms": 44.878, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0015347483567893505, "policy_loss": -0.0015410548076033592, "vf_loss": 6.298316955566406, "vf_explained_var": 0.19261860847473145, "kl": 0.0013791685923933983, "entropy": 0.0751885324716568, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1968000, "episodes_total": 58650, "training_iteration": 492, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-07-50", "timestamp": 1581516470, "time_this_iter_s": 41.85625386238098, "time_total_s": 15823.25725364685, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5bf28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15823.25725364685, "timesteps_since_restore": 1968000, "iterations_since_restore": 492, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.482882882882862, "episode_len_mean": 35.0990990990991, "episodes_this_iter": 111, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.97107692307692}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.733009547431152, "mean_processing_ms": 6.987812516377128, "mean_inference_ms": 1.0456368729080374}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5202176, "num_steps_sampled": 1972000, "sample_time_ms": 10510.857, "load_time_ms": 20.493, "grad_time_ms": 32826.237, "update_time_ms": 45.15, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.035490840673446655, "policy_loss": 0.03548413887619972, "vf_loss": 6.697630405426025, "vf_explained_var": 0.18827246129512787, "kl": 0.0029589964542537928, "entropy": 0.05970234423875809, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1972000, "episodes_total": 58761, "training_iteration": 493, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-08-33", "timestamp": 1581516513, "time_this_iter_s": 41.882837533950806, "time_total_s": 15865.140091180801, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336459b70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15865.140091180801, "timesteps_since_restore": 1972000, "iterations_since_restore": 493, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.68666666666666, "episode_len_mean": 33.825, "episodes_this_iter": 120, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.895555555555552}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.733023558777646, "mean_processing_ms": 6.994638864249047, "mean_inference_ms": 1.0466810297594011}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5212800, "num_steps_sampled": 1976000, "sample_time_ms": 10457.165, "load_time_ms": 19.844, "grad_time_ms": 32723.301, "update_time_ms": 44.655, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0031194097828119993, "policy_loss": 0.0031128511764109135, "vf_loss": 6.555667877197266, "vf_explained_var": 0.20695006847381592, "kl": 0.003624078817665577, "entropy": 0.09988528490066528, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1976000, "episodes_total": 58881, "training_iteration": 494, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-09-16", "timestamp": 1581516556, "time_this_iter_s": 42.42357540130615, "time_total_s": 15907.563666582108, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7afbf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15907.563666582108, "timesteps_since_restore": 1976000, "iterations_since_restore": 494, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.571199999999989, "episode_len_mean": 31.72, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.318032786885243}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.741755626192294, "mean_processing_ms": 7.011286882140384, "mean_inference_ms": 1.0473515500544441}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5222912, "num_steps_sampled": 1980000, "sample_time_ms": 10458.582, "load_time_ms": 19.258, "grad_time_ms": 32479.504, "update_time_ms": 44.785, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.012143784202635288, "policy_loss": -0.01215055026113987, "vf_loss": 6.76417350769043, "vf_explained_var": 0.19191280007362366, "kl": 0.007529481314122677, "entropy": 0.08888725936412811, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1980000, "episodes_total": 59006, "training_iteration": 495, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-09-58", "timestamp": 1581516598, "time_this_iter_s": 40.91238069534302, "time_total_s": 15948.47604727745, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281d08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15948.47604727745, "timesteps_since_restore": 1980000, "iterations_since_restore": 495, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.170940170940167, "episode_len_mean": 33.24786324786325, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.67514124293785}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.736283716296012, "mean_processing_ms": 7.014261416114397, "mean_inference_ms": 1.0483376062202998}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5233536, "num_steps_sampled": 1984000, "sample_time_ms": 10369.682, "load_time_ms": 20.389, "grad_time_ms": 32289.521, "update_time_ms": 44.556, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03038056567311287, "policy_loss": -0.030387185513973236, "vf_loss": 6.619478702545166, "vf_explained_var": 0.17734193801879883, "kl": 0.002517570508643985, "entropy": 0.09557672590017319, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1984000, "episodes_total": 59123, "training_iteration": 496, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-10-41", "timestamp": 1581516641, "time_this_iter_s": 42.889761209487915, "time_total_s": 15991.365808486938, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7afd90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15991.365808486938, "timesteps_since_restore": 1984000, "iterations_since_restore": 496, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.805607476635494, "episode_len_mean": 38.09345794392523, "episodes_this_iter": 107, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.441337386018232}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.741287574174953, "mean_processing_ms": 6.995447355419609, "mean_inference_ms": 1.0500032447426224}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5244160, "num_steps_sampled": 1988000, "sample_time_ms": 10239.772, "load_time_ms": 19.469, "grad_time_ms": 32374.675, "update_time_ms": 44.819, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.010830563493072987, "policy_loss": -0.010838242247700691, "vf_loss": 7.6846394538879395, "vf_explained_var": 0.15219002962112427, "kl": 0.0032638770062476397, "entropy": 0.10617784410715103, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1988000, "episodes_total": 59230, "training_iteration": 497, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-11-24", "timestamp": 1581516684, "time_this_iter_s": 42.21299481391907, "time_total_s": 16033.578803300858, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aad08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16033.578803300858, "timesteps_since_restore": 1988000, "iterations_since_restore": 497, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.758558558558548, "episode_len_mean": 36.288288288288285, "episodes_this_iter": 111, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.431671554252195}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.740222799808759, "mean_processing_ms": 7.0367922862245145, "mean_inference_ms": 1.0497088491454172}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5255296, "num_steps_sampled": 1992000, "sample_time_ms": 10211.557, "load_time_ms": 19.138, "grad_time_ms": 32551.645, "update_time_ms": 44.949, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.004815216176211834, "policy_loss": 0.004807638935744762, "vf_loss": 7.582978248596191, "vf_explained_var": 0.1630902737379074, "kl": 0.0030283406376838684, "entropy": 0.1104307696223259, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1992000, "episodes_total": 59341, "training_iteration": 498, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-12-10", "timestamp": 1581516730, "time_this_iter_s": 45.29052686691284, "time_total_s": 16078.86933016777, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33ac887b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16078.86933016777, "timesteps_since_restore": 1992000, "iterations_since_restore": 498, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.351851851851833, "episode_len_mean": 36.907407407407405, "episodes_this_iter": 108, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.1651917404129755}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.7479488504676, "mean_processing_ms": 7.019337611299814, "mean_inference_ms": 1.05117220490249}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5265920, "num_steps_sampled": 1996000, "sample_time_ms": 10183.801, "load_time_ms": 19.902, "grad_time_ms": 32453.571, "update_time_ms": 45.24, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.002730641746893525, "policy_loss": -0.0027380737010389566, "vf_loss": 7.429653167724609, "vf_explained_var": 0.1395408660173416, "kl": 0.0028906483203172684, "entropy": 0.08842135965824127, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 1996000, "episodes_total": 59449, "training_iteration": 499, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-12-54", "timestamp": 1581516774, "time_this_iter_s": 42.99268674850464, "time_total_s": 16121.862016916275, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b7b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16121.862016916275, "timesteps_since_restore": 1996000, "iterations_since_restore": 499, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.174137931034473, "episode_len_mean": 34.741379310344826, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.921910112359548}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.763924925697914, "mean_processing_ms": 7.019877633340888, "mean_inference_ms": 1.0520404448578524}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5276672, "num_steps_sampled": 2000000, "sample_time_ms": 10269.444, "load_time_ms": 19.026, "grad_time_ms": 32371.571, "update_time_ms": 45.175, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.012375845573842525, "policy_loss": 0.012369366362690926, "vf_loss": 6.474994659423828, "vf_explained_var": 0.20356395840644836, "kl": 0.004143095575273037, "entropy": 0.10760223120450974, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2000000, "episodes_total": 59565, "training_iteration": 500, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-13-38", "timestamp": 1581516818, "time_this_iter_s": 43.327019929885864, "time_total_s": 16165.18903684616, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16165.18903684616, "timesteps_since_restore": 2000000, "iterations_since_restore": 500, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.679674796747964, "episode_len_mean": 33.235772357723576, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.845698924731179}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.753644022727971, "mean_processing_ms": 7.031152600570577, "mean_inference_ms": 1.0534290095638723}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5287552, "num_steps_sampled": 2004000, "sample_time_ms": 10213.011, "load_time_ms": 18.64, "grad_time_ms": 32479.21, "update_time_ms": 45.345, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.025020364671945572, "policy_loss": -0.025026632472872734, "vf_loss": 6.273478984832764, "vf_explained_var": 0.19932907819747925, "kl": 0.002768485574051738, "entropy": 0.09802986681461334, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2004000, "episodes_total": 59688, "training_iteration": 501, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-14-23", "timestamp": 1581516863, "time_this_iter_s": 43.98467445373535, "time_total_s": 16209.173711299896, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16209.173711299896, "timesteps_since_restore": 2004000, "iterations_since_restore": 501, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.96799999999999, "episode_len_mean": 31.592, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.424552429667516}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.760248140929111, "mean_processing_ms": 7.037327112244667, "mean_inference_ms": 1.053934287211461}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5298560, "num_steps_sampled": 2008000, "sample_time_ms": 10298.745, "load_time_ms": 19.9, "grad_time_ms": 32632.871, "update_time_ms": 44.935, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02097201533615589, "policy_loss": 0.020965032279491425, "vf_loss": 6.990287780761719, "vf_explained_var": 0.22410689294338226, "kl": 0.002999076386913657, "entropy": 0.09455765038728714, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2008000, "episodes_total": 59813, "training_iteration": 502, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-15-08", "timestamp": 1581516908, "time_this_iter_s": 44.258618116378784, "time_total_s": 16253.432329416275, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16253.432329416275, "timesteps_since_restore": 2008000, "iterations_since_restore": 502, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.16106194690264, "episode_len_mean": 35.07964601769911, "episodes_this_iter": 113, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.983090379008743}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.761119058402745, "mean_processing_ms": 7.034603104054906, "mean_inference_ms": 1.0551493917105286}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5309056, "num_steps_sampled": 2012000, "sample_time_ms": 10270.505, "load_time_ms": 19.332, "grad_time_ms": 32628.137, "update_time_ms": 44.567, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0186439398676157, "policy_loss": -0.018650351092219353, "vf_loss": 6.412159442901611, "vf_explained_var": 0.19511501491069794, "kl": 0.003208751790225506, "entropy": 0.0765024870634079, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2012000, "episodes_total": 59926, "training_iteration": 503, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-15-51", "timestamp": 1581516951, "time_this_iter_s": 41.543660402297974, "time_total_s": 16294.975989818573, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af6a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16294.975989818573, "timesteps_since_restore": 2012000, "iterations_since_restore": 503, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.42935779816512, "episode_len_mean": 36.4954128440367, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.124390243902435}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.756746310669142, "mean_processing_ms": 7.045456237072606, "mean_inference_ms": 1.055408555975315}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5319424, "num_steps_sampled": 2016000, "sample_time_ms": 10257.972, "load_time_ms": 18.907, "grad_time_ms": 32599.793, "update_time_ms": 45.567, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.023717589676380157, "policy_loss": 0.02371087484061718, "vf_loss": 6.716536045074463, "vf_explained_var": 0.1799948364496231, "kl": 0.0018556105205789208, "entropy": 0.09066318720579147, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2016000, "episodes_total": 60035, "training_iteration": 504, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-16-34", "timestamp": 1581516994, "time_this_iter_s": 42.017537117004395, "time_total_s": 16336.993526935577, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16336.993526935577, "timesteps_since_restore": 2016000, "iterations_since_restore": 504, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.293793103448262, "episode_len_mean": 27.71034482758621, "episodes_this_iter": 145, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.535529411764704}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.758777312990045, "mean_processing_ms": 7.05383271989868, "mean_inference_ms": 1.0565736852484091}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5329408, "num_steps_sampled": 2020000, "sample_time_ms": 10269.875, "load_time_ms": 19.909, "grad_time_ms": 32694.818, "update_time_ms": 44.535, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0013779974542558193, "policy_loss": 0.0013722849544137716, "vf_loss": 5.713037490844727, "vf_explained_var": 0.2566317915916443, "kl": 0.0018339810194447637, "entropy": 0.07084520906209946, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2020000, "episodes_total": 60180, "training_iteration": 505, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-17-16", "timestamp": 1581517036, "time_this_iter_s": 41.97962975502014, "time_total_s": 16378.973156690598, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b9d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16378.973156690598, "timesteps_since_restore": 2020000, "iterations_since_restore": 505, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.54999999999999, "episode_len_mean": 33.86206896551724, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.767138810198297}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.77525116617505, "mean_processing_ms": 7.058777864969308, "mean_inference_ms": 1.0575464879159673}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5340032, "num_steps_sampled": 2024000, "sample_time_ms": 10251.321, "load_time_ms": 18.867, "grad_time_ms": 32720.331, "update_time_ms": 44.108, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.038000643253326416, "policy_loss": -0.03800695016980171, "vf_loss": 6.313992023468018, "vf_explained_var": 0.20088434219360352, "kl": 0.001901294686831534, "entropy": 0.09158306568861008, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2024000, "episodes_total": 60296, "training_iteration": 506, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-18-00", "timestamp": 1581517080, "time_this_iter_s": 42.94378638267517, "time_total_s": 16421.916943073273, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3362819d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16421.916943073273, "timesteps_since_restore": 2024000, "iterations_since_restore": 506, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.451612903225797, "episode_len_mean": 32.78225806451613, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.650130548302869}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.775270081673593, "mean_processing_ms": 7.068447709639675, "mean_inference_ms": 1.058014153648018}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5350912, "num_steps_sampled": 2028000, "sample_time_ms": 10285.975, "load_time_ms": 18.818, "grad_time_ms": 32881.344, "update_time_ms": 43.63, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01041336078196764, "policy_loss": -0.01042009238153696, "vf_loss": 6.725146293640137, "vf_explained_var": 0.19463345408439636, "kl": 0.00269899470731616, "entropy": 0.08257834613323212, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2028000, "episodes_total": 60420, "training_iteration": 507, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-18-45", "timestamp": 1581517125, "time_this_iter_s": 44.16815781593323, "time_total_s": 16466.085100889206, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57d598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16466.085100889206, "timesteps_since_restore": 2028000, "iterations_since_restore": 507, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.988617886178854, "episode_len_mean": 32.27642276422764, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.632345013477086}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.7727842096651525, "mean_processing_ms": 7.081750593491542, "mean_inference_ms": 1.0583032510390542}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5361920, "num_steps_sampled": 2032000, "sample_time_ms": 10300.066, "load_time_ms": 19.875, "grad_time_ms": 32838.682, "update_time_ms": 44.496, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004588135983794928, "policy_loss": -0.004594889469444752, "vf_loss": 6.7603654861450195, "vf_explained_var": 0.19163839519023895, "kl": 0.0038292696699500084, "entropy": 0.12509112060070038, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2032000, "episodes_total": 60543, "training_iteration": 508, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-19-31", "timestamp": 1581517171, "time_this_iter_s": 45.02392625808716, "time_total_s": 16511.109027147293, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7aff28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16511.109027147293, "timesteps_since_restore": 2032000, "iterations_since_restore": 508, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.71379310344827, "episode_len_mean": 34.43103448275862, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.029999999999996}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.782016039227509, "mean_processing_ms": 7.080731014872653, "mean_inference_ms": 1.0591081241283775}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5372928, "num_steps_sampled": 2036000, "sample_time_ms": 10344.044, "load_time_ms": 19.086, "grad_time_ms": 32960.316, "update_time_ms": 44.487, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.029410703107714653, "policy_loss": -0.029417403042316437, "vf_loss": 6.702193737030029, "vf_explained_var": 0.22522054612636566, "kl": 0.003717158455401659, "entropy": 0.12697654962539673, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2036000, "episodes_total": 60659, "training_iteration": 509, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-20-16", "timestamp": 1581517216, "time_this_iter_s": 44.6436882019043, "time_total_s": 16555.752715349197, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16555.752715349197, "timesteps_since_restore": 2036000, "iterations_since_restore": 509, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.09999999999999, "episode_len_mean": 36.294642857142854, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.992156862745095}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.7831619798433636, "mean_processing_ms": 7.075104285157393, "mean_inference_ms": 1.060129087315932}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5383680, "num_steps_sampled": 2040000, "sample_time_ms": 10274.831, "load_time_ms": 19.15, "grad_time_ms": 33018.557, "update_time_ms": 44.982, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04410948231816292, "policy_loss": 0.044102683663368225, "vf_loss": 6.80538272857666, "vf_explained_var": 0.20414336025714874, "kl": 0.00362365017645061, "entropy": 0.10542868077754974, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2040000, "episodes_total": 60771, "training_iteration": 510, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-21-00", "timestamp": 1581517260, "time_this_iter_s": 43.22060704231262, "time_total_s": 16598.97332239151, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16598.97332239151, "timesteps_since_restore": 2040000, "iterations_since_restore": 510, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -21.313999999999993, "episode_len_mean": 39.72, "episodes_this_iter": 99, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -7.03432343234323}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.7828517151176495, "mean_processing_ms": 7.0856703012855435, "mean_inference_ms": 1.0603598733459725}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5394688, "num_steps_sampled": 2044000, "sample_time_ms": 10192.015, "load_time_ms": 20.137, "grad_time_ms": 33052.573, "update_time_ms": 45.292, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03435340151190758, "policy_loss": 0.03434644266963005, "vf_loss": 6.961951732635498, "vf_explained_var": 0.18075373768806458, "kl": 0.002934269839897752, "entropy": 0.11742571741342545, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2044000, "episodes_total": 60870, "training_iteration": 511, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-21-45", "timestamp": 1581517305, "time_this_iter_s": 43.50843071937561, "time_total_s": 16642.481753110886, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7afb70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16642.481753110886, "timesteps_since_restore": 2044000, "iterations_since_restore": 511, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.057364341085265, "episode_len_mean": 32.23255813953488, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.542569269521407}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.78373170528726, "mean_processing_ms": 7.072993425075564, "mean_inference_ms": 1.0626873630740579}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5405440, "num_steps_sampled": 2048000, "sample_time_ms": 10222.42, "load_time_ms": 18.942, "grad_time_ms": 33050.476, "update_time_ms": 45.046, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.003206513822078705, "policy_loss": 0.003199755446985364, "vf_loss": 6.758579254150391, "vf_explained_var": 0.21132205426692963, "kl": 0.0023040303494781256, "entropy": 0.07905254513025284, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2048000, "episodes_total": 60999, "training_iteration": 512, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-22-30", "timestamp": 1581517350, "time_this_iter_s": 44.52957534790039, "time_total_s": 16687.011328458786, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16687.011328458786, "timesteps_since_restore": 2048000, "iterations_since_restore": 512, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.709677419354833, "episode_len_mean": 31.717741935483872, "episodes_this_iter": 124, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.409921671018274}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.793685364164157, "mean_processing_ms": 7.069157600021839, "mean_inference_ms": 1.0628834633954625}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5416320, "num_steps_sampled": 2052000, "sample_time_ms": 10366.675, "load_time_ms": 18.814, "grad_time_ms": 33203.366, "update_time_ms": 45.795, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011697793379426003, "policy_loss": -0.011704335920512676, "vf_loss": 6.542626857757568, "vf_explained_var": 0.18666325509548187, "kl": 0.002464442513883114, "entropy": 0.0769495740532875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2052000, "episodes_total": 61123, "training_iteration": 513, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-23-15", "timestamp": 1581517395, "time_this_iter_s": 44.52013969421387, "time_total_s": 16731.531468153, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281e18>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16731.531468153, "timesteps_since_restore": 2052000, "iterations_since_restore": 513, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.49548387096774, "episode_len_mean": 25.87741935483871, "episodes_this_iter": 155, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.597362637362635}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.795463879013692, "mean_processing_ms": 7.086281758135526, "mean_inference_ms": 1.063355376034399}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5427200, "num_steps_sampled": 2056000, "sample_time_ms": 10588.778, "load_time_ms": 19.905, "grad_time_ms": 33421.103, "update_time_ms": 45.116, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.027845539152622223, "policy_loss": 0.02783963270485401, "vf_loss": 5.908661842346191, "vf_explained_var": 0.2742615342140198, "kl": 0.0016656566876918077, "entropy": 0.08007779717445374, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2056000, "episodes_total": 61278, "training_iteration": 514, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-24-03", "timestamp": 1581517443, "time_this_iter_s": 46.42216658592224, "time_total_s": 16777.953634738922, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5bae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16777.953634738922, "timesteps_since_restore": 2056000, "iterations_since_restore": 514, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.098412698412686, "episode_len_mean": 30.738095238095237, "episodes_this_iter": 126, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.0595744680851045}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.787752799644379, "mean_processing_ms": 7.0917564697756825, "mean_inference_ms": 1.0645187552022908}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5437312, "num_steps_sampled": 2060000, "sample_time_ms": 10566.441, "load_time_ms": 19.172, "grad_time_ms": 33413.538, "update_time_ms": 46.033, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.023070091381669044, "policy_loss": -0.023076744750142097, "vf_loss": 6.658297538757324, "vf_explained_var": 0.23205479979515076, "kl": 0.001780198304913938, "entropy": 0.06685590744018555, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2060000, "episodes_total": 61404, "training_iteration": 515, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-24-45", "timestamp": 1581517485, "time_this_iter_s": 41.68508553504944, "time_total_s": 16819.63872027397, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6ff28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16819.63872027397, "timesteps_since_restore": 2060000, "iterations_since_restore": 515, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.370992366412203, "episode_len_mean": 31.267175572519083, "episodes_this_iter": 131, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.123664122137402}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.791774566494701, "mean_processing_ms": 7.104835799509355, "mean_inference_ms": 1.0655201288290215}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5447552, "num_steps_sampled": 2064000, "sample_time_ms": 10637.201, "load_time_ms": 19.047, "grad_time_ms": 33291.62, "update_time_ms": 46.757, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.030384356155991554, "policy_loss": 0.030378246679902077, "vf_loss": 6.107198715209961, "vf_explained_var": 0.24231919646263123, "kl": 0.008861036971211433, "entropy": 0.07504836469888687, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2064000, "episodes_total": 61535, "training_iteration": 516, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-25-29", "timestamp": 1581517529, "time_this_iter_s": 42.43953561782837, "time_total_s": 16862.0782558918, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b8c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16862.0782558918, "timesteps_since_restore": 2064000, "iterations_since_restore": 516, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.511764705882339, "episode_len_mean": 29.580882352941178, "episodes_this_iter": 136, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.755662650602408}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.80299777089687, "mean_processing_ms": 7.108765874089871, "mean_inference_ms": 1.066545292343565}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5457792, "num_steps_sampled": 2068000, "sample_time_ms": 10753.213, "load_time_ms": 19.809, "grad_time_ms": 32990.74, "update_time_ms": 46.711, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011533170938491821, "policy_loss": -0.011538947001099586, "vf_loss": 5.7823638916015625, "vf_explained_var": 0.26522454619407654, "kl": 0.003307382808998227, "entropy": 0.07628599554300308, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2068000, "episodes_total": 61671, "training_iteration": 517, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-26-12", "timestamp": 1581517572, "time_this_iter_s": 42.324514389038086, "time_total_s": 16904.402770280838, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b950>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16904.402770280838, "timesteps_since_restore": 2068000, "iterations_since_restore": 517, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.427338129496395, "episode_len_mean": 28.53956834532374, "episodes_this_iter": 139, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.7747619047619025}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.806672646100436, "mean_processing_ms": 7.122525816340276, "mean_inference_ms": 1.067192289242579}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5468160, "num_steps_sampled": 2072000, "sample_time_ms": 10769.232, "load_time_ms": 18.493, "grad_time_ms": 32704.241, "update_time_ms": 46.258, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.002601951826363802, "policy_loss": -0.002607780508697033, "vf_loss": 5.828649044036865, "vf_explained_var": 0.25328195095062256, "kl": 0.0026832749135792255, "entropy": 0.08133167028427124, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2072000, "episodes_total": 61810, "training_iteration": 518, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-26-55", "timestamp": 1581517615, "time_this_iter_s": 42.3020384311676, "time_total_s": 16946.704808712006, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16946.704808712006, "timesteps_since_restore": 2072000, "iterations_since_restore": 518, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.33823529411764, "episode_len_mean": 29.477941176470587, "episodes_this_iter": 136, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.9198113207547145}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.799889543231727, "mean_processing_ms": 7.122729512677162, "mean_inference_ms": 1.0679366151269925}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5479040, "num_steps_sampled": 2076000, "sample_time_ms": 10806.413, "load_time_ms": 18.291, "grad_time_ms": 32292.39, "update_time_ms": 46.063, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03260580077767372, "policy_loss": 0.03259897604584694, "vf_loss": 6.829573154449463, "vf_explained_var": 0.227230966091156, "kl": 0.015516035258769989, "entropy": 0.09390443563461304, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2076000, "episodes_total": 61946, "training_iteration": 519, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-27-37", "timestamp": 1581517657, "time_this_iter_s": 40.88795351982117, "time_total_s": 16987.592762231827, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b2042f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16987.592762231827, "timesteps_since_restore": 2076000, "iterations_since_restore": 519, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.234328358208952, "episode_len_mean": 29.604477611940297, "episodes_this_iter": 134, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.167220902612824}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.817984884395078, "mean_processing_ms": 7.138770025394316, "mean_inference_ms": 1.0686805218540023}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5490304, "num_steps_sampled": 2080000, "sample_time_ms": 10986.259, "load_time_ms": 18.705, "grad_time_ms": 31840.878, "update_time_ms": 45.218, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.018984366208314896, "policy_loss": -0.01899041421711445, "vf_loss": 6.043989658355713, "vf_explained_var": 0.21595507860183716, "kl": 0.0024934967514127493, "entropy": 0.0813915804028511, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2080000, "episodes_total": 62080, "training_iteration": 520, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-28-18", "timestamp": 1581517698, "time_this_iter_s": 40.50884485244751, "time_total_s": 17028.101607084274, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17028.101607084274, "timesteps_since_restore": 2080000, "iterations_since_restore": 520, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.49256198347107, "episode_len_mean": 33.17355371900826, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.82708333333333}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.809174089589343, "mean_processing_ms": 7.145520259637504, "mean_inference_ms": 1.0686390324308206}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5501696, "num_steps_sampled": 2084000, "sample_time_ms": 10896.865, "load_time_ms": 18.047, "grad_time_ms": 31434.148, "update_time_ms": 44.065, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.012534311972558498, "policy_loss": -0.012540341354906559, "vf_loss": 6.033104419708252, "vf_explained_var": 0.2030152529478073, "kl": 0.003908324055373669, "entropy": 0.08955700695514679, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2084000, "episodes_total": 62201, "training_iteration": 521, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-28-57", "timestamp": 1581517737, "time_this_iter_s": 38.52762246131897, "time_total_s": 17066.629229545593, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281c80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17066.629229545593, "timesteps_since_restore": 2084000, "iterations_since_restore": 521, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -20.346788990825683, "episode_len_mean": 36.77064220183486, "episodes_this_iter": 109, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.465889212827985}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.814973289791651, "mean_processing_ms": 7.139918282728803, "mean_inference_ms": 1.0695740837193186}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5512960, "num_steps_sampled": 2088000, "sample_time_ms": 10626.478, "load_time_ms": 18.187, "grad_time_ms": 31436.427, "update_time_ms": 44.105, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.027199506759643555, "policy_loss": 0.02719258703291416, "vf_loss": 6.921909809112549, "vf_explained_var": 0.1591428816318512, "kl": 0.003679353976622224, "entropy": 0.09431269764900208, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2088000, "episodes_total": 62310, "training_iteration": 522, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-29-40", "timestamp": 1581517780, "time_this_iter_s": 41.849120140075684, "time_total_s": 17108.47834968567, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17108.47834968567, "timesteps_since_restore": 2088000, "iterations_since_restore": 522, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.22857142857141, "episode_len_mean": 35.9375, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.917681159420286}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.815455891573409, "mean_processing_ms": 7.1452359280679625, "mean_inference_ms": 1.0707073238141895}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5523456, "num_steps_sampled": 2092000, "sample_time_ms": 10560.224, "load_time_ms": 19.053, "grad_time_ms": 30803.939, "update_time_ms": 43.261, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0016392822144553065, "policy_loss": -0.0016457270830869675, "vf_loss": 6.44912576675415, "vf_explained_var": 0.1706458479166031, "kl": 0.002422408666461706, "entropy": 0.0896131619811058, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2092000, "episodes_total": 62422, "training_iteration": 523, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-30-18", "timestamp": 1581517818, "time_this_iter_s": 37.533491373062134, "time_total_s": 17146.01184105873, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17146.01184105873, "timesteps_since_restore": 2092000, "iterations_since_restore": 523, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.33217391304347, "episode_len_mean": 34.643478260869564, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.823756906077345}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.811501248724874, "mean_processing_ms": 7.1424427055078406, "mean_inference_ms": 1.0711450188042508}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5534208, "num_steps_sampled": 2096000, "sample_time_ms": 10192.99, "load_time_ms": 18.102, "grad_time_ms": 30312.409, "update_time_ms": 42.905, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01860584318637848, "policy_loss": -0.018612269312143326, "vf_loss": 6.428493499755859, "vf_explained_var": 0.18878920376300812, "kl": 0.007728843949735165, "entropy": 0.07772664725780487, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2096000, "episodes_total": 62537, "training_iteration": 524, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-30-57", "timestamp": 1581517857, "time_this_iter_s": 37.82155990600586, "time_total_s": 17183.833400964737, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6fd90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17183.833400964737, "timesteps_since_restore": 2096000, "iterations_since_restore": 524, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.05254237288135, "episode_len_mean": 34.279661016949156, "episodes_this_iter": 118, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.726344086021502}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.816921115591497, "mean_processing_ms": 7.1556084058069445, "mean_inference_ms": 1.0711566460900492}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5544960, "num_steps_sampled": 2100000, "sample_time_ms": 10054.956, "load_time_ms": 17.969, "grad_time_ms": 29993.009, "update_time_ms": 41.82, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04229966923594475, "policy_loss": 0.04229268431663513, "vf_loss": 6.98833703994751, "vf_explained_var": 0.19617575407028198, "kl": 0.0018344501731917262, "entropy": 0.08484426140785217, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2100000, "episodes_total": 62655, "training_iteration": 525, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-31-35", "timestamp": 1581517895, "time_this_iter_s": 37.09613871574402, "time_total_s": 17220.92953968048, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5bc80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17220.92953968048, "timesteps_since_restore": 2100000, "iterations_since_restore": 525, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.11384615384615, "episode_len_mean": 30.584615384615386, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.276574307304783}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.831016741282733, "mean_processing_ms": 7.164653793272037, "mean_inference_ms": 1.0709436627498314}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5555712, "num_steps_sampled": 2104000, "sample_time_ms": 9890.888, "load_time_ms": 18.903, "grad_time_ms": 29664.143, "update_time_ms": 40.918, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03393038734793663, "policy_loss": 0.0339236818253994, "vf_loss": 6.705279350280762, "vf_explained_var": 0.22216832637786865, "kl": 0.0024307528510689735, "entropy": 0.07890725880861282, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2104000, "episodes_total": 62785, "training_iteration": 526, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-32-13", "timestamp": 1581517933, "time_this_iter_s": 37.50813937187195, "time_total_s": 17258.437679052353, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244fc80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17258.437679052353, "timesteps_since_restore": 2104000, "iterations_since_restore": 526, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.894827586206887, "episode_len_mean": 33.28448275862069, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.520563380281686}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.822617198274258, "mean_processing_ms": 7.151736054504107, "mean_inference_ms": 1.0717804949027192}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5566336, "num_steps_sampled": 2108000, "sample_time_ms": 9601.464, "load_time_ms": 18.096, "grad_time_ms": 29337.564, "update_time_ms": 40.434, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0255783349275589, "policy_loss": -0.02558528445661068, "vf_loss": 6.956530570983887, "vf_explained_var": 0.19686584174633026, "kl": 0.0036707879044115543, "entropy": 0.07372419536113739, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2108000, "episodes_total": 62901, "training_iteration": 527, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-32-50", "timestamp": 1581517970, "time_this_iter_s": 36.149254322052, "time_total_s": 17294.586933374405, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281b70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17294.586933374405, "timesteps_since_restore": 2108000, "iterations_since_restore": 527, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.48527131782945, "episode_len_mean": 32.27906976744186, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.509326424870463}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.831975663502387, "mean_processing_ms": 7.158113952223549, "mean_inference_ms": 1.0728624738940538}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5576704, "num_steps_sampled": 2112000, "sample_time_ms": 9440.852, "load_time_ms": 17.91, "grad_time_ms": 28942.066, "update_time_ms": 40.004, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0031030969694256783, "policy_loss": -0.0031102446373552084, "vf_loss": 7.144657135009766, "vf_explained_var": 0.17363746464252472, "kl": 0.00963477324694395, "entropy": 0.08722351491451263, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2112000, "episodes_total": 63030, "training_iteration": 528, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-33-27", "timestamp": 1581518007, "time_this_iter_s": 36.733206033706665, "time_total_s": 17331.32013940811, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f7b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17331.32013940811, "timesteps_since_restore": 2112000, "iterations_since_restore": 528, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.94482758620688, "episode_len_mean": 33.83620689655172, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.490502793296087}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.827460872524695, "mean_processing_ms": 7.149145799245483, "mean_inference_ms": 1.0730534193562862}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5586944, "num_steps_sampled": 2116000, "sample_time_ms": 9178.131, "load_time_ms": 18.37, "grad_time_ms": 28631.178, "update_time_ms": 39.336, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.033909909427165985, "policy_loss": 0.0339028462767601, "vf_loss": 7.065798759460449, "vf_explained_var": 0.20690543949604034, "kl": 0.003785450477153063, "entropy": 0.11797232925891876, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2116000, "episodes_total": 63146, "training_iteration": 529, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-34-04", "timestamp": 1581518044, "time_this_iter_s": 35.15447282791138, "time_total_s": 17366.474612236023, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33bac30d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17366.474612236023, "timesteps_since_restore": 2116000, "iterations_since_restore": 529, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.152066115702464, "episode_len_mean": 33.33057851239669, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.447244094488186}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.824878069127058, "mean_processing_ms": 7.150156959324585, "mean_inference_ms": 1.0740429942564296}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5597568, "num_steps_sampled": 2120000, "sample_time_ms": 8933.031, "load_time_ms": 17.654, "grad_time_ms": 28562.302, "update_time_ms": 39.573, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0259244404733181, "policy_loss": -0.025930579751729965, "vf_loss": 6.142312049865723, "vf_explained_var": 0.21836738288402557, "kl": 0.001650316291488707, "entropy": 0.09430527687072754, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2120000, "episodes_total": 63267, "training_iteration": 530, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-34-42", "timestamp": 1581518082, "time_this_iter_s": 37.35325765609741, "time_total_s": 17403.82786989212, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204b70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17403.82786989212, "timesteps_since_restore": 2120000, "iterations_since_restore": 530, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.35409836065573, "episode_len_mean": 33.42622950819672, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.737669376693764}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.8266418691817154, "mean_processing_ms": 7.162889362412857, "mean_inference_ms": 1.0738922473332624}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5608192, "num_steps_sampled": 2124000, "sample_time_ms": 8924.263, "load_time_ms": 17.348, "grad_time_ms": 28355.681, "update_time_ms": 39.616, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.006166811566799879, "policy_loss": -0.006173235829919577, "vf_loss": 6.423456192016602, "vf_explained_var": 0.19068555533885956, "kl": 0.0020613842643797398, "entropy": 0.12234578281641006, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2124000, "episodes_total": 63389, "training_iteration": 531, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-35-19", "timestamp": 1581518119, "time_this_iter_s": 36.37396049499512, "time_total_s": 17440.201830387115, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17440.201830387115, "timesteps_since_restore": 2124000, "iterations_since_restore": 531, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.149999999999988, "episode_len_mean": 33.439655172413794, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.768219178082188}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.8293450807487455, "mean_processing_ms": 7.160636360530605, "mean_inference_ms": 1.0744259915076813}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5619200, "num_steps_sampled": 2128000, "sample_time_ms": 8972.177, "load_time_ms": 18.055, "grad_time_ms": 27882.595, "update_time_ms": 39.372, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02782992459833622, "policy_loss": 0.027823498472571373, "vf_loss": 6.428377151489258, "vf_explained_var": 0.2121681571006775, "kl": 0.003500161226838827, "entropy": 0.131238654255867, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2128000, "episodes_total": 63505, "training_iteration": 532, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-35-57", "timestamp": 1581518157, "time_this_iter_s": 37.59797430038452, "time_total_s": 17477.7998046875, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17477.7998046875, "timesteps_since_restore": 2128000, "iterations_since_restore": 532, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.230088495575213, "episode_len_mean": 35.48672566371681, "episodes_this_iter": 113, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.086834733893554}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.821143671591264, "mean_processing_ms": 7.139217473475021, "mean_inference_ms": 1.0750012528267152}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5630208, "num_steps_sampled": 2132000, "sample_time_ms": 8866.694, "load_time_ms": 17.043, "grad_time_ms": 28042.483, "update_time_ms": 38.769, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04731328412890434, "policy_loss": -0.0473194494843483, "vf_loss": 6.166889190673828, "vf_explained_var": 0.17270570993423462, "kl": 0.0033969723153859377, "entropy": 0.15562032163143158, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2132000, "episodes_total": 63618, "training_iteration": 533, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-36-36", "timestamp": 1581518196, "time_this_iter_s": 38.061641693115234, "time_total_s": 17515.861446380615, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17515.861446380615, "timesteps_since_restore": 2132000, "iterations_since_restore": 533, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.20327868852458, "episode_len_mean": 33.02459016393443, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.61176470588235}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.820558579701882, "mean_processing_ms": 7.156917317541829, "mean_inference_ms": 1.0749812236911986}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5640960, "num_steps_sampled": 2136000, "sample_time_ms": 8832.924, "load_time_ms": 16.803, "grad_time_ms": 27954.537, "update_time_ms": 38.814, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.002151220105588436, "policy_loss": 0.0021447078324854374, "vf_loss": 6.511287689208984, "vf_explained_var": 0.2181599736213684, "kl": 0.00472906744107604, "entropy": 0.1413145214319229, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2136000, "episodes_total": 63740, "training_iteration": 534, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-37-13", "timestamp": 1581518233, "time_this_iter_s": 36.599398612976074, "time_total_s": 17552.46084499359, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff345264840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17552.46084499359, "timesteps_since_restore": 2136000, "iterations_since_restore": 534, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.3295081967213, "episode_len_mean": 31.62295081967213, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.174545454545452}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.827767636715925, "mean_processing_ms": 7.15618540063357, "mean_inference_ms": 1.0759910758834725}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5651712, "num_steps_sampled": 2140000, "sample_time_ms": 8812.254, "load_time_ms": 17.809, "grad_time_ms": 27993.808, "update_time_ms": 38.752, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.023247936740517616, "policy_loss": -0.023254701867699623, "vf_loss": 6.766319751739502, "vf_explained_var": 0.2370113581418991, "kl": 0.004387952852994204, "entropy": 0.10539226233959198, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2140000, "episodes_total": 63862, "training_iteration": 535, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-37-51", "timestamp": 1581518271, "time_this_iter_s": 37.291842460632324, "time_total_s": 17589.752687454224, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17589.752687454224, "timesteps_since_restore": 2140000, "iterations_since_restore": 535, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.808196721311464, "episode_len_mean": 34.00819672131148, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.702362204724407}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.828036985929365, "mean_processing_ms": 7.169921112228394, "mean_inference_ms": 1.0756874540283696}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5662336, "num_steps_sampled": 2144000, "sample_time_ms": 8786.644, "load_time_ms": 16.728, "grad_time_ms": 27963.386, "update_time_ms": 38.519, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.043199408799409866, "policy_loss": -0.043206196278333664, "vf_loss": 6.788604259490967, "vf_explained_var": 0.21243514120578766, "kl": 0.0025726226158440113, "entropy": 0.10945820808410645, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2144000, "episodes_total": 63984, "training_iteration": 536, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-38-28", "timestamp": 1581518308, "time_this_iter_s": 36.93217706680298, "time_total_s": 17626.684864521027, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f840>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17626.684864521027, "timesteps_since_restore": 2144000, "iterations_since_restore": 536, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -19.29622641509432, "episode_len_mean": 38.075471698113205, "episodes_this_iter": 106, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -5.980701754385961}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.831659226724624, "mean_processing_ms": 7.187128396892099, "mean_inference_ms": 1.0756253653116785}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5672704, "num_steps_sampled": 2148000, "sample_time_ms": 8902.289, "load_time_ms": 16.699, "grad_time_ms": 27893.482, "update_time_ms": 38.817, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.021329380571842194, "policy_loss": -0.02133595198392868, "vf_loss": 6.57294225692749, "vf_explained_var": 0.18350248038768768, "kl": 0.0036520794965326786, "entropy": 0.09335311502218246, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2148000, "episodes_total": 64090, "training_iteration": 537, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-39-06", "timestamp": 1581518346, "time_this_iter_s": 36.609503746032715, "time_total_s": 17663.29436826706, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357ed2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17663.29436826706, "timesteps_since_restore": 2148000, "iterations_since_restore": 537, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.577599999999988, "episode_len_mean": 31.416, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.084073107049606}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.829606549811775, "mean_processing_ms": 7.1761355447457165, "mean_inference_ms": 1.0768741899820398}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5682944, "num_steps_sampled": 2152000, "sample_time_ms": 8863.618, "load_time_ms": 17.643, "grad_time_ms": 27911.303, "update_time_ms": 38.665, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.015477797016501427, "policy_loss": 0.015471125952899456, "vf_loss": 6.669485569000244, "vf_explained_var": 0.23253361880779266, "kl": 0.002731623128056526, "entropy": 0.1031935065984726, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2152000, "episodes_total": 64215, "training_iteration": 538, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-39-44", "timestamp": 1581518384, "time_this_iter_s": 36.53224968910217, "time_total_s": 17699.82661795616, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204f28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17699.82661795616, "timesteps_since_restore": 2152000, "iterations_since_restore": 538, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.50866141732283, "episode_len_mean": 31.64566929133858, "episodes_this_iter": 127, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.4741514360313275}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.833286865395606, "mean_processing_ms": 7.168648334603734, "mean_inference_ms": 1.077338884611219}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5693568, "num_steps_sampled": 2156000, "sample_time_ms": 8898.435, "load_time_ms": 16.955, "grad_time_ms": 28009.153, "update_time_ms": 38.906, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02555600181221962, "policy_loss": 0.02554996870458126, "vf_loss": 6.0304083824157715, "vf_explained_var": 0.23614951968193054, "kl": 0.006316233891993761, "entropy": 0.09863932430744171, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2156000, "episodes_total": 64342, "training_iteration": 539, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-40-21", "timestamp": 1581518421, "time_this_iter_s": 36.47047138214111, "time_total_s": 17736.297089338303, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff336281a60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17736.297089338303, "timesteps_since_restore": 2156000, "iterations_since_restore": 539, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.04793388429751, "episode_len_mean": 32.735537190082646, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.344041450777199}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.841668883692263, "mean_processing_ms": 7.173667120665832, "mean_inference_ms": 1.077632545591378}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5704448, "num_steps_sampled": 2160000, "sample_time_ms": 8885.922, "load_time_ms": 16.912, "grad_time_ms": 28024.11, "update_time_ms": 38.547, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01009455043822527, "policy_loss": -0.010100506246089935, "vf_loss": 5.9532084465026855, "vf_explained_var": 0.23485973477363586, "kl": 0.0031587211415171623, "entropy": 0.12862621247768402, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2160000, "episodes_total": 64463, "training_iteration": 540, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-40-59", "timestamp": 1581518459, "time_this_iter_s": 37.374584913253784, "time_total_s": 17773.671674251556, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5bd08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17773.671674251556, "timesteps_since_restore": 2160000, "iterations_since_restore": 540, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.067768595041308, "episode_len_mean": 33.1900826446281, "episodes_this_iter": 121, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.611956521739128}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.840892526552017, "mean_processing_ms": 7.160393878284503, "mean_inference_ms": 1.0772899312845952}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5714944, "num_steps_sampled": 2164000, "sample_time_ms": 8966.899, "load_time_ms": 17.818, "grad_time_ms": 28016.915, "update_time_ms": 38.509, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0137824397534132, "policy_loss": 0.013775680214166641, "vf_loss": 6.763369560241699, "vf_explained_var": 0.19705551862716675, "kl": 0.0020659936126321554, "entropy": 0.10293135792016983, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2164000, "episodes_total": 64584, "training_iteration": 541, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-41-37", "timestamp": 1581518497, "time_this_iter_s": 37.11786460876465, "time_total_s": 17810.78953886032, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17810.78953886032, "timesteps_since_restore": 2164000, "iterations_since_restore": 541, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.90697674418604, "episode_len_mean": 30.713178294573645, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.275064267352183}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.843176617273806, "mean_processing_ms": 7.183295762673065, "mean_inference_ms": 1.0786550336473748}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5725568, "num_steps_sampled": 2168000, "sample_time_ms": 9041.988, "load_time_ms": 17.077, "grad_time_ms": 27909.099, "update_time_ms": 38.782, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.022701464593410492, "policy_loss": -0.02270745299756527, "vf_loss": 5.990001201629639, "vf_explained_var": 0.24042175710201263, "kl": 0.003027057508006692, "entropy": 0.09395243972539902, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2168000, "episodes_total": 64713, "training_iteration": 542, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-42-15", "timestamp": 1581518535, "time_this_iter_s": 37.26951885223389, "time_total_s": 17848.059057712555, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17848.059057712555, "timesteps_since_restore": 2168000, "iterations_since_restore": 542, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.53606557377048, "episode_len_mean": 34.02459016393443, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.644854881266488}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.841113006613632, "mean_processing_ms": 7.1694687481613615, "mean_inference_ms": 1.078648099775315}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5736192, "num_steps_sampled": 2172000, "sample_time_ms": 9034.967, "load_time_ms": 17.25, "grad_time_ms": 27811.664, "update_time_ms": 38.832, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01821025274693966, "policy_loss": -0.018216898664832115, "vf_loss": 6.647319793701172, "vf_explained_var": 0.18126004934310913, "kl": 0.004098591860383749, "entropy": 0.12421555072069168, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2172000, "episodes_total": 64835, "training_iteration": 543, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-42-53", "timestamp": 1581518573, "time_this_iter_s": 37.01799035072327, "time_total_s": 17885.07704806328, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f0d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17885.07704806328, "timesteps_since_restore": 2172000, "iterations_since_restore": 543, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.787499999999993, "episode_len_mean": 30.6015625, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.181538461538459}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.833145957400683, "mean_processing_ms": 7.171342092023709, "mean_inference_ms": 1.0794618195379055}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5746816, "num_steps_sampled": 2176000, "sample_time_ms": 9113.883, "load_time_ms": 17.908, "grad_time_ms": 27747.095, "update_time_ms": 38.662, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.017937999218702316, "policy_loss": 0.01793176867067814, "vf_loss": 6.231049537658691, "vf_explained_var": 0.23161180317401886, "kl": 0.004794057924300432, "entropy": 0.10720174014568329, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2176000, "episodes_total": 64963, "training_iteration": 544, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-43-30", "timestamp": 1581518610, "time_this_iter_s": 36.74521827697754, "time_total_s": 17921.822266340256, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5bd90>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17921.822266340256, "timesteps_since_restore": 2176000, "iterations_since_restore": 544, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.193043478260858, "episode_len_mean": 34.2695652173913, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.763636363636361}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.845003833117093, "mean_processing_ms": 7.193981463049632, "mean_inference_ms": 1.0792410905773602}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5757696, "num_steps_sampled": 2180000, "sample_time_ms": 9238.182, "load_time_ms": 16.957, "grad_time_ms": 27767.621, "update_time_ms": 39.102, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0025845670606940985, "policy_loss": 0.002577866893261671, "vf_loss": 6.69728946685791, "vf_explained_var": 0.18457092344760895, "kl": 0.007160964421927929, "entropy": 0.15288622677326202, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2180000, "episodes_total": 65078, "training_iteration": 545, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-44-10", "timestamp": 1581518650, "time_this_iter_s": 38.73217797279358, "time_total_s": 17960.55444431305, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17960.55444431305, "timesteps_since_restore": 2180000, "iterations_since_restore": 545, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.16716417910446, "episode_len_mean": 30.96268656716418, "episodes_this_iter": 134, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.043176178660047}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.847608840623122, "mean_processing_ms": 7.1793200307529315, "mean_inference_ms": 1.0805365441743962}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5767808, "num_steps_sampled": 2184000, "sample_time_ms": 9284.944, "load_time_ms": 16.858, "grad_time_ms": 27818.608, "update_time_ms": 39.839, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.022621601819992065, "policy_loss": -0.0226272139698267, "vf_loss": 5.613931655883789, "vf_explained_var": 0.2251296043395996, "kl": 0.0024563029874116182, "entropy": 0.09092944860458374, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2184000, "episodes_total": 65212, "training_iteration": 546, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-44-49", "timestamp": 1581518689, "time_this_iter_s": 37.91905903816223, "time_total_s": 17998.47350335121, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33a7af488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 17998.47350335121, "timesteps_since_restore": 2184000, "iterations_since_restore": 546, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.48799999999999, "episode_len_mean": 32.032, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.311855670103091}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.84676353470535, "mean_processing_ms": 7.194410667332927, "mean_inference_ms": 1.0810677202671257}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5778432, "num_steps_sampled": 2188000, "sample_time_ms": 9348.09, "load_time_ms": 17.592, "grad_time_ms": 27998.633, "update_time_ms": 39.474, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.008152796886861324, "policy_loss": 0.008146733976900578, "vf_loss": 6.066982269287109, "vf_explained_var": 0.22953015565872192, "kl": 0.0027240815106779337, "entropy": 0.13562916219234467, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2188000, "episodes_total": 65337, "training_iteration": 547, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-45-29", "timestamp": 1581518729, "time_this_iter_s": 39.04575324058533, "time_total_s": 18037.519256591797, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f2f0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18037.519256591797, "timesteps_since_restore": 2188000, "iterations_since_restore": 547, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.121951219512184, "episode_len_mean": 32.08130081300813, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.345013477088945}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.8515730294402974, "mean_processing_ms": 7.202535220442222, "mean_inference_ms": 1.081664263788256}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5788800, "num_steps_sampled": 2192000, "sample_time_ms": 9366.335, "load_time_ms": 16.97, "grad_time_ms": 28107.831, "update_time_ms": 40.032, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.05232705548405647, "policy_loss": -0.052332956343889236, "vf_loss": 5.890929222106934, "vf_explained_var": 0.2205090969800949, "kl": 0.002245658077299595, "entropy": 0.12578649818897247, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2192000, "episodes_total": 65460, "training_iteration": 548, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-46-07", "timestamp": 1581518767, "time_this_iter_s": 37.804930210113525, "time_total_s": 18075.32418680191, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18075.32418680191, "timesteps_since_restore": 2192000, "iterations_since_restore": 548, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.182608695652164, "episode_len_mean": 34.3304347826087, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.824512534818938}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.841550495787541, "mean_processing_ms": 7.187583013107068, "mean_inference_ms": 1.0815612977937556}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5799680, "num_steps_sampled": 2196000, "sample_time_ms": 9480.375, "load_time_ms": 16.979, "grad_time_ms": 28371.753, "update_time_ms": 39.91, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04033168777823448, "policy_loss": -0.04033801704645157, "vf_loss": 6.333890438079834, "vf_explained_var": 0.22129644453525543, "kl": 0.0039351461455225945, "entropy": 0.11879013478755951, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2196000, "episodes_total": 65575, "training_iteration": 549, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-46-48", "timestamp": 1581518808, "time_this_iter_s": 40.25093674659729, "time_total_s": 18115.575123548508, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357ed598>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18115.575123548508, "timesteps_since_restore": 2196000, "iterations_since_restore": 549, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.586885245901627, "episode_len_mean": 32.47540983606557, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.353439153439151}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.84536278564235, "mean_processing_ms": 7.206763442651731, "mean_inference_ms": 1.0823015762967452}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5810048, "num_steps_sampled": 2200000, "sample_time_ms": 9486.092, "load_time_ms": 17.961, "grad_time_ms": 28405.991, "update_time_ms": 40.246, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.005609478335827589, "policy_loss": 0.005602829158306122, "vf_loss": 6.648075103759766, "vf_explained_var": 0.21587739884853363, "kl": 0.002244672505185008, "entropy": 0.10326579958200455, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2200000, "episodes_total": 65697, "training_iteration": 550, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-47-27", "timestamp": 1581518847, "time_this_iter_s": 37.78797507286072, "time_total_s": 18153.36309862137, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18153.36309862137, "timesteps_since_restore": 2200000, "iterations_since_restore": 550, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.05846153846153, "episode_len_mean": 30.892307692307693, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.1673267326732635}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.847332234217003, "mean_processing_ms": 7.211889280856152, "mean_inference_ms": 1.0824628049901506}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5820800, "num_steps_sampled": 2204000, "sample_time_ms": 9479.052, "load_time_ms": 17.322, "grad_time_ms": 28706.078, "update_time_ms": 40.39, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0022980591747909784, "policy_loss": 0.002291547367349267, "vf_loss": 6.513469219207764, "vf_explained_var": 0.2165464162826538, "kl": 0.004102139733731747, "entropy": 0.09581229835748672, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2204000, "episodes_total": 65827, "training_iteration": 551, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-48-08", "timestamp": 1581518888, "time_this_iter_s": 40.04410696029663, "time_total_s": 18193.407205581665, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3362818c8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18193.407205581665, "timesteps_since_restore": 2204000, "iterations_since_restore": 551, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.618439716312055, "episode_len_mean": 29.127659574468087, "episodes_this_iter": 141, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.062528735632181}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.861002013518029, "mean_processing_ms": 7.198436942173909, "mean_inference_ms": 1.0834693478381359}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5831808, "num_steps_sampled": 2208000, "sample_time_ms": 9517.76, "load_time_ms": 17.175, "grad_time_ms": 28827.739, "update_time_ms": 40.406, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013334066607058048, "policy_loss": 0.013328254222869873, "vf_loss": 5.805505275726318, "vf_explained_var": 0.23640140891075134, "kl": 0.00235261139459908, "entropy": 0.06270227581262589, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2208000, "episodes_total": 65968, "training_iteration": 552, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-48-47", "timestamp": 1581518927, "time_this_iter_s": 38.867274045944214, "time_total_s": 18232.27447962761, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5bb70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18232.27447962761, "timesteps_since_restore": 2208000, "iterations_since_restore": 552, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.95892857142856, "episode_len_mean": 35.901785714285715, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.015297450424925}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.864035919824859, "mean_processing_ms": 7.198640410820502, "mean_inference_ms": 1.0836827357363588}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5842560, "num_steps_sampled": 2212000, "sample_time_ms": 9470.03, "load_time_ms": 17.691, "grad_time_ms": 28733.734, "update_time_ms": 40.071, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0268583744764328, "policy_loss": -0.02686467580497265, "vf_loss": 6.310079097747803, "vf_explained_var": 0.17391200363636017, "kl": 0.002648131223395467, "entropy": 0.1145220696926117, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2212000, "episodes_total": 66080, "training_iteration": 553, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-49-24", "timestamp": 1581518964, "time_this_iter_s": 35.604700326919556, "time_total_s": 18267.87917995453, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3362817b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18267.87917995453, "timesteps_since_restore": 2212000, "iterations_since_restore": 553, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.68920863309352, "episode_len_mean": 28.805755395683452, "episodes_this_iter": 139, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.943825665859562}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.858882399511491, "mean_processing_ms": 7.200825338415737, "mean_inference_ms": 1.0844781297921915}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5853184, "num_steps_sampled": 2216000, "sample_time_ms": 9526.987, "load_time_ms": 16.992, "grad_time_ms": 28694.526, "update_time_ms": 40.435, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01651744358241558, "policy_loss": 0.016511105000972748, "vf_loss": 6.338204860687256, "vf_explained_var": 0.22692781686782837, "kl": 0.0025378349237143993, "entropy": 0.07797391712665558, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2216000, "episodes_total": 66219, "training_iteration": 554, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-50-01", "timestamp": 1581519001, "time_this_iter_s": 36.9192910194397, "time_total_s": 18304.79847097397, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b57da60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18304.79847097397, "timesteps_since_restore": 2216000, "iterations_since_restore": 554, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -42.00000000000006, "episode_reward_mean": -14.329411764705872, "episode_len_mean": 28.669117647058822, "episodes_this_iter": 136, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.753170731707315}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.859377955935603, "mean_processing_ms": 7.20580431889546, "mean_inference_ms": 1.0844725230526397}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5863424, "num_steps_sampled": 2220000, "sample_time_ms": 9447.869, "load_time_ms": 16.675, "grad_time_ms": 28415.959, "update_time_ms": 40.055, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.036731816828250885, "policy_loss": 0.036725688725709915, "vf_loss": 6.128532409667969, "vf_explained_var": 0.2689364552497864, "kl": 0.004407365806400776, "entropy": 0.1020675078034401, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2220000, "episodes_total": 66355, "training_iteration": 555, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-50-37", "timestamp": 1581519037, "time_this_iter_s": 35.15002226829529, "time_total_s": 18339.948493242264, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357ed488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18339.948493242264, "timesteps_since_restore": 2220000, "iterations_since_restore": 555, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.31666666666666, "episode_len_mean": 28.23611111111111, "episodes_this_iter": 144, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.739310344827584}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.847341671288281, "mean_processing_ms": 7.202299228752117, "mean_inference_ms": 1.085092208850271}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5873920, "num_steps_sampled": 2224000, "sample_time_ms": 9441.315, "load_time_ms": 17.46, "grad_time_ms": 28058.411, "update_time_ms": 39.434, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.019891047850251198, "policy_loss": 0.019884705543518066, "vf_loss": 6.33667516708374, "vf_explained_var": 0.2379692792892456, "kl": 0.004839014261960983, "entropy": 0.11466013640165329, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2224000, "episodes_total": 66499, "training_iteration": 556, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-51-12", "timestamp": 1581519072, "time_this_iter_s": 34.275866985321045, "time_total_s": 18374.224360227585, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357edae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18374.224360227585, "timesteps_since_restore": 2224000, "iterations_since_restore": 556, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.025925925925907, "episode_len_mean": 35.9537037037037, "episodes_this_iter": 108, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.881570996978849}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.84686022930933, "mean_processing_ms": 7.200720148863583, "mean_inference_ms": 1.0843111362912163}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5884160, "num_steps_sampled": 2228000, "sample_time_ms": 9143.886, "load_time_ms": 16.533, "grad_time_ms": 27624.002, "update_time_ms": 39.006, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04214145615696907, "policy_loss": -0.04214863106608391, "vf_loss": 7.177952766418457, "vf_explained_var": 0.1734517514705658, "kl": 0.0027455692179501057, "entropy": 0.08738734573125839, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2228000, "episodes_total": 66607, "training_iteration": 557, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-51-44", "timestamp": 1581519104, "time_this_iter_s": 31.71133589744568, "time_total_s": 18405.93569612503, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18405.93569612503, "timesteps_since_restore": 2228000, "iterations_since_restore": 557, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.8855072463768, "episode_len_mean": 29.731884057971016, "episodes_this_iter": 138, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.985922330097084}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.85389173769413, "mean_processing_ms": 7.205043428533109, "mean_inference_ms": 1.0841453323127934}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5894528, "num_steps_sampled": 2232000, "sample_time_ms": 9011.818, "load_time_ms": 16.291, "grad_time_ms": 27206.86, "update_time_ms": 38.048, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03147745877504349, "policy_loss": -0.03148350864648819, "vf_loss": 6.049139976501465, "vf_explained_var": 0.2308090180158615, "kl": 0.0034260102547705173, "entropy": 0.08286826312541962, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2232000, "episodes_total": 66745, "training_iteration": 558, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-52-17", "timestamp": 1581519137, "time_this_iter_s": 32.29992699623108, "time_total_s": 18438.23562312126, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6fae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18438.23562312126, "timesteps_since_restore": 2232000, "iterations_since_restore": 558, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.696969696969685, "episode_len_mean": 30.03030303030303, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.961636828644497}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.853948804169995, "mean_processing_ms": 7.199343614144842, "mean_inference_ms": 1.0845249103846166}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5904768, "num_steps_sampled": 2236000, "sample_time_ms": 8838.812, "load_time_ms": 16.968, "grad_time_ms": 26681.313, "update_time_ms": 37.449, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.053708266466856, "policy_loss": -0.05371452122926712, "vf_loss": 6.251432418823242, "vf_explained_var": 0.2601674199104309, "kl": 0.00604268116876483, "entropy": 0.10084263980388641, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2236000, "episodes_total": 66877, "training_iteration": 559, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-52-52", "timestamp": 1581519172, "time_this_iter_s": 33.269102811813354, "time_total_s": 18471.504725933075, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34201c048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18471.504725933075, "timesteps_since_restore": 2236000, "iterations_since_restore": 559, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.940624999999997, "episode_len_mean": 31.5078125, "episodes_this_iter": 128, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.574293059125961}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.850729657749696, "mean_processing_ms": 7.212622064398019, "mean_inference_ms": 1.0845159406932976}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5915776, "num_steps_sampled": 2240000, "sample_time_ms": 8858.305, "load_time_ms": 16.146, "grad_time_ms": 26615.385, "update_time_ms": 37.418, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.004532983992248774, "policy_loss": 0.004526675213128328, "vf_loss": 6.30518913269043, "vf_explained_var": 0.23712068796157837, "kl": 0.00581486476585269, "entropy": 0.10444223880767822, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2240000, "episodes_total": 67005, "training_iteration": 560, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-53-30", "timestamp": 1581519210, "time_this_iter_s": 37.31431770324707, "time_total_s": 18508.819043636322, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357ed048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18508.819043636322, "timesteps_since_restore": 2240000, "iterations_since_restore": 560, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.76229508196721, "episode_len_mean": 33.131147540983605, "episodes_this_iter": 122, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.794117647058821}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.865950326134268, "mean_processing_ms": 7.227964147541662, "mean_inference_ms": 1.0848693167674224}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5926784, "num_steps_sampled": 2244000, "sample_time_ms": 8837.65, "load_time_ms": 15.655, "grad_time_ms": 26189.272, "update_time_ms": 37.242, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02356904000043869, "policy_loss": 0.023562947288155556, "vf_loss": 6.085062503814697, "vf_explained_var": 0.20494747161865234, "kl": 0.0035469962749630213, "entropy": 0.11410052329301834, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2244000, "episodes_total": 67127, "training_iteration": 561, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-54-06", "timestamp": 1581519246, "time_this_iter_s": 35.56706190109253, "time_total_s": 18544.386105537415, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357edea0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18544.386105537415, "timesteps_since_restore": 2244000, "iterations_since_restore": 561, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.872868217054256, "episode_len_mean": 30.589147286821706, "episodes_this_iter": 129, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.1837974683544275}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.852114945969955, "mean_processing_ms": 7.216288741578077, "mean_inference_ms": 1.085679745872878}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5937408, "num_steps_sampled": 2248000, "sample_time_ms": 8683.418, "load_time_ms": 16.061, "grad_time_ms": 25913.332, "update_time_ms": 36.218, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.015894867479801178, "policy_loss": 0.015888556838035583, "vf_loss": 6.314523220062256, "vf_explained_var": 0.2057873159646988, "kl": 0.007887032814323902, "entropy": 0.1137455403804779, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2248000, "episodes_total": 67256, "training_iteration": 562, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-54-41", "timestamp": 1581519281, "time_this_iter_s": 34.55808186531067, "time_total_s": 18578.944187402725, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aaf28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18578.944187402725, "timesteps_since_restore": 2248000, "iterations_since_restore": 562, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.55460992907801, "episode_len_mean": 28.29078014184397, "episodes_this_iter": 141, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.840094339622639}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.851898902613393, "mean_processing_ms": 7.229146597092155, "mean_inference_ms": 1.085188280962196}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5948032, "num_steps_sampled": 2252000, "sample_time_ms": 8649.758, "load_time_ms": 15.485, "grad_time_ms": 25857.787, "update_time_ms": 36.418, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.009416716173291206, "policy_loss": -0.009421996772289276, "vf_loss": 5.278308868408203, "vf_explained_var": 0.28574326634407043, "kl": 0.003231281181797385, "entropy": 0.10297853499650955, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2252000, "episodes_total": 67397, "training_iteration": 563, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-55-17", "timestamp": 1581519317, "time_this_iter_s": 34.70785641670227, "time_total_s": 18613.652043819427, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357edf28>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18613.652043819427, "timesteps_since_restore": 2252000, "iterations_since_restore": 563, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -17.99107142857142, "episode_len_mean": 34.660714285714285, "episodes_this_iter": 112, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.6760563380281654}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.858237611980968, "mean_processing_ms": 7.211466543031456, "mean_inference_ms": 1.0861501196345842}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5958656, "num_steps_sampled": 2256000, "sample_time_ms": 8540.182, "load_time_ms": 15.487, "grad_time_ms": 25830.208, "update_time_ms": 36.42, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.016863850876688957, "policy_loss": -0.016870839521288872, "vf_loss": 6.993070602416992, "vf_explained_var": 0.15915557742118835, "kl": 0.023910775780677795, "entropy": 0.19947119057178497, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2256000, "episodes_total": 67509, "training_iteration": 564, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-55-53", "timestamp": 1581519353, "time_this_iter_s": 35.55011463165283, "time_total_s": 18649.20215845108, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357edbf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18649.20215845108, "timesteps_since_restore": 2256000, "iterations_since_restore": 564, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.49137931034482, "episode_len_mean": 35.241379310344826, "episodes_this_iter": 116, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -6.008403361344534}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.853664060897654, "mean_processing_ms": 7.211294239809241, "mean_inference_ms": 1.0866256543541117}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5969280, "num_steps_sampled": 2260000, "sample_time_ms": 8530.123, "load_time_ms": 16.747, "grad_time_ms": 25935.55, "update_time_ms": 36.386, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.06477575749158859, "policy_loss": 0.06476884335279465, "vf_loss": 6.921361923217773, "vf_explained_var": 0.18393592536449432, "kl": 0.005578578449785709, "entropy": 0.1916913241147995, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2260000, "episodes_total": 67625, "training_iteration": 565, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-56-30", "timestamp": 1581519390, "time_this_iter_s": 36.11422824859619, "time_total_s": 18685.316386699677, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357eda60>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18685.316386699677, "timesteps_since_restore": 2260000, "iterations_since_restore": 565, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.943076923076912, "episode_len_mean": 31.592307692307692, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.260406091370556}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.862383618465597, "mean_processing_ms": 7.229406912724735, "mean_inference_ms": 1.0869865413460444}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5979776, "num_steps_sampled": 2264000, "sample_time_ms": 8504.967, "load_time_ms": 15.98, "grad_time_ms": 26087.103, "update_time_ms": 35.923, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03448779881000519, "policy_loss": -0.034493330866098404, "vf_loss": 5.527800559997559, "vf_explained_var": 0.20756058394908905, "kl": 0.004820030648261309, "entropy": 0.1838236153125763, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2264000, "episodes_total": 67755, "training_iteration": 566, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-57-06", "timestamp": 1581519426, "time_this_iter_s": 35.53157997131348, "time_total_s": 18720.84796667099, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f620>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18720.84796667099, "timesteps_since_restore": 2264000, "iterations_since_restore": 566, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -12.630188679245276, "episode_len_mean": 25.40251572327044, "episodes_this_iter": 159, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.272765957446806}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.860601184553488, "mean_processing_ms": 7.2315915410121, "mean_inference_ms": 1.0867320654708972}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5990144, "num_steps_sampled": 2268000, "sample_time_ms": 8744.544, "load_time_ms": 16.066, "grad_time_ms": 26437.287, "update_time_ms": 36.484, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.012271422892808914, "policy_loss": 0.012265895493328571, "vf_loss": 5.528792381286621, "vf_explained_var": 0.24989667534828186, "kl": 0.005657511297613382, "entropy": 0.1293618530035019, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2268000, "episodes_total": 67914, "training_iteration": 567, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-57-45", "timestamp": 1581519465, "time_this_iter_s": 37.61913013458252, "time_total_s": 18758.467096805573, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357edb70>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18758.467096805573, "timesteps_since_restore": 2268000, "iterations_since_restore": 567, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.00863309352517, "episode_len_mean": 28.33093525179856, "episodes_this_iter": 139, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.658373205741625}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.862028302882184, "mean_processing_ms": 7.242752962567066, "mean_inference_ms": 1.0871476633328196}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6000512, "num_steps_sampled": 2272000, "sample_time_ms": 8925.816, "load_time_ms": 16.806, "grad_time_ms": 26930.824, "update_time_ms": 36.682, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0032998714596033096, "policy_loss": 0.0032943354453891516, "vf_loss": 5.533352851867676, "vf_explained_var": 0.24871870875358582, "kl": 0.0038344149943441153, "entropy": 0.159767284989357, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2272000, "episodes_total": 68053, "training_iteration": 568, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-58-25", "timestamp": 1581519505, "time_this_iter_s": 39.06175518035889, "time_total_s": 18797.52885198593, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357ed9d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18797.52885198593, "timesteps_since_restore": 2272000, "iterations_since_restore": 568, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.939999999999992, "episode_len_mean": 30.66923076923077, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.180499999999998}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.866757857833255, "mean_processing_ms": 7.23768201696566, "mean_inference_ms": 1.0878144632411517}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6011136, "num_steps_sampled": 2276000, "sample_time_ms": 9135.863, "load_time_ms": 16.741, "grad_time_ms": 27640.209, "update_time_ms": 37.415, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.002358203986659646, "policy_loss": 0.002352034440264106, "vf_loss": 6.171411037445068, "vf_explained_var": 0.23303020000457764, "kl": 0.003872095374390483, "entropy": 0.18081219494342804, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2276000, "episodes_total": 68183, "training_iteration": 569, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-59-08", "timestamp": 1581519548, "time_this_iter_s": 42.467530488967896, "time_total_s": 18839.9963824749, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357ed7b8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18839.9963824749, "timesteps_since_restore": 2276000, "iterations_since_restore": 569, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.224427480916018, "episode_len_mean": 30.48854961832061, "episodes_this_iter": 131, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.023677581863978}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.869923732560563, "mean_processing_ms": 7.244629629001556, "mean_inference_ms": 1.0887251740192772}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6021504, "num_steps_sampled": 2280000, "sample_time_ms": 9160.788, "load_time_ms": 16.655, "grad_time_ms": 27600.457, "update_time_ms": 37.555, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.018851932138204575, "policy_loss": -0.018858030438423157, "vf_loss": 6.096037864685059, "vf_explained_var": 0.19960156083106995, "kl": 0.003649466671049595, "entropy": 0.1483217030763626, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2280000, "episodes_total": 68314, "training_iteration": 570, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_14-59-46", "timestamp": 1581519586, "time_this_iter_s": 37.165547370910645, "time_total_s": 18877.16192984581, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b0d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18877.16192984581, "timesteps_since_restore": 2280000, "iterations_since_restore": 570, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.190977443609013, "episode_len_mean": 29.74436090225564, "episodes_this_iter": 133, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.9398533007334935}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.863950132821215, "mean_processing_ms": 7.251433271962744, "mean_inference_ms": 1.0883688426780376}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6032128, "num_steps_sampled": 2284000, "sample_time_ms": 9169.027, "load_time_ms": 17.586, "grad_time_ms": 27917.157, "update_time_ms": 38.167, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.021382812410593033, "policy_loss": -0.021388620138168335, "vf_loss": 5.807300090789795, "vf_explained_var": 0.2459009438753128, "kl": 0.002424584235996008, "entropy": 0.1754947453737259, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2284000, "episodes_total": 68447, "training_iteration": 571, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-00-26", "timestamp": 1581519626, "time_this_iter_s": 38.83319091796875, "time_total_s": 18915.99512076378, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357ed1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18915.99512076378, "timesteps_since_restore": 2284000, "iterations_since_restore": 571, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.563636363636347, "episode_len_mean": 30.977272727272727, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.8567375886524795}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.857257425359533, "mean_processing_ms": 7.2344249060642305, "mean_inference_ms": 1.0895280984190836}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6042496, "num_steps_sampled": 2288000, "sample_time_ms": 9274.103, "load_time_ms": 17.302, "grad_time_ms": 28164.036, "update_time_ms": 38.798, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.044147513806819916, "policy_loss": -0.044153135269880295, "vf_loss": 5.618870258331299, "vf_explained_var": 0.2342960238456726, "kl": 0.0024810247123241425, "entropy": 0.15441542863845825, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2288000, "episodes_total": 68579, "training_iteration": 572, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-01-05", "timestamp": 1581519665, "time_this_iter_s": 38.08653664588928, "time_total_s": 18954.081657409668, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f9d8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18954.081657409668, "timesteps_since_restore": 2288000, "iterations_since_restore": 572, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.30218978102189, "episode_len_mean": 28.496350364963504, "episodes_this_iter": 137, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.698800959232611}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.864632309164861, "mean_processing_ms": 7.25553713067421, "mean_inference_ms": 1.089711075630276}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6052992, "num_steps_sampled": 2292000, "sample_time_ms": 9416.681, "load_time_ms": 17.004, "grad_time_ms": 28454.814, "update_time_ms": 39.015, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03574756160378456, "policy_loss": 0.03574174642562866, "vf_loss": 5.81072473526001, "vf_explained_var": 0.29120969772338867, "kl": 0.0035569886676967144, "entropy": 0.15965647995471954, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2292000, "episodes_total": 68716, "training_iteration": 573, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-01-45", "timestamp": 1581519705, "time_this_iter_s": 39.04073977470398, "time_total_s": 18993.122397184372, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357ed6a8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 18993.122397184372, "timesteps_since_restore": 2292000, "iterations_since_restore": 573, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.177443609022548, "episode_len_mean": 29.81203007518797, "episodes_this_iter": 133, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.959705159705157}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.868628123997213, "mean_processing_ms": 7.256653730825649, "mean_inference_ms": 1.0905596267776119}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6063616, "num_steps_sampled": 2296000, "sample_time_ms": 9634.672, "load_time_ms": 18.079, "grad_time_ms": 28754.873, "update_time_ms": 39.077, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.013092579320073128, "policy_loss": -0.013099068775773048, "vf_loss": 6.491967678070068, "vf_explained_var": 0.2125248908996582, "kl": 0.00556343887001276, "entropy": 0.16563914716243744, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2296000, "episodes_total": 68849, "training_iteration": 574, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-02-26", "timestamp": 1581519746, "time_this_iter_s": 40.74453353881836, "time_total_s": 19033.86693072319, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b488>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19033.86693072319, "timesteps_since_restore": 2296000, "iterations_since_restore": 574, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.720863309352517, "episode_len_mean": 29.014388489208635, "episodes_this_iter": 139, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.215274463007157}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.879705861373448, "mean_processing_ms": 7.268223608616649, "mean_inference_ms": 1.0908108432127779}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6074624, "num_steps_sampled": 2300000, "sample_time_ms": 9725.221, "load_time_ms": 17.212, "grad_time_ms": 29149.762, "update_time_ms": 39.368, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.03934287652373314, "policy_loss": -0.039349183440208435, "vf_loss": 6.301584720611572, "vf_explained_var": 0.20999553799629211, "kl": 0.011511707678437233, "entropy": 0.18618988990783691, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2300000, "episodes_total": 68988, "training_iteration": 575, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-03-09", "timestamp": 1581519789, "time_this_iter_s": 40.965638637542725, "time_total_s": 19074.832569360733, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19074.832569360733, "timesteps_since_restore": 2300000, "iterations_since_restore": 575, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.4486956521739, "episode_len_mean": 34.7304347826087, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.877008310249304}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.873415883240361, "mean_processing_ms": 7.253950265721236, "mean_inference_ms": 1.0912601782945284}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6085504, "num_steps_sampled": 2304000, "sample_time_ms": 9731.397, "load_time_ms": 17.245, "grad_time_ms": 29608.073, "update_time_ms": 40.04, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0064444225281476974, "policy_loss": -0.006451074033975601, "vf_loss": 6.6471757888793945, "vf_explained_var": 0.17410175502300262, "kl": 0.006507933139801025, "entropy": 0.2092377096414566, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2304000, "episodes_total": 69103, "training_iteration": 576, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-03-49", "timestamp": 1581519829, "time_this_iter_s": 40.18256092071533, "time_total_s": 19115.01513028145, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6fc80>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19115.01513028145, "timesteps_since_restore": 2304000, "iterations_since_restore": 576, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.772357723577226, "episode_len_mean": 32.764227642276424, "episodes_this_iter": 123, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.4576719576719555}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.86772020121047, "mean_processing_ms": 7.249101803513527, "mean_inference_ms": 1.0923315737944628}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6096128, "num_steps_sampled": 2308000, "sample_time_ms": 9766.09, "load_time_ms": 18.014, "grad_time_ms": 29776.887, "update_time_ms": 40.945, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.021540962159633636, "policy_loss": -0.021547118201851845, "vf_loss": 6.156734466552734, "vf_explained_var": 0.23517896234989166, "kl": 0.004991347435861826, "entropy": 0.21023690700531006, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2308000, "episodes_total": 69226, "training_iteration": 577, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-04-30", "timestamp": 1581519870, "time_this_iter_s": 39.668766021728516, "time_total_s": 19154.683896303177, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335b5b048>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19154.683896303177, "timesteps_since_restore": 2308000, "iterations_since_restore": 577, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.2086956521739, "episode_len_mean": 34.68695652173913, "episodes_this_iter": 115, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.816666666666664}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.877564987784721, "mean_processing_ms": 7.253839969993605, "mean_inference_ms": 1.0926538113774473}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6106880, "num_steps_sampled": 2312000, "sample_time_ms": 9725.27, "load_time_ms": 17.546, "grad_time_ms": 29872.207, "update_time_ms": 41.135, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00778039637953043, "policy_loss": -0.007786950096487999, "vf_loss": 6.552408695220947, "vf_explained_var": 0.19745561480522156, "kl": 0.0043668667785823345, "entropy": 0.25084739923477173, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2312000, "episodes_total": 69341, "training_iteration": 578, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-05-10", "timestamp": 1581519910, "time_this_iter_s": 39.60162115097046, "time_total_s": 19194.285517454147, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34209f400>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19194.285517454147, "timesteps_since_restore": 2312000, "iterations_since_restore": 578, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.673846153846139, "episode_len_mean": 30.93076923076923, "episodes_this_iter": 130, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -4.994117647058821}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.86548268885205, "mean_processing_ms": 7.262502293473505, "mean_inference_ms": 1.0934091391190033}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6117248, "num_steps_sampled": 2316000, "sample_time_ms": 9647.983, "load_time_ms": 17.114, "grad_time_ms": 29606.861, "update_time_ms": 41.5, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.044316865503787994, "policy_loss": 0.04431028291583061, "vf_loss": 6.583596229553223, "vf_explained_var": 0.22494640946388245, "kl": 0.003562592901289463, "entropy": 0.19925057888031006, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2316000, "episodes_total": 69471, "training_iteration": 579, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-05-50", "timestamp": 1581519950, "time_this_iter_s": 39.03902888298035, "time_total_s": 19233.324546337128, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3363aa268>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19233.324546337128, "timesteps_since_restore": 2316000, "iterations_since_restore": 579, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.165413533834576, "episode_len_mean": 29.954887218045112, "episodes_this_iter": 133, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.955773955773954}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.88915600380942, "mean_processing_ms": 7.27506996644614, "mean_inference_ms": 1.09344099895292}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6127744, "num_steps_sampled": 2320000, "sample_time_ms": 9722.031, "load_time_ms": 17.853, "grad_time_ms": 29764.851, "update_time_ms": 41.604, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.017421938478946686, "policy_loss": -0.017427831888198853, "vf_loss": 5.888401508331299, "vf_explained_var": 0.25754648447036743, "kl": 0.004241556394845247, "entropy": 0.22571603953838348, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2320000, "episodes_total": 69604, "training_iteration": 580, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-06-30", "timestamp": 1581519990, "time_this_iter_s": 39.49524259567261, "time_total_s": 19272.8197889328, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6f730>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19272.8197889328, "timesteps_since_restore": 2320000, "iterations_since_restore": 580, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.633599999999985, "episode_len_mean": 32.032, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.211199999999997}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.884426168879317, "mean_processing_ms": 7.272805773859504, "mean_inference_ms": 1.094077571204079}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6137856, "num_steps_sampled": 2324000, "sample_time_ms": 9693.763, "load_time_ms": 17.308, "grad_time_ms": 29688.231, "update_time_ms": 41.617, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.011006358079612255, "policy_loss": 0.01099961344152689, "vf_loss": 6.74405574798584, "vf_explained_var": 0.2003105729818344, "kl": 0.004462463781237602, "entropy": 0.20508961379528046, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2324000, "episodes_total": 69729, "training_iteration": 581, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-07-09", "timestamp": 1581520029, "time_this_iter_s": 37.779396295547485, "time_total_s": 19310.599185228348, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34244f158>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19310.599185228348, "timesteps_since_restore": 2324000, "iterations_since_restore": 581, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.271830985915482, "episode_len_mean": 28.260563380281692, "episodes_this_iter": 142, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.702088167053362}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.88456830322735, "mean_processing_ms": 7.29026850812032, "mean_inference_ms": 1.0946239843285879}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6148480, "num_steps_sampled": 2328000, "sample_time_ms": 9778.029, "load_time_ms": 17.23, "grad_time_ms": 29828.302, "update_time_ms": 42.105, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.013337227515876293, "policy_loss": -0.013342916034162045, "vf_loss": 5.68904972076416, "vf_explained_var": 0.22751915454864502, "kl": 0.004619230516254902, "entropy": 0.18982680141925812, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2328000, "episodes_total": 69871, "training_iteration": 582, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-07-50", "timestamp": 1581520070, "time_this_iter_s": 40.33361554145813, "time_total_s": 19350.932800769806, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff33b204510>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19350.932800769806, "timesteps_since_restore": 2328000, "iterations_since_restore": 582, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -13.921428571428558, "episode_len_mean": 28.35, "episodes_this_iter": 140, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -1.9999999999999998}, "policy_reward_mean": {"policy_0": -4.596698113207545}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.8747582401484415, "mean_processing_ms": 7.297690450279678, "mean_inference_ms": 1.0942258651185546}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6158592, "num_steps_sampled": 2332000, "sample_time_ms": 9808.656, "load_time_ms": 18.12, "grad_time_ms": 29674.196, "update_time_ms": 42.39, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04465566202998161, "policy_loss": -0.044661007821559906, "vf_loss": 5.343417644500732, "vf_explained_var": 0.2746244966983795, "kl": 0.0028269782196730375, "entropy": 0.15637683868408203, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2332000, "episodes_total": 70011, "training_iteration": 583, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-08-29", "timestamp": 1581520109, "time_this_iter_s": 37.818153619766235, "time_total_s": 19388.750954389572, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff335a6fbf8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19388.750954389572, "timesteps_since_restore": 2332000, "iterations_since_restore": 583, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.800000000000002, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -14.352173913043467, "episode_len_mean": 28.485507246376812, "episodes_this_iter": 138, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -4.6712264150943374}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.882914661410484, "mean_processing_ms": 7.284586484907853, "mean_inference_ms": 1.0946752819825059}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6169216, "num_steps_sampled": 2336000, "sample_time_ms": 9654.211, "load_time_ms": 17.255, "grad_time_ms": 29536.025, "update_time_ms": 42.322, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02759118750691414, "policy_loss": -0.027597712352871895, "vf_loss": 6.519740104675293, "vf_explained_var": 0.21386443078517914, "kl": 0.00418386235833168, "entropy": 0.17161929607391357, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2336000, "episodes_total": 70149, "training_iteration": 584, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-09-07", "timestamp": 1581520147, "time_this_iter_s": 37.80735111236572, "time_total_s": 19426.558305501938, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3364590d0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19426.558305501938, "timesteps_since_restore": 2336000, "iterations_since_restore": 584, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.807575757575743, "episode_len_mean": 30.46969696969697, "episodes_this_iter": 132, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.015865384615382}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.883048023536276, "mean_processing_ms": 7.286826097164892, "mean_inference_ms": 1.0949484652557178}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6179840, "num_steps_sampled": 2340000, "sample_time_ms": 9584.672, "load_time_ms": 16.944, "grad_time_ms": 29200.908, "update_time_ms": 42.356, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04343792796134949, "policy_loss": 0.04343123733997345, "vf_loss": 6.693251132965088, "vf_explained_var": 0.2456047534942627, "kl": 0.003262684214860201, "entropy": 0.17837168276309967, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2340000, "episodes_total": 70281, "training_iteration": 585, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-09-45", "timestamp": 1581520185, "time_this_iter_s": 36.91401672363281, "time_total_s": 19463.47232222557, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357ed378>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19463.47232222557, "timesteps_since_restore": 2340000, "iterations_since_restore": 585, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -15.512592592592581, "episode_len_mean": 30.31851851851852, "episodes_this_iter": 135, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.1581280788177315}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.897558214795714, "mean_processing_ms": 7.3070336184267894, "mean_inference_ms": 1.094990975705861}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6190336, "num_steps_sampled": 2344000, "sample_time_ms": 9534.97, "load_time_ms": 17.67, "grad_time_ms": 28855.729, "update_time_ms": 42.267, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.026033610105514526, "policy_loss": 0.02602730132639408, "vf_loss": 6.303894996643066, "vf_explained_var": 0.21872390806674957, "kl": 0.0033525421749800444, "entropy": 0.17520973086357117, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2344000, "episodes_total": 70416, "training_iteration": 586, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-10-22", "timestamp": 1581520222, "time_this_iter_s": 36.237730741500854, "time_total_s": 19499.71005296707, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff34209fae8>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19499.71005296707, "timesteps_since_restore": 2344000, "iterations_since_restore": 586, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -16.447999999999986, "episode_len_mean": 31.888, "episodes_this_iter": 125, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.244897959183671}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.887881296638203, "mean_processing_ms": 7.288628550592065, "mean_inference_ms": 1.09603257443656}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6200960, "num_steps_sampled": 2348000, "sample_time_ms": 9516.002, "load_time_ms": 17.151, "grad_time_ms": 28433.659, "update_time_ms": 41.406, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": 0.018219543620944023, "policy_loss": 0.01821378618478775, "vf_loss": 5.751566410064697, "vf_explained_var": 0.23938493430614471, "kl": 0.004919512663036585, "entropy": 0.21487079560756683, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2348000, "episodes_total": 70541, "training_iteration": 587, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-10-58", "timestamp": 1581520258, "time_this_iter_s": 35.24336242675781, "time_total_s": 19534.95341539383, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff3357edd08>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19534.95341539383, "timesteps_since_restore": 2348000, "iterations_since_restore": 587, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
{"episode_reward_max": -4.400000000000001, "episode_reward_min": -48.00000000000014, "episode_reward_mean": -18.07008547008546, "episode_len_mean": 33.63247863247863, "episodes_this_iter": 117, "policy_reward_min": {"policy_0": -11.99999999999999}, "policy_reward_max": {"policy_0": -2.1999999999999997}, "policy_reward_mean": {"policy_0": -5.889136490250693}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.884022160330459, "mean_processing_ms": 7.321337157150046, "mean_inference_ms": 1.0952618700179868}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6211968, "num_steps_sampled": 2352000, "sample_time_ms": 9424.68, "load_time_ms": 16.866, "grad_time_ms": 28113.874, "update_time_ms": 40.979, "learner": {"policy_0": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999747378752e-05, "total_loss": -0.04290112480521202, "policy_loss": -0.04290792718529701, "vf_loss": 6.802313327789307, "vf_explained_var": 0.18693487346172333, "kl": 0.004134902264922857, "entropy": 0.23641501367092133, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 4000, "done": false, "timesteps_total": 2352000, "episodes_total": 70658, "training_iteration": 588, "experiment_id": "cce30ba806ba4079bd2130649369ff9f", "date": "2020-02-12_15-11-34", "timestamp": 1581520294, "time_this_iter_s": 35.48311996459961, "time_total_s": 19570.43653535843, "pid": 47551, "hostname": "nvidia-gtc", "node_ip": "10.142.0.61", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 8, "train_batch_size": 4000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": "tree_obs_preprocessor", "custom_model": "dense_model", "custom_action_dist": null, "custom_options": {"tree_depth": 2, "observation_radius": 0, "embedding": {"hidden_layers": [10, 10], "activation_fn": "relu"}, "actor": {"hidden_layers": [10], "activation_fn": "relu"}, "critic": {"hidden_layers": [10], "activation_fn": "relu"}}}, "optimizer": {}, "gamma": 0.99, "horizon": 60, "soft_horizon": false, "no_done_at_end": false, "env_config": {"obs_config": {"max_depth": 2}, "rail_generator": "complex_rail_generator", "rail_config": {"nr_start_goal": 12, "nr_extra": 0, "min_dist": 8, "seed": 10}, "width": 8, "height": 8, "number_of_agents": 5, "schedule_generator": "complex_schedule_generator", "schedule_config": {}, "frozen": false, "remove_agents_at_target": true, "wait_for_all_done": false}, "env": "train_env", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "DEBUG", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_1": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_2": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_3": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}], "policy_4": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(231,)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x7ff344fca1e0>", "policies_to_train": null}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 15, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-06, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 19570.43653535843, "timesteps_since_restore": 2352000, "iterations_since_restore": 588, "num_healthy_workers": 8, "trial_id": "2cb5bbbc", "experiment_tag": "0"}
